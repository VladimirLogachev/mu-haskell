<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# language DataKinds            #-}</span><span>
</span><a name="line-2"></a><span class="hs-pragma">{-# language PolyKinds            #-}</span><span>
</span><a name="line-3"></a><span class="hs-pragma">{-# language TypeFamilies         #-}</span><span>
</span><a name="line-4"></a><span class="hs-pragma">{-# language TypeOperators        #-}</span><span>
</span><a name="line-5"></a><span class="hs-pragma">{-# language UndecidableInstances #-}</span><span>
</span><a name="line-6"></a><span class="hs-comment">{-|
Description: From 'Schema' to Haskell types.

Obtains a 'Schema' from a set of Haskell types.

Unfortunately, GHC does not allow type families
to appear in instances, so you cannot use the
resulting type directly. Instead, evaluate it
in an interpreter session using @:kind!@ and
copy the result to the file.
-}</span><span>
</span><a name="line-17"></a><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Mu.Schema.Conversion.TypesToSchema</span><span> </span><span class="hs-special">(</span><span>
</span><a name="line-18"></a><span>  </span><a href="Mu.Schema.Conversion.TypesToSchema.html#SchemaFromTypes"><span class="hs-identifier hs-type">SchemaFromTypes</span></a><span>
</span><a name="line-19"></a><span class="hs-special">,</span><span> </span><a href="Mu.Schema.Conversion.TypesToSchema.html#FromType"><span class="hs-identifier hs-type">FromType</span></a><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><a name="line-20"></a><span class="hs-special">,</span><span> </span><a href="Mu.Schema.Conversion.TypesToSchema.html#AsRecord"><span class="hs-identifier hs-type">AsRecord</span></a><span class="hs-special">,</span><span> </span><a href="Mu.Schema.Conversion.TypesToSchema.html#AsEnum"><span class="hs-identifier hs-type">AsEnum</span></a><span>
</span><a name="line-21"></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-22"></a><span>
</span><a name="line-23"></a><span class="hs-keyword">import</span><span>           </span><span class="hs-identifier">Data.Kind</span><span>
</span><a name="line-24"></a><span class="hs-keyword">import</span><span>           </span><span class="hs-identifier">Data.Map</span><span>             </span><span class="hs-keyword">as</span><span> </span><span class="hs-identifier">M</span><span>
</span><a name="line-25"></a><span class="hs-keyword">import</span><span>           </span><span class="hs-identifier">Data.SOP</span><span>
</span><a name="line-26"></a><span class="hs-keyword">import</span><span>           </span><span class="hs-identifier">GHC.Generics</span><span>
</span><a name="line-27"></a><span class="hs-keyword">import</span><span>           </span><span class="hs-identifier">GHC.TypeLits</span><span>
</span><a name="line-28"></a><span>
</span><a name="line-29"></a><span class="hs-keyword">import</span><span>           </span><a href="Mu.Schema.Definition.html"><span class="hs-identifier">Mu.Schema.Definition</span></a><span>
</span><a name="line-30"></a><span>
</span><a name="line-31"></a><span class="hs-comment">-- | Defines whether to turn each Haskell type</span><span>
</span><a name="line-32"></a><span class="hs-comment">--   into a record or an enumeration.</span><span>
</span><a name="line-33"></a><span class="hs-comment">--   Any type not declared in the given list</span><span>
</span><a name="line-34"></a><span class="hs-comment">--   of 'FromType's is considered primitive.</span><span>
</span><a name="line-35"></a><span class="hs-keyword">data</span><span> </span><a name="FromType"><a href="Mu.Schema.Conversion.TypesToSchema.html#FromType"><span class="hs-identifier">FromType</span></a></a><span> </span><a name="local-6989586621679039608"><a href="#local-6989586621679039608"><span class="hs-identifier">tn</span></a></a><span> </span><a name="local-6989586621679039609"><a href="#local-6989586621679039609"><span class="hs-identifier">fn</span></a></a><span>
</span><a name="line-36"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-comment">-- | Declares that the type should become a record.</span><span>
</span><a name="line-37"></a><span>    </span><a name="AsRecord%27"><a href="Mu.Schema.Conversion.TypesToSchema.html#AsRecord%27"><span class="hs-identifier">AsRecord'</span></a></a><span> </span><span class="hs-identifier hs-type">Type</span><span> </span><a href="#local-6989586621679039608"><span class="hs-identifier hs-type">tn</span></a><span> </span><span class="hs-special">(</span><a href="Mu.Schema.Definition.html#Mappings"><span class="hs-identifier hs-type">Mappings</span></a><span> </span><span class="hs-identifier hs-type">Symbol</span><span> </span><a href="#local-6989586621679039609"><span class="hs-identifier hs-type">fn</span></a><span class="hs-special">)</span><span>
</span><a name="line-38"></a><span>    </span><span class="hs-comment">-- | Declares that the type should become an enumeration.</span><span>
</span><a name="line-39"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="AsEnum%27"><a href="Mu.Schema.Conversion.TypesToSchema.html#AsEnum%27"><span class="hs-identifier">AsEnum'</span></a></a><span>   </span><span class="hs-identifier hs-type">Type</span><span> </span><a href="#local-6989586621679039608"><span class="hs-identifier hs-type">tn</span></a><span> </span><span class="hs-special">(</span><a href="Mu.Schema.Definition.html#Mappings"><span class="hs-identifier hs-type">Mappings</span></a><span> </span><span class="hs-identifier hs-type">Symbol</span><span> </span><a href="#local-6989586621679039609"><span class="hs-identifier hs-type">fn</span></a><span class="hs-special">)</span><span>
</span><a name="line-40"></a><span>
</span><a name="line-41"></a><span class="hs-comment">-- | Declares that the type should become a record.</span><span>
</span><a name="line-42"></a><span class="hs-keyword">type</span><span> </span><a name="AsRecord"><a href="Mu.Schema.Conversion.TypesToSchema.html#AsRecord"><span class="hs-identifier">AsRecord</span></a></a><span> </span><a name="local-6989586621679039606"><a href="#local-6989586621679039606"><span class="hs-identifier">t</span></a></a><span> </span><a name="local-6989586621679039607"><a href="#local-6989586621679039607"><span class="hs-identifier">tn</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">'</span><a href="Mu.Schema.Conversion.TypesToSchema.html#AsRecord%27"><span class="hs-identifier hs-type">AsRecord'</span></a><span> </span><a href="#local-6989586621679039606"><span class="hs-identifier hs-type">t</span></a><span> </span><a href="#local-6989586621679039607"><span class="hs-identifier hs-type">tn</span></a><span> </span><span class="hs-special">'</span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-43"></a><span class="hs-comment">-- | Declares that the type should become an enumeration.</span><span>
</span><a name="line-44"></a><span class="hs-keyword">type</span><span> </span><a name="AsEnum"><a href="Mu.Schema.Conversion.TypesToSchema.html#AsEnum"><span class="hs-identifier">AsEnum</span></a></a><span>   </span><a name="local-6989586621679039604"><a href="#local-6989586621679039604"><span class="hs-identifier">t</span></a></a><span> </span><a name="local-6989586621679039605"><a href="#local-6989586621679039605"><span class="hs-identifier">tn</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">'</span><a href="Mu.Schema.Conversion.TypesToSchema.html#AsEnum%27"><span class="hs-identifier hs-type">AsEnum'</span></a><span>   </span><a href="#local-6989586621679039604"><span class="hs-identifier hs-type">t</span></a><span> </span><a href="#local-6989586621679039605"><span class="hs-identifier hs-type">tn</span></a><span> </span><span class="hs-special">'</span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-45"></a><span>
</span><a name="line-46"></a><span class="hs-comment">-- |&#160;Convert a set of types into a 'Schema'.</span><span>
</span><a name="line-47"></a><span class="hs-keyword">type</span><span> </span><span class="hs-keyword">family</span><span> </span><a name="SchemaFromTypes"><a href="Mu.Schema.Conversion.TypesToSchema.html#SchemaFromTypes"><span class="hs-identifier">SchemaFromTypes</span></a></a><span> </span><span class="hs-special">(</span><a name="local-6989586621679039602"><a href="#local-6989586621679039602"><span class="hs-identifier">f</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><a href="Mu.Schema.Conversion.TypesToSchema.html#FromType"><span class="hs-identifier hs-type">FromType</span></a><span> </span><a href="#local-6989586621679039600"><span class="hs-identifier hs-type">tn</span></a><span> </span><a href="#local-6989586621679039601"><span class="hs-identifier hs-type">fn</span></a><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Mu.Schema.Definition.html#Schema"><span class="hs-identifier hs-type">Schema</span></a><span> </span><a href="#local-6989586621679039600"><span class="hs-identifier hs-type">tn</span></a><span> </span><a href="#local-6989586621679039601"><span class="hs-identifier hs-type">fn</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-48"></a><span>  </span><span class="hs-identifier">SchemaFromTypes</span><span> </span><a href="#local-6989586621679039603"><span class="hs-identifier hs-type">f</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Mu.Schema.Conversion.TypesToSchema.html#SchemaFromTypes%27"><span class="hs-identifier hs-type">SchemaFromTypes'</span></a><span> </span><a href="#local-6989586621679039603"><span class="hs-identifier hs-type">f</span></a><span> </span><a href="#local-6989586621679039603"><span class="hs-identifier hs-type">f</span></a><span>
</span><a name="line-49"></a><span>
</span><a name="line-50"></a><span class="hs-keyword">type</span><span> </span><span class="hs-keyword">family</span><span> </span><a name="SchemaFromTypes%27"><a href="Mu.Schema.Conversion.TypesToSchema.html#SchemaFromTypes%27"><span class="hs-identifier">SchemaFromTypes'</span></a></a><span> </span><span class="hs-special">(</span><a name="local-6989586621679039594"><a href="#local-6989586621679039594"><span class="hs-identifier">all</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><a href="Mu.Schema.Conversion.TypesToSchema.html#FromType"><span class="hs-identifier hs-type">FromType</span></a><span> </span><a href="#local-6989586621679039592"><span class="hs-identifier hs-type">tn</span></a><span> </span><a href="#local-6989586621679039593"><span class="hs-identifier hs-type">fn</span></a><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679039595"><a href="#local-6989586621679039595"><span class="hs-identifier">f</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><a href="Mu.Schema.Conversion.TypesToSchema.html#FromType"><span class="hs-identifier hs-type">FromType</span></a><span> </span><a href="#local-6989586621679039592"><span class="hs-identifier hs-type">tn</span></a><span> </span><a href="#local-6989586621679039593"><span class="hs-identifier hs-type">fn</span></a><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Mu.Schema.Definition.html#Schema"><span class="hs-identifier hs-type">Schema</span></a><span> </span><a href="#local-6989586621679039592"><span class="hs-identifier hs-type">tn</span></a><span> </span><a href="#local-6989586621679039593"><span class="hs-identifier hs-type">fn</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-51"></a><span>  </span><span class="hs-identifier">SchemaFromTypes'</span><span> </span><a href="#local-6989586621679039596"><span class="hs-identifier hs-type">all</span></a><span> </span><span class="hs-special">'</span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">'</span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-52"></a><span>  </span><span class="hs-identifier">SchemaFromTypes'</span><span> </span><a href="#local-6989586621679039597"><span class="hs-identifier hs-type">all</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">t</span><span> </span><span class="hs-special">'</span><span class="hs-glyph">:</span><span> </span><a href="#local-6989586621679039599"><span class="hs-identifier hs-type">ts</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-type">TypeDefFromType</span><span> </span><a href="#local-6989586621679039597"><span class="hs-identifier hs-type">all</span></a><span> </span><a href="#local-6989586621679039598"><span class="hs-identifier hs-type">t</span></a><span> </span><span class="hs-special">'</span><span class="hs-glyph">:</span><span> </span><a href="Mu.Schema.Conversion.TypesToSchema.html#SchemaFromTypes%27"><span class="hs-identifier hs-type">SchemaFromTypes'</span></a><span> </span><a href="#local-6989586621679039597"><span class="hs-identifier hs-type">all</span></a><span> </span><a href="#local-6989586621679039599"><span class="hs-identifier hs-type">ts</span></a><span>
</span><a name="line-53"></a><span>
</span><a name="line-54"></a><span class="hs-keyword">type</span><span> </span><span class="hs-keyword">family</span><span> </span><a name="TypeDefFromType"><a href="Mu.Schema.Conversion.TypesToSchema.html#TypeDefFromType"><span class="hs-identifier">TypeDefFromType</span></a></a><span> </span><span class="hs-special">(</span><a name="local-6989586621679039582"><a href="#local-6989586621679039582"><span class="hs-identifier">all</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><a href="Mu.Schema.Conversion.TypesToSchema.html#FromType"><span class="hs-identifier hs-type">FromType</span></a><span> </span><a href="#local-6989586621679039580"><span class="hs-identifier hs-type">tn</span></a><span> </span><a href="#local-6989586621679039581"><span class="hs-identifier hs-type">fn</span></a><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679039583"><a href="#local-6989586621679039583"><span class="hs-identifier">info</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><a href="Mu.Schema.Conversion.TypesToSchema.html#FromType"><span class="hs-identifier hs-type">FromType</span></a><span> </span><a href="#local-6989586621679039580"><span class="hs-identifier hs-type">tn</span></a><span> </span><a href="#local-6989586621679039581"><span class="hs-identifier hs-type">fn</span></a><span class="hs-special">)</span><span>
</span><a name="line-55"></a><span>  </span><span class="hs-glyph">::</span><span> </span><a href="Mu.Schema.Definition.html#TypeDef"><span class="hs-identifier hs-type">TypeDef</span></a><span> </span><a href="#local-6989586621679039580"><span class="hs-identifier hs-type">tn</span></a><span> </span><a href="#local-6989586621679039581"><span class="hs-identifier hs-type">fn</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-56"></a><span>  </span><span class="hs-identifier">TypeDefFromType</span><span> </span><a href="#local-6989586621679039584"><span class="hs-identifier hs-type">all</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">'</span><a href="Mu.Schema.Conversion.TypesToSchema.html#AsRecord%27"><span class="hs-identifier hs-type">AsRecord'</span></a><span> </span><a href="#local-6989586621679039585"><span class="hs-identifier hs-type">t</span></a><span> </span><a href="#local-6989586621679039586"><span class="hs-identifier hs-type">name</span></a><span> </span><a href="#local-6989586621679039587"><span class="hs-identifier hs-type">mp</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">'</span><a href="Mu.Schema.Definition.html#DRecord"><span class="hs-identifier hs-type">DRecord</span></a><span> </span><a href="#local-6989586621679039586"><span class="hs-identifier hs-type">name</span></a><span> </span><span class="hs-special">(</span><a href="Mu.Schema.Conversion.TypesToSchema.html#FieldsFromType"><span class="hs-identifier hs-type">FieldsFromType</span></a><span>  </span><a href="#local-6989586621679039584"><span class="hs-identifier hs-type">all</span></a><span> </span><a href="#local-6989586621679039587"><span class="hs-identifier hs-type">mp</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Rep</span><span> </span><a href="#local-6989586621679039585"><span class="hs-identifier hs-type">t</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-57"></a><span>  </span><span class="hs-identifier">TypeDefFromType</span><span> </span><a href="#local-6989586621679039588"><span class="hs-identifier hs-type">all</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">'</span><a href="Mu.Schema.Conversion.TypesToSchema.html#AsEnum%27"><span class="hs-identifier hs-type">AsEnum'</span></a><span>   </span><a href="#local-6989586621679039589"><span class="hs-identifier hs-type">t</span></a><span> </span><a href="#local-6989586621679039590"><span class="hs-identifier hs-type">name</span></a><span> </span><a href="#local-6989586621679039591"><span class="hs-identifier hs-type">mp</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">'</span><a href="Mu.Schema.Definition.html#DEnum"><span class="hs-identifier hs-type">DEnum</span></a><span>   </span><a href="#local-6989586621679039590"><span class="hs-identifier hs-type">name</span></a><span> </span><span class="hs-special">(</span><a href="Mu.Schema.Conversion.TypesToSchema.html#ChoicesFromType"><span class="hs-identifier hs-type">ChoicesFromType</span></a><span> </span><a href="#local-6989586621679039588"><span class="hs-identifier hs-type">all</span></a><span> </span><a href="#local-6989586621679039591"><span class="hs-identifier hs-type">mp</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Rep</span><span> </span><a href="#local-6989586621679039589"><span class="hs-identifier hs-type">t</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-58"></a><span>
</span><a name="line-59"></a><span class="hs-keyword">type</span><span> </span><span class="hs-keyword">family</span><span> </span><a name="FieldsFromType"><a href="Mu.Schema.Conversion.TypesToSchema.html#FieldsFromType"><span class="hs-identifier">FieldsFromType</span></a></a><span> </span><span class="hs-special">(</span><a name="local-6989586621679039550"><a href="#local-6989586621679039550"><span class="hs-identifier">all</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><a href="Mu.Schema.Conversion.TypesToSchema.html#FromType"><span class="hs-identifier hs-type">FromType</span></a><span> </span><a href="#local-6989586621679039548"><span class="hs-identifier hs-type">tn</span></a><span> </span><a href="#local-6989586621679039549"><span class="hs-identifier hs-type">fn</span></a><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679039551"><a href="#local-6989586621679039551"><span class="hs-identifier">mp</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><a href="Mu.Schema.Definition.html#Mappings"><span class="hs-identifier hs-type">Mappings</span></a><span> </span><span class="hs-identifier hs-type">Symbol</span><span> </span><a href="#local-6989586621679039549"><span class="hs-identifier hs-type">fn</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679039552"><a href="#local-6989586621679039552"><span class="hs-identifier">f</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-operator">*</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-operator">*</span><span class="hs-special">)</span><span>
</span><a name="line-60"></a><span>  </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><a href="Mu.Schema.Definition.html#FieldDef"><span class="hs-identifier hs-type">FieldDef</span></a><span> </span><a href="#local-6989586621679039548"><span class="hs-identifier hs-type">tn</span></a><span> </span><a href="#local-6989586621679039549"><span class="hs-identifier hs-type">fn</span></a><span class="hs-special">]</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-61"></a><span>  </span><span class="hs-identifier">FieldsFromType</span><span> </span><a href="#local-6989586621679039553"><span class="hs-identifier hs-type">all</span></a><span> </span><a href="#local-6989586621679039554"><span class="hs-identifier hs-type">mp</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">x</span><span> </span><span class="hs-operator hs-type">:+:</span><span> </span><a href="#local-6989586621679039556"><span class="hs-identifier hs-type">y</span></a><span class="hs-special">)</span><span>
</span><a name="line-62"></a><span>    </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-type">TypeError</span><span> </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="hs-identifier hs-type">Text</span><span> </span><span class="hs-string">&quot;sum types cannot be converted to record schemas&quot;</span><span class="hs-special">)</span><span>
</span><a name="line-63"></a><span>  </span><span class="hs-identifier">FieldsFromType</span><span> </span><a href="#local-6989586621679039557"><span class="hs-identifier hs-type">all</span></a><span> </span><a href="#local-6989586621679039558"><span class="hs-identifier hs-type">mp</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">D1</span><span> </span><a href="#local-6989586621679039559"><span class="hs-identifier hs-type">meta</span></a><span> </span><a href="#local-6989586621679039560"><span class="hs-identifier hs-type">f</span></a><span class="hs-special">)</span><span>
</span><a name="line-64"></a><span>    </span><span class="hs-glyph">=</span><span> </span><a href="Mu.Schema.Conversion.TypesToSchema.html#FieldsFromType"><span class="hs-identifier hs-type">FieldsFromType</span></a><span> </span><a href="#local-6989586621679039557"><span class="hs-identifier hs-type">all</span></a><span> </span><a href="#local-6989586621679039558"><span class="hs-identifier hs-type">mp</span></a><span> </span><a href="#local-6989586621679039560"><span class="hs-identifier hs-type">f</span></a><span>  </span><span class="hs-comment">-- go through data info</span><span>
</span><a name="line-65"></a><span>  </span><span class="hs-identifier">FieldsFromType</span><span> </span><a href="#local-6989586621679039561"><span class="hs-identifier hs-type">all</span></a><span> </span><a href="#local-6989586621679039562"><span class="hs-identifier hs-type">mp</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">C1</span><span> </span><a href="#local-6989586621679039563"><span class="hs-identifier hs-type">meta</span></a><span> </span><a href="#local-6989586621679039564"><span class="hs-identifier hs-type">f</span></a><span class="hs-special">)</span><span>
</span><a name="line-66"></a><span>    </span><span class="hs-glyph">=</span><span> </span><a href="Mu.Schema.Conversion.TypesToSchema.html#FieldsFromType"><span class="hs-identifier hs-type">FieldsFromType</span></a><span> </span><a href="#local-6989586621679039561"><span class="hs-identifier hs-type">all</span></a><span> </span><a href="#local-6989586621679039562"><span class="hs-identifier hs-type">mp</span></a><span> </span><a href="#local-6989586621679039564"><span class="hs-identifier hs-type">f</span></a><span>  </span><span class="hs-comment">-- go through constructor info</span><span>
</span><a name="line-67"></a><span>  </span><span class="hs-identifier">FieldsFromType</span><span> </span><a href="#local-6989586621679039565"><span class="hs-identifier hs-type">all</span></a><span> </span><a href="#local-6989586621679039566"><span class="hs-identifier hs-type">mp</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">x</span><span> </span><span class="hs-operator hs-type">:*:</span><span> </span><a href="#local-6989586621679039568"><span class="hs-identifier hs-type">y</span></a><span class="hs-special">)</span><span>
</span><a name="line-68"></a><span>    </span><span class="hs-glyph">=</span><span> </span><a href="Mu.Schema.Conversion.TypesToSchema.html#ConcatList"><span class="hs-identifier hs-type">ConcatList</span></a><span> </span><span class="hs-special">(</span><a href="Mu.Schema.Conversion.TypesToSchema.html#FieldsFromType"><span class="hs-identifier hs-type">FieldsFromType</span></a><span> </span><a href="#local-6989586621679039565"><span class="hs-identifier hs-type">all</span></a><span> </span><a href="#local-6989586621679039566"><span class="hs-identifier hs-type">mp</span></a><span> </span><a href="#local-6989586621679039567"><span class="hs-identifier hs-type">x</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Mu.Schema.Conversion.TypesToSchema.html#FieldsFromType"><span class="hs-identifier hs-type">FieldsFromType</span></a><span> </span><a href="#local-6989586621679039565"><span class="hs-identifier hs-type">all</span></a><span> </span><a href="#local-6989586621679039566"><span class="hs-identifier hs-type">mp</span></a><span> </span><a href="#local-6989586621679039568"><span class="hs-identifier hs-type">y</span></a><span class="hs-special">)</span><span>
</span><a name="line-69"></a><span>  </span><span class="hs-identifier">FieldsFromType</span><span> </span><a href="#local-6989586621679039569"><span class="hs-identifier hs-type">all</span></a><span> </span><a href="#local-6989586621679039570"><span class="hs-identifier hs-type">mp</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">S1</span><span> </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="hs-identifier hs-type">MetaSel</span><span> </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="hs-identifier hs-type">Just</span><span> </span><a href="#local-6989586621679039571"><span class="hs-identifier hs-type">x</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679039572"><span class="hs-identifier hs-type">u</span></a><span> </span><a href="#local-6989586621679039573"><span class="hs-identifier hs-type">ss</span></a><span> </span><a href="#local-6989586621679039574"><span class="hs-identifier hs-type">ds</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">K1</span><span> </span><a href="#local-6989586621679039575"><span class="hs-identifier hs-type">i</span></a><span> </span><a href="#local-6989586621679039576"><span class="hs-identifier hs-type">t</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-70"></a><span>    </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">'</span><span class="hs-special">[</span><span> </span><span class="hs-special">'</span><a href="Mu.Schema.Definition.html#FieldDef"><span class="hs-identifier hs-type">FieldDef</span></a><span> </span><span class="hs-special">(</span><a href="Mu.Schema.Definition.html#MappingRight"><span class="hs-identifier hs-type">MappingRight</span></a><span> </span><a href="#local-6989586621679039570"><span class="hs-identifier hs-type">mp</span></a><span> </span><a href="#local-6989586621679039571"><span class="hs-identifier hs-type">x</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Mu.Schema.Conversion.TypesToSchema.html#ChooseFieldType"><span class="hs-identifier hs-type">ChooseFieldType</span></a><span> </span><a href="#local-6989586621679039569"><span class="hs-identifier hs-type">all</span></a><span> </span><a href="#local-6989586621679039576"><span class="hs-identifier hs-type">t</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">]</span><span>
</span><a name="line-71"></a><span>  </span><span class="hs-identifier">FieldsFromType</span><span> </span><a href="#local-6989586621679039577"><span class="hs-identifier hs-type">all</span></a><span> </span><a href="#local-6989586621679039578"><span class="hs-identifier hs-type">mp</span></a><span> </span><a href="#local-6989586621679039579"><span class="hs-identifier hs-type">v</span></a><span>
</span><a name="line-72"></a><span>    </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-type">TypeError</span><span> </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="hs-identifier hs-type">Text</span><span> </span><span class="hs-string">&quot;unsupported conversion from &quot;</span><span> </span><span class="hs-special">'</span><span class="hs-operator hs-type">:&lt;&gt;:</span><span> </span><span class="hs-special">'</span><span class="hs-identifier hs-type">ShowType</span><span> </span><a href="#local-6989586621679039579"><span class="hs-identifier hs-type">v</span></a><span> </span><span class="hs-special">'</span><span class="hs-operator">:&lt;&gt;:</span><span> </span><span class="hs-special">'</span><span class="hs-identifier hs-type">Text</span><span> </span><span class="hs-string">&quot; to record schema&quot;</span><span class="hs-special">)</span><span>
</span><a name="line-73"></a><span>
</span><a name="line-74"></a><span class="hs-keyword">type</span><span> </span><span class="hs-keyword">family</span><span> </span><a name="ConcatList"><a href="Mu.Schema.Conversion.TypesToSchema.html#ConcatList"><span class="hs-identifier">ConcatList</span></a></a><span> </span><span class="hs-special">(</span><a name="local-6989586621679039542"><a href="#local-6989586621679039542"><span class="hs-identifier">xs</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679039541"><span class="hs-identifier hs-type">k</span></a><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679039543"><a href="#local-6989586621679039543"><span class="hs-identifier">ys</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679039541"><span class="hs-identifier hs-type">k</span></a><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679039541"><span class="hs-identifier hs-type">k</span></a><span class="hs-special">]</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-75"></a><span>  </span><span class="hs-identifier">ConcatList</span><span> </span><span class="hs-special">'</span><span class="hs-special">[</span><span class="hs-special">]</span><span>       </span><a href="#local-6989586621679039544"><span class="hs-identifier hs-type">ys</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679039544"><span class="hs-identifier hs-type">ys</span></a><span>
</span><a name="line-76"></a><span>  </span><span class="hs-identifier">ConcatList</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">x</span><span> </span><span class="hs-special">'</span><span class="hs-glyph">:</span><span> </span><a href="#local-6989586621679039546"><span class="hs-identifier hs-type">xs</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679039547"><span class="hs-identifier hs-type">ys</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-type">x</span><span> </span><span class="hs-special">'</span><span class="hs-glyph">:</span><span> </span><a href="Mu.Schema.Conversion.TypesToSchema.html#ConcatList"><span class="hs-identifier hs-type">ConcatList</span></a><span> </span><a href="#local-6989586621679039546"><span class="hs-identifier hs-type">xs</span></a><span> </span><a href="#local-6989586621679039547"><span class="hs-identifier hs-type">ys</span></a><span>
</span><a name="line-77"></a><span>
</span><a name="line-78"></a><span class="hs-keyword">type</span><span> </span><span class="hs-keyword">family</span><span> </span><a name="ChooseFieldType"><a href="Mu.Schema.Conversion.TypesToSchema.html#ChooseFieldType"><span class="hs-identifier">ChooseFieldType</span></a></a><span> </span><span class="hs-special">(</span><a name="local-6989586621679039527"><a href="#local-6989586621679039527"><span class="hs-identifier">all</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><a href="Mu.Schema.Conversion.TypesToSchema.html#FromType"><span class="hs-identifier hs-type">FromType</span></a><span> </span><a href="#local-6989586621679039525"><span class="hs-identifier hs-type">tn</span></a><span> </span><a href="#local-6989586621679039526"><span class="hs-identifier hs-type">fn</span></a><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679039528"><a href="#local-6989586621679039528"><span class="hs-identifier">t</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Type</span><span class="hs-special">)</span><span>
</span><a name="line-79"></a><span>  </span><span class="hs-glyph">::</span><span> </span><a href="Mu.Schema.Definition.html#FieldType"><span class="hs-identifier hs-type">FieldType</span></a><span> </span><a href="#local-6989586621679039525"><span class="hs-identifier hs-type">tn</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-80"></a><span>  </span><span class="hs-identifier">ChooseFieldType</span><span> </span><a href="#local-6989586621679039529"><span class="hs-identifier hs-type">all</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">'</span><a href="Mu.Schema.Definition.html#TNull"><span class="hs-identifier hs-type">TNull</span></a><span>
</span><a name="line-81"></a><span>  </span><span class="hs-identifier">ChooseFieldType</span><span> </span><a href="#local-6989586621679039530"><span class="hs-identifier hs-type">all</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Maybe</span><span> </span><a href="#local-6989586621679039531"><span class="hs-identifier hs-type">t</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">'</span><a href="Mu.Schema.Definition.html#TOption"><span class="hs-identifier hs-type">TOption</span></a><span> </span><span class="hs-special">(</span><a href="Mu.Schema.Conversion.TypesToSchema.html#ChooseFieldType"><span class="hs-identifier hs-type">ChooseFieldType</span></a><span> </span><a href="#local-6989586621679039530"><span class="hs-identifier hs-type">all</span></a><span> </span><a href="#local-6989586621679039531"><span class="hs-identifier hs-type">t</span></a><span class="hs-special">)</span><span>
</span><a name="line-82"></a><span>  </span><span class="hs-identifier">ChooseFieldType</span><span> </span><a href="#local-6989586621679039532"><span class="hs-identifier hs-type">all</span></a><span> </span><span class="hs-special">[</span><a href="#local-6989586621679039533"><span class="hs-identifier hs-type">t</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">'</span><a href="Mu.Schema.Definition.html#TList"><span class="hs-identifier hs-type">TList</span></a><span> </span><span class="hs-special">(</span><a href="Mu.Schema.Conversion.TypesToSchema.html#ChooseFieldType"><span class="hs-identifier hs-type">ChooseFieldType</span></a><span> </span><a href="#local-6989586621679039532"><span class="hs-identifier hs-type">all</span></a><span> </span><a href="#local-6989586621679039533"><span class="hs-identifier hs-type">t</span></a><span class="hs-special">)</span><span>
</span><a name="line-83"></a><span>  </span><span class="hs-identifier">ChooseFieldType</span><span> </span><a href="#local-6989586621679039534"><span class="hs-identifier hs-type">all</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">M.Map</span><span> </span><a href="#local-6989586621679039535"><span class="hs-identifier hs-type">k</span></a><span> </span><a href="#local-6989586621679039536"><span class="hs-identifier hs-type">v</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">'</span><a href="Mu.Schema.Definition.html#TMap"><span class="hs-identifier hs-type">TMap</span></a><span> </span><span class="hs-special">(</span><a href="Mu.Schema.Conversion.TypesToSchema.html#ChooseFieldType"><span class="hs-identifier hs-type">ChooseFieldType</span></a><span> </span><a href="#local-6989586621679039534"><span class="hs-identifier hs-type">all</span></a><span> </span><a href="#local-6989586621679039535"><span class="hs-identifier hs-type">k</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Mu.Schema.Conversion.TypesToSchema.html#ChooseFieldType"><span class="hs-identifier hs-type">ChooseFieldType</span></a><span> </span><a href="#local-6989586621679039534"><span class="hs-identifier hs-type">all</span></a><span> </span><a href="#local-6989586621679039536"><span class="hs-identifier hs-type">v</span></a><span class="hs-special">)</span><span>
</span><a name="line-84"></a><span>  </span><span class="hs-identifier">ChooseFieldType</span><span> </span><a href="#local-6989586621679039537"><span class="hs-identifier hs-type">all</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">NS</span><span> </span><span class="hs-identifier hs-type">I</span><span> </span><a href="#local-6989586621679039538"><span class="hs-identifier hs-type">choices</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">'</span><a href="Mu.Schema.Definition.html#TUnion"><span class="hs-identifier hs-type">TUnion</span></a><span> </span><span class="hs-special">(</span><a href="Mu.Schema.Conversion.TypesToSchema.html#ChooseFieldUnion"><span class="hs-identifier hs-type">ChooseFieldUnion</span></a><span> </span><a href="#local-6989586621679039537"><span class="hs-identifier hs-type">all</span></a><span> </span><a href="#local-6989586621679039538"><span class="hs-identifier hs-type">choices</span></a><span class="hs-special">)</span><span>
</span><a name="line-85"></a><span>  </span><span class="hs-identifier">ChooseFieldType</span><span> </span><a href="#local-6989586621679039539"><span class="hs-identifier hs-type">all</span></a><span> </span><a href="#local-6989586621679039540"><span class="hs-identifier hs-type">t</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Mu.Schema.Conversion.TypesToSchema.html#ChooseFieldPrimitiveOrSchematic"><span class="hs-identifier hs-type">ChooseFieldPrimitiveOrSchematic</span></a><span> </span><a href="#local-6989586621679039540"><span class="hs-identifier hs-type">t</span></a><span> </span><span class="hs-special">(</span><a href="Mu.Schema.Conversion.TypesToSchema.html#FindTypeName"><span class="hs-identifier hs-type">FindTypeName</span></a><span> </span><a href="#local-6989586621679039539"><span class="hs-identifier hs-type">all</span></a><span> </span><a href="#local-6989586621679039540"><span class="hs-identifier hs-type">t</span></a><span class="hs-special">)</span><span>
</span><a name="line-86"></a><span>
</span><a name="line-87"></a><span class="hs-keyword">type</span><span> </span><span class="hs-keyword">family</span><span> </span><a name="ChooseFieldUnion"><a href="Mu.Schema.Conversion.TypesToSchema.html#ChooseFieldUnion"><span class="hs-identifier">ChooseFieldUnion</span></a></a><span> </span><span class="hs-special">(</span><a name="local-6989586621679039519"><a href="#local-6989586621679039519"><span class="hs-identifier">all</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><a href="Mu.Schema.Conversion.TypesToSchema.html#FromType"><span class="hs-identifier hs-type">FromType</span></a><span> </span><a href="#local-6989586621679039517"><span class="hs-identifier hs-type">tn</span></a><span> </span><a href="#local-6989586621679039518"><span class="hs-identifier hs-type">fn</span></a><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679039520"><a href="#local-6989586621679039520"><span class="hs-identifier">t</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">Type</span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><a name="line-88"></a><span>  </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><a href="Mu.Schema.Definition.html#FieldType"><span class="hs-identifier hs-type">FieldType</span></a><span> </span><a href="#local-6989586621679039517"><span class="hs-identifier hs-type">tn</span></a><span class="hs-special">]</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-89"></a><span>  </span><span class="hs-identifier">ChooseFieldUnion</span><span> </span><a href="#local-6989586621679039521"><span class="hs-identifier hs-type">all</span></a><span> </span><span class="hs-special">'</span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">'</span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-90"></a><span>  </span><span class="hs-identifier">ChooseFieldUnion</span><span> </span><a href="#local-6989586621679039522"><span class="hs-identifier hs-type">all</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">t</span><span> </span><span class="hs-special">'</span><span class="hs-glyph">:</span><span> </span><a href="#local-6989586621679039524"><span class="hs-identifier hs-type">ts</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-type">ChooseFieldType</span><span> </span><a href="#local-6989586621679039522"><span class="hs-identifier hs-type">all</span></a><span> </span><a href="#local-6989586621679039523"><span class="hs-identifier hs-type">t</span></a><span> </span><span class="hs-special">'</span><span class="hs-glyph">:</span><span> </span><a href="Mu.Schema.Conversion.TypesToSchema.html#ChooseFieldUnion"><span class="hs-identifier hs-type">ChooseFieldUnion</span></a><span> </span><a href="#local-6989586621679039522"><span class="hs-identifier hs-type">all</span></a><span> </span><a href="#local-6989586621679039524"><span class="hs-identifier hs-type">ts</span></a><span>
</span><a name="line-91"></a><span>
</span><a name="line-92"></a><span class="hs-keyword">type</span><span> </span><span class="hs-keyword">family</span><span> </span><a name="FindTypeName"><a href="Mu.Schema.Conversion.TypesToSchema.html#FindTypeName"><span class="hs-identifier">FindTypeName</span></a></a><span> </span><span class="hs-special">(</span><a name="local-6989586621679039503"><a href="#local-6989586621679039503"><span class="hs-identifier">all</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><a href="Mu.Schema.Conversion.TypesToSchema.html#FromType"><span class="hs-identifier hs-type">FromType</span></a><span> </span><a href="#local-6989586621679039501"><span class="hs-identifier hs-type">tn</span></a><span> </span><a href="#local-6989586621679039502"><span class="hs-identifier hs-type">fn</span></a><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679039504"><a href="#local-6989586621679039504"><span class="hs-identifier">t</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Type</span><span class="hs-special">)</span><span>
</span><a name="line-93"></a><span>  </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Maybe</span><span> </span><a href="#local-6989586621679039501"><span class="hs-identifier hs-type">tn</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-94"></a><span>  </span><span class="hs-identifier">FindTypeName</span><span> </span><span class="hs-special">'</span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><a href="#local-6989586621679039505"><span class="hs-identifier hs-type">t</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">'</span><span class="hs-identifier hs-type">Nothing</span><span>
</span><a name="line-95"></a><span>  </span><span class="hs-identifier">FindTypeName</span><span> </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="hs-identifier hs-type">AsRecord'</span><span> </span><a href="#local-6989586621679039506"><span class="hs-identifier hs-type">t</span></a><span> </span><a href="#local-6989586621679039507"><span class="hs-identifier hs-type">tn</span></a><span> </span><a href="#local-6989586621679039508"><span class="hs-identifier hs-type">mp</span></a><span> </span><span class="hs-special">'</span><span class="hs-glyph">:</span><span> </span><a href="#local-6989586621679039509"><span class="hs-identifier hs-type">rest</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679039506"><span class="hs-identifier hs-type">t</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">'</span><span class="hs-identifier hs-type">Just</span><span> </span><a href="#local-6989586621679039507"><span class="hs-identifier hs-type">tn</span></a><span>
</span><a name="line-96"></a><span>  </span><span class="hs-identifier">FindTypeName</span><span> </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="hs-identifier hs-type">AsEnum'</span><span>   </span><a href="#local-6989586621679039510"><span class="hs-identifier hs-type">t</span></a><span> </span><a href="#local-6989586621679039511"><span class="hs-identifier hs-type">tn</span></a><span> </span><a href="#local-6989586621679039512"><span class="hs-identifier hs-type">mp</span></a><span> </span><span class="hs-special">'</span><span class="hs-glyph">:</span><span> </span><a href="#local-6989586621679039513"><span class="hs-identifier hs-type">rest</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679039510"><span class="hs-identifier hs-type">t</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">'</span><span class="hs-identifier hs-type">Just</span><span> </span><a href="#local-6989586621679039511"><span class="hs-identifier hs-type">tn</span></a><span>
</span><a name="line-97"></a><span>  </span><span class="hs-identifier">FindTypeName</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">other</span><span> </span><span class="hs-special">'</span><span class="hs-glyph">:</span><span> </span><a href="#local-6989586621679039515"><span class="hs-identifier hs-type">rest</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679039516"><span class="hs-identifier hs-type">t</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Mu.Schema.Conversion.TypesToSchema.html#FindTypeName"><span class="hs-identifier hs-type">FindTypeName</span></a><span> </span><a href="#local-6989586621679039515"><span class="hs-identifier hs-type">rest</span></a><span> </span><a href="#local-6989586621679039516"><span class="hs-identifier hs-type">t</span></a><span>
</span><a name="line-98"></a><span>
</span><a name="line-99"></a><span class="hs-keyword">type</span><span> </span><span class="hs-keyword">family</span><span> </span><a name="ChooseFieldPrimitiveOrSchematic"><a href="Mu.Schema.Conversion.TypesToSchema.html#ChooseFieldPrimitiveOrSchematic"><span class="hs-identifier">ChooseFieldPrimitiveOrSchematic</span></a></a><span> </span><span class="hs-special">(</span><a name="local-6989586621679039496"><a href="#local-6989586621679039496"><span class="hs-identifier">t</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Type</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679039497"><a href="#local-6989586621679039497"><span class="hs-identifier">ref</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Maybe</span><span> </span><a href="#local-6989586621679039495"><span class="hs-identifier hs-type">tn</span></a><span class="hs-special">)</span><span>
</span><a name="line-100"></a><span>  </span><span class="hs-glyph">::</span><span> </span><a href="Mu.Schema.Definition.html#FieldType"><span class="hs-identifier hs-type">FieldType</span></a><span> </span><a href="#local-6989586621679039495"><span class="hs-identifier hs-type">tn</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-101"></a><span>  </span><span class="hs-identifier">ChooseFieldPrimitiveOrSchematic</span><span> </span><a href="#local-6989586621679039498"><span class="hs-identifier hs-type">t</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="hs-identifier hs-type">Just</span><span> </span><a href="#local-6989586621679039499"><span class="hs-identifier hs-type">name</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">'</span><a href="Mu.Schema.Definition.html#TSchematic"><span class="hs-identifier hs-type">TSchematic</span></a><span> </span><a href="#local-6989586621679039499"><span class="hs-identifier hs-type">name</span></a><span>
</span><a name="line-102"></a><span>  </span><span class="hs-identifier">ChooseFieldPrimitiveOrSchematic</span><span> </span><a href="#local-6989586621679039500"><span class="hs-identifier hs-type">t</span></a><span> </span><span class="hs-special">'</span><span class="hs-identifier hs-type">Nothing</span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">'</span><a href="Mu.Schema.Definition.html#TPrimitive"><span class="hs-identifier hs-type">TPrimitive</span></a><span> </span><a href="#local-6989586621679039500"><span class="hs-identifier hs-type">t</span></a><span>
</span><a name="line-103"></a><span>
</span><a name="line-104"></a><span class="hs-keyword">type</span><span> </span><span class="hs-keyword">family</span><span> </span><a name="ChoicesFromType"><a href="Mu.Schema.Conversion.TypesToSchema.html#ChoicesFromType"><span class="hs-identifier">ChoicesFromType</span></a></a><span> </span><span class="hs-special">(</span><a name="local-6989586621679039470"><a href="#local-6989586621679039470"><span class="hs-identifier">all</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><a href="Mu.Schema.Conversion.TypesToSchema.html#FromType"><span class="hs-identifier hs-type">FromType</span></a><span> </span><a href="#local-6989586621679039469"><span class="hs-identifier hs-type">tn</span></a><span> </span><a href="#local-6989586621679039468"><span class="hs-identifier hs-type">fn</span></a><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679039471"><a href="#local-6989586621679039471"><span class="hs-identifier">mp</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><a href="Mu.Schema.Definition.html#Mappings"><span class="hs-identifier hs-type">Mappings</span></a><span> </span><span class="hs-identifier hs-type">Symbol</span><span> </span><a href="#local-6989586621679039468"><span class="hs-identifier hs-type">fn</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679039472"><a href="#local-6989586621679039472"><span class="hs-identifier">f</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-operator">*</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-operator">*</span><span class="hs-special">)</span><span>
</span><a name="line-105"></a><span>  </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><a href="Mu.Schema.Definition.html#ChoiceDef"><span class="hs-identifier hs-type">ChoiceDef</span></a><span> </span><a href="#local-6989586621679039468"><span class="hs-identifier hs-type">fn</span></a><span class="hs-special">]</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-106"></a><span>  </span><span class="hs-identifier">ChoicesFromType</span><span> </span><a href="#local-6989586621679039473"><span class="hs-identifier hs-type">all</span></a><span> </span><a href="#local-6989586621679039474"><span class="hs-identifier hs-type">mp</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">D1</span><span> </span><a href="#local-6989586621679039475"><span class="hs-identifier hs-type">meta</span></a><span> </span><a href="#local-6989586621679039476"><span class="hs-identifier hs-type">f</span></a><span class="hs-special">)</span><span>
</span><a name="line-107"></a><span>    </span><span class="hs-glyph">=</span><span> </span><a href="Mu.Schema.Conversion.TypesToSchema.html#ChoicesFromType"><span class="hs-identifier hs-type">ChoicesFromType</span></a><span> </span><a href="#local-6989586621679039473"><span class="hs-identifier hs-type">all</span></a><span> </span><a href="#local-6989586621679039474"><span class="hs-identifier hs-type">mp</span></a><span> </span><a href="#local-6989586621679039476"><span class="hs-identifier hs-type">f</span></a><span>  </span><span class="hs-comment">-- go through data info</span><span>
</span><a name="line-108"></a><span>  </span><span class="hs-identifier">ChoicesFromType</span><span> </span><a href="#local-6989586621679039477"><span class="hs-identifier hs-type">all</span></a><span> </span><a href="#local-6989586621679039478"><span class="hs-identifier hs-type">mp</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">x</span><span> </span><span class="hs-operator hs-type">:+:</span><span> </span><a href="#local-6989586621679039480"><span class="hs-identifier hs-type">y</span></a><span class="hs-special">)</span><span>
</span><a name="line-109"></a><span>    </span><span class="hs-glyph">=</span><span> </span><a href="Mu.Schema.Conversion.TypesToSchema.html#ConcatList"><span class="hs-identifier hs-type">ConcatList</span></a><span> </span><span class="hs-special">(</span><a href="Mu.Schema.Conversion.TypesToSchema.html#ChoicesFromType"><span class="hs-identifier hs-type">ChoicesFromType</span></a><span> </span><a href="#local-6989586621679039477"><span class="hs-identifier hs-type">all</span></a><span> </span><a href="#local-6989586621679039478"><span class="hs-identifier hs-type">mp</span></a><span> </span><a href="#local-6989586621679039479"><span class="hs-identifier hs-type">x</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Mu.Schema.Conversion.TypesToSchema.html#ChoicesFromType"><span class="hs-identifier hs-type">ChoicesFromType</span></a><span> </span><a href="#local-6989586621679039477"><span class="hs-identifier hs-type">all</span></a><span> </span><a href="#local-6989586621679039478"><span class="hs-identifier hs-type">mp</span></a><span> </span><a href="#local-6989586621679039480"><span class="hs-identifier hs-type">y</span></a><span class="hs-special">)</span><span>
</span><a name="line-110"></a><span>  </span><span class="hs-identifier">ChoicesFromType</span><span> </span><a href="#local-6989586621679039481"><span class="hs-identifier hs-type">all</span></a><span> </span><a href="#local-6989586621679039482"><span class="hs-identifier hs-type">mp</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">C1</span><span> </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="hs-identifier hs-type">MetaCons</span><span> </span><a href="#local-6989586621679039483"><span class="hs-identifier hs-type">cname</span></a><span> </span><a href="#local-6989586621679039484"><span class="hs-identifier hs-type">p</span></a><span> </span><a href="#local-6989586621679039485"><span class="hs-identifier hs-type">s</span></a><span class="hs-special">)</span><span> </span><span class="hs-identifier hs-type">U1</span><span class="hs-special">)</span><span>
</span><a name="line-111"></a><span>    </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">'</span><span class="hs-special">[</span><span> </span><span class="hs-special">'</span><a href="Mu.Schema.Definition.html#ChoiceDef"><span class="hs-identifier hs-type">ChoiceDef</span></a><span> </span><span class="hs-special">(</span><a href="Mu.Schema.Definition.html#MappingRight"><span class="hs-identifier hs-type">MappingRight</span></a><span> </span><a href="#local-6989586621679039482"><span class="hs-identifier hs-type">mp</span></a><span> </span><a href="#local-6989586621679039483"><span class="hs-identifier hs-type">cname</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">]</span><span>  </span><span class="hs-comment">-- go through constructor info</span><span>
</span><a name="line-112"></a><span>  </span><span class="hs-identifier">ChoicesFromType</span><span> </span><a href="#local-6989586621679039486"><span class="hs-identifier hs-type">all</span></a><span> </span><a href="#local-6989586621679039487"><span class="hs-identifier hs-type">mp</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">C1</span><span> </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="hs-identifier hs-type">MetaCons</span><span> </span><a href="#local-6989586621679039488"><span class="hs-identifier hs-type">cname</span></a><span> </span><a href="#local-6989586621679039489"><span class="hs-identifier hs-type">p</span></a><span> </span><a href="#local-6989586621679039490"><span class="hs-identifier hs-type">s</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679039491"><span class="hs-identifier hs-type">f</span></a><span class="hs-special">)</span><span>
</span><a name="line-113"></a><span>    </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-type">TypeError</span><span> </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="hs-identifier hs-type">Text</span><span> </span><span class="hs-string">&quot;constructor &quot;</span><span> </span><span class="hs-special">'</span><span class="hs-operator hs-type">:&lt;&gt;:</span><span> </span><span class="hs-special">'</span><span class="hs-identifier hs-type">ShowType</span><span> </span><a href="#local-6989586621679039488"><span class="hs-identifier hs-type">cname</span></a><span> </span><span class="hs-special">'</span><span class="hs-operator">:&lt;&gt;:</span><span> </span><span class="hs-special">'</span><span class="hs-identifier hs-type">Text</span><span> </span><span class="hs-string">&quot;has fields and cannot be turned into an enumeration schema&quot;</span><span class="hs-special">)</span><span>
</span><a name="line-114"></a><span>  </span><span class="hs-identifier">ChoicesFromType</span><span> </span><a href="#local-6989586621679039492"><span class="hs-identifier hs-type">all</span></a><span> </span><a href="#local-6989586621679039493"><span class="hs-identifier hs-type">mp</span></a><span> </span><a href="#local-6989586621679039494"><span class="hs-identifier hs-type">v</span></a><span>
</span><a name="line-115"></a><span>    </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-type">TypeError</span><span> </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="hs-identifier hs-type">Text</span><span> </span><span class="hs-string">&quot;unsupported conversion from &quot;</span><span> </span><span class="hs-special">'</span><span class="hs-operator hs-type">:&lt;&gt;:</span><span> </span><span class="hs-special">'</span><span class="hs-identifier hs-type">ShowType</span><span> </span><a href="#local-6989586621679039494"><span class="hs-identifier hs-type">v</span></a><span> </span><span class="hs-special">'</span><span class="hs-operator">:&lt;&gt;:</span><span> </span><span class="hs-special">'</span><span class="hs-identifier hs-type">Text</span><span> </span><span class="hs-string">&quot; to enumeration schema&quot;</span><span class="hs-special">)</span><span>
</span><a name="line-116"></a></pre></body></html>