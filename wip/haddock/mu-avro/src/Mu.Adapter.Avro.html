<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# language ConstraintKinds       #-}</span><span>
</span><span id="line-2"></span><span class="hs-pragma">{-# language DataKinds             #-}</span><span>
</span><span id="line-3"></span><span class="hs-pragma">{-# language FlexibleContexts      #-}</span><span>
</span><span id="line-4"></span><span class="hs-pragma">{-# language FlexibleInstances     #-}</span><span>
</span><span id="line-5"></span><span class="hs-pragma">{-# language GADTs                 #-}</span><span>
</span><span id="line-6"></span><span class="hs-pragma">{-# language MultiParamTypeClasses #-}</span><span>
</span><span id="line-7"></span><span class="hs-pragma">{-# language PolyKinds             #-}</span><span>
</span><span id="line-8"></span><span class="hs-pragma">{-# language RankNTypes            #-}</span><span>
</span><span id="line-9"></span><span class="hs-pragma">{-# language ScopedTypeVariables   #-}</span><span>
</span><span id="line-10"></span><span class="hs-pragma">{-# language TypeApplications      #-}</span><span>
</span><span id="line-11"></span><span class="hs-pragma">{-# language TypeFamilies          #-}</span><span>
</span><span id="line-12"></span><span class="hs-pragma">{-# language TypeOperators         #-}</span><span>
</span><span id="line-13"></span><span class="hs-pragma">{-# language UndecidableInstances  #-}</span><span>
</span><span id="line-14"></span><span class="hs-pragma">{-#&#160;OPTIONS_GHC -fno-warn-orphans #-}</span><span>
</span><span id="line-15"></span><span class="hs-comment">{-|
Description : Adapter for Avro serialization

Just import the module and you can turn any
value with a 'ToSchema' and 'FromSchema' from
and to Avro values.
-}</span><span>
</span><span id="line-22"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Mu.Adapter.Avro</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-23"></span><span>
</span><span id="line-24"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Control.Applicative</span></span><span>                 </span><span class="hs-special">(</span><span class="annot"><span class="hs-operator">(&lt;|&gt;)</span></span><span class="hs-special">)</span><span>
</span><span id="line-25"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Control.Arrow</span></span><span>                       </span><span class="hs-special">(</span><span class="annot"><span class="hs-operator">(***)</span></span><span class="hs-special">)</span><span>
</span><span id="line-26"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.Avro</span></span><span>                           </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">A</span></span><span>
</span><span id="line-27"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.Avro.Encoding.FromAvro</span></span><span>         </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">AVal</span></span><span>
</span><span id="line-28"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.Avro.Encoding.ToAvro</span></span><span>           </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">A</span></span><span>
</span><span id="line-29"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.Avro.Schema.ReadSchema</span></span><span>         </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">RSch</span></span><span>
</span><span id="line-30"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.Avro.Schema.Schema</span></span><span>             </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">ASch</span></span><span>
</span><span id="line-31"></span><span class="hs-comment">-- 'Tagged . unTagged' can be replaced by 'coerce'</span><span>
</span><span id="line-32"></span><span class="hs-comment">-- eliminating some run-time overhead</span><span>
</span><span id="line-33"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Data.Avro.EitherN</span></span><span>                   </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">putIndexedValue</span></span><span class="hs-special">)</span><span>
</span><span id="line-34"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Data.ByteString.Builder</span></span><span>             </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Builder</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">word8</span></span><span class="hs-special">)</span><span>
</span><span id="line-35"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Data.Coerce</span></span><span>                         </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">coerce</span></span><span class="hs-special">)</span><span>
</span><span id="line-36"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.HashMap.Strict</span></span><span>                 </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">HM</span></span><span>
</span><span id="line-37"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Data.List</span></span><span>                           </span><span class="hs-special">(</span><span class="annot"><span class="hs-operator">(\\)</span></span><span class="hs-special">)</span><span>
</span><span id="line-38"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Data.List.NonEmpty</span></span><span>                  </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">NonEmpty</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-39"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.List.NonEmpty</span></span><span>                  </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">NonEmptyList</span></span><span>
</span><span id="line-40"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.Map</span></span><span>                            </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">M</span></span><span>
</span><span id="line-41"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Data.Maybe</span></span><span>                          </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">fromJust</span></span><span class="hs-special">)</span><span>
</span><span id="line-42"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Data.Tagged</span></span><span>
</span><span id="line-43"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.Text</span></span><span>                           </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">T</span></span><span>
</span><span id="line-44"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.Vector</span></span><span>                         </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">V</span></span><span>
</span><span id="line-45"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">GHC.TypeLits</span></span><span>
</span><span id="line-46"></span><span>
</span><span id="line-47"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Mu.Schema</span></span><span>
</span><span id="line-48"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Mu.Schema.Interpretation.Schemaless</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">SLess</span></span><span>
</span><span id="line-49"></span><span>
</span><span id="line-50"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><span class="hs-identifier hs-type">SLess.ToSchemalessTerm</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">AVal.Value</span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-51"></span><span>  </span><span id="local-6989586621679159151"><span class="annot"><span class="annottext">toSchemalessTerm :: Value -&gt; Term
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">toSchemalessTerm</span></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">AVal.Record</span></span><span> </span><span id="local-6989586621679159148"><span class="annot"><span class="annottext">s :: ReadSchema
</span><a href="#local-6989586621679159148"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span id="local-6989586621679159147"><span class="annot"><span class="annottext">r :: Vector Value
</span><a href="#local-6989586621679159147"><span class="hs-identifier hs-var">r</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-52"></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">ReadSchema
</span><a href="#local-6989586621679159148"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-53"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">RSch.Record</span></span><span> </span><span class="hs-special">{</span><span>&#160;</span><span class="annot"><span class="annottext">fields :: ReadSchema -&gt; [ReadField]
</span><span class="hs-identifier hs-var">RSch.fields</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621679159144"><span class="annot"><span class="annottext">[ReadField]
</span><a href="#local-6989586621679159144"><span class="hs-identifier hs-var">fs</span></a></span></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-54"></span><span>          </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[Field] -&gt; Term
</span><span class="hs-identifier hs-var">SLess.TRecord</span></span><span> </span><span class="annot"><span class="annottext">([Field] -&gt; Term) -&gt; [Field] -&gt; Term
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">((Text, Value) -&gt; Field) -&gt; [(Text, Value)] -&gt; [Field]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span id="local-6989586621679159142"><span class="annot"><span class="annottext">k :: Text
</span><a href="#local-6989586621679159142"><span class="hs-identifier hs-var">k</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679159141"><span class="annot"><span class="annottext">v :: Value
</span><a href="#local-6989586621679159141"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Text -&gt; FieldValue -&gt; Field
</span><span class="hs-identifier hs-var">SLess.Field</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679159142"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Value -&gt; FieldValue
forall t. ToSchemalessValue t =&gt; t -&gt; FieldValue
</span><span class="hs-identifier hs-var">SLess.toSchemalessValue</span></span><span> </span><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621679159141"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-55"></span><span>                           </span><span class="annot"><span class="annottext">([(Text, Value)] -&gt; [Field]) -&gt; [(Text, Value)] -&gt; [Field]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[Text] -&gt; [Value] -&gt; [(Text, Value)]
forall a b. [a] -&gt; [b] -&gt; [(a, b)]
</span><span class="hs-identifier hs-var">zip</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(ReadField -&gt; Text) -&gt; [ReadField] -&gt; [Text]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">ReadField -&gt; Text
</span><span class="hs-identifier hs-var hs-var">RSch.fldName</span></span><span> </span><span class="annot"><span class="annottext">[ReadField]
</span><a href="#local-6989586621679159144"><span class="hs-identifier hs-var">fs</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Vector Value -&gt; [Value]
forall a. Vector a -&gt; [a]
</span><span class="hs-identifier hs-var">V.toList</span></span><span> </span><span class="annot"><span class="annottext">Vector Value
</span><a href="#local-6989586621679159147"><span class="hs-identifier hs-var">r</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-56"></span><span>        </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; Term
forall a. HasCallStack =&gt; [Char] -&gt; a
</span><span class="hs-identifier hs-var">error</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-string">&quot;this should never happen:\n&quot;</span></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; [Char] -&gt; [Char]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">ReadSchema -&gt; [Char]
forall a. Show a =&gt; a -&gt; [Char]
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">ReadSchema
</span><a href="#local-6989586621679159148"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-57"></span><span>  </span><span class="annot"><span class="hs-identifier hs-var">toSchemalessTerm</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">AVal.Enum</span></span><span> </span><span class="hs-identifier">_</span><span> </span><span id="local-6989586621679159133"><span class="annot"><span class="annottext">i :: Int
</span><a href="#local-6989586621679159133"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span>
</span><span id="line-58"></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Term
</span><span class="hs-identifier hs-var">SLess.TEnum</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679159133"><span class="hs-identifier hs-var">i</span></a></span><span>
</span><span id="line-59"></span><span>  </span><span class="annot"><span class="hs-identifier hs-var">toSchemalessTerm</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">AVal.Union</span></span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span id="local-6989586621679159130"><span class="annot"><span class="annottext">v :: Value
</span><a href="#local-6989586621679159130"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-60"></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Value -&gt; Term
forall t. ToSchemalessTerm t =&gt; t -&gt; Term
</span><span class="hs-identifier hs-var">SLess.toSchemalessTerm</span></span><span> </span><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621679159130"><span class="hs-identifier hs-var">v</span></a></span><span>
</span><span id="line-61"></span><span>  </span><span class="annot"><span class="hs-identifier hs-var">toSchemalessTerm</span></span><span> </span><span id="local-6989586621679159129"><span class="annot"><span class="annottext">v :: Value
</span><a href="#local-6989586621679159129"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FieldValue -&gt; Term
</span><span class="hs-identifier hs-var">SLess.TSimple</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Value -&gt; FieldValue
forall t. ToSchemalessValue t =&gt; t -&gt; FieldValue
</span><span class="hs-identifier hs-var">SLess.toSchemalessValue</span></span><span> </span><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621679159129"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-62"></span><span>
</span><span id="line-63"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><span class="hs-identifier hs-type">SLess.ToSchemalessValue</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">AVal.Value</span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-64"></span><span>  </span><span id="local-6989586621679159125"><span class="annot"><span class="annottext">toSchemalessValue :: Value -&gt; FieldValue
</span><a href="#local-6989586621679159125"><span class="hs-identifier hs-var hs-var hs-var hs-var">toSchemalessValue</span></a></span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">AVal.Null</span></span><span>         </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FieldValue
</span><span class="hs-identifier hs-var">SLess.FNull</span></span><span>
</span><span id="line-65"></span><span>  </span><span class="annot"><span class="hs-identifier hs-var">toSchemalessValue</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">AVal.Boolean</span></span><span>  </span><span id="local-6989586621679159121"><span class="annot"><span class="annottext">b :: Bool
</span><a href="#local-6989586621679159121"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; FieldValue
forall t. (Typeable t, Eq t, Ord t, Show t) =&gt; t -&gt; FieldValue
</span><span class="hs-identifier hs-var">SLess.FPrimitive</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679159121"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-66"></span><span>  </span><span class="annot"><span class="hs-identifier hs-var">toSchemalessValue</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">AVal.Int</span></span><span>    </span><span class="hs-identifier">_</span><span> </span><span id="local-6989586621679159118"><span class="annot"><span class="annottext">b :: Int32
</span><a href="#local-6989586621679159118"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int32 -&gt; FieldValue
forall t. (Typeable t, Eq t, Ord t, Show t) =&gt; t -&gt; FieldValue
</span><span class="hs-identifier hs-var">SLess.FPrimitive</span></span><span> </span><span class="annot"><span class="annottext">Int32
</span><a href="#local-6989586621679159118"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-67"></span><span>  </span><span class="annot"><span class="hs-identifier hs-var">toSchemalessValue</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">AVal.Long</span></span><span>   </span><span class="hs-identifier">_</span><span> </span><span id="local-6989586621679159116"><span class="annot"><span class="annottext">b :: Int64
</span><a href="#local-6989586621679159116"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int64 -&gt; FieldValue
forall t. (Typeable t, Eq t, Ord t, Show t) =&gt; t -&gt; FieldValue
</span><span class="hs-identifier hs-var">SLess.FPrimitive</span></span><span> </span><span class="annot"><span class="annottext">Int64
</span><a href="#local-6989586621679159116"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-68"></span><span>  </span><span class="annot"><span class="hs-identifier hs-var">toSchemalessValue</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">AVal.Float</span></span><span>  </span><span class="hs-identifier">_</span><span> </span><span id="local-6989586621679159114"><span class="annot"><span class="annottext">b :: Float
</span><a href="#local-6989586621679159114"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Float -&gt; FieldValue
forall t. (Typeable t, Eq t, Ord t, Show t) =&gt; t -&gt; FieldValue
</span><span class="hs-identifier hs-var">SLess.FPrimitive</span></span><span> </span><span class="annot"><span class="annottext">Float
</span><a href="#local-6989586621679159114"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-69"></span><span>  </span><span class="annot"><span class="hs-identifier hs-var">toSchemalessValue</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">AVal.Double</span></span><span> </span><span class="hs-identifier">_</span><span> </span><span id="local-6989586621679159112"><span class="annot"><span class="annottext">b :: Double
</span><a href="#local-6989586621679159112"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double -&gt; FieldValue
forall t. (Typeable t, Eq t, Ord t, Show t) =&gt; t -&gt; FieldValue
</span><span class="hs-identifier hs-var">SLess.FPrimitive</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679159112"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-70"></span><span>  </span><span class="annot"><span class="hs-identifier hs-var">toSchemalessValue</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">AVal.String</span></span><span> </span><span class="hs-identifier">_</span><span> </span><span id="local-6989586621679159110"><span class="annot"><span class="annottext">b :: Text
</span><a href="#local-6989586621679159110"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Text -&gt; FieldValue
forall t. (Typeable t, Eq t, Ord t, Show t) =&gt; t -&gt; FieldValue
</span><span class="hs-identifier hs-var">SLess.FPrimitive</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679159110"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-71"></span><span>  </span><span class="annot"><span class="hs-identifier hs-var">toSchemalessValue</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">AVal.Fixed</span></span><span>  </span><span class="hs-identifier">_</span><span> </span><span id="local-6989586621679159108"><span class="annot"><span class="annottext">b :: ByteString
</span><a href="#local-6989586621679159108"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; FieldValue
forall t. (Typeable t, Eq t, Ord t, Show t) =&gt; t -&gt; FieldValue
</span><span class="hs-identifier hs-var">SLess.FPrimitive</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679159108"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-72"></span><span>  </span><span class="annot"><span class="hs-identifier hs-var">toSchemalessValue</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">AVal.Bytes</span></span><span>  </span><span class="hs-identifier">_</span><span> </span><span id="local-6989586621679159106"><span class="annot"><span class="annottext">b :: ByteString
</span><a href="#local-6989586621679159106"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; FieldValue
forall t. (Typeable t, Eq t, Ord t, Show t) =&gt; t -&gt; FieldValue
</span><span class="hs-identifier hs-var">SLess.FPrimitive</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679159106"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-73"></span><span>  </span><span class="annot"><span class="hs-identifier hs-var">toSchemalessValue</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">AVal.Array</span></span><span> </span><span id="local-6989586621679159104"><span class="annot"><span class="annottext">v :: Vector Value
</span><a href="#local-6989586621679159104"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-74"></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[FieldValue] -&gt; FieldValue
</span><span class="hs-identifier hs-var">SLess.FList</span></span><span> </span><span class="annot"><span class="annottext">([FieldValue] -&gt; FieldValue) -&gt; [FieldValue] -&gt; FieldValue
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(Value -&gt; FieldValue) -&gt; [Value] -&gt; [FieldValue]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">Value -&gt; FieldValue
forall t. ToSchemalessValue t =&gt; t -&gt; FieldValue
</span><span class="hs-identifier hs-var">SLess.toSchemalessValue</span></span><span> </span><span class="annot"><span class="annottext">([Value] -&gt; [FieldValue]) -&gt; [Value] -&gt; [FieldValue]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Vector Value -&gt; [Value]
forall a. Vector a -&gt; [a]
</span><span class="hs-identifier hs-var">V.toList</span></span><span> </span><span class="annot"><span class="annottext">Vector Value
</span><a href="#local-6989586621679159104"><span class="hs-identifier hs-var">v</span></a></span><span>
</span><span id="line-75"></span><span>  </span><span class="annot"><span class="hs-identifier hs-var">toSchemalessValue</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">AVal.Map</span></span><span> </span><span id="local-6989586621679159101"><span class="annot"><span class="annottext">hm :: HashMap Text Value
</span><a href="#local-6989586621679159101"><span class="hs-identifier hs-var">hm</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-76"></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Map FieldValue FieldValue -&gt; FieldValue
</span><span class="hs-identifier hs-var">SLess.FMap</span></span><span> </span><span class="annot"><span class="annottext">(Map FieldValue FieldValue -&gt; FieldValue)
-&gt; Map FieldValue FieldValue -&gt; FieldValue
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[(FieldValue, FieldValue)] -&gt; Map FieldValue FieldValue
forall k a. Ord k =&gt; [(k, a)] -&gt; Map k a
</span><span class="hs-identifier hs-var">M.fromList</span></span><span>
</span><span id="line-77"></span><span>                 </span><span class="annot"><span class="annottext">([(FieldValue, FieldValue)] -&gt; Map FieldValue FieldValue)
-&gt; [(FieldValue, FieldValue)] -&gt; Map FieldValue FieldValue
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">((Text, Value) -&gt; (FieldValue, FieldValue))
-&gt; [(Text, Value)] -&gt; [(FieldValue, FieldValue)]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Text -&gt; FieldValue
forall t. (Typeable t, Eq t, Ord t, Show t) =&gt; t -&gt; FieldValue
</span><span class="hs-identifier hs-var">SLess.FPrimitive</span></span><span> </span><span class="annot"><span class="annottext">(Text -&gt; FieldValue)
-&gt; (Value -&gt; FieldValue)
-&gt; (Text, Value)
-&gt; (FieldValue, FieldValue)
forall (a :: * -&gt; * -&gt; *) b c b' c'.
Arrow a =&gt;
a b c -&gt; a b' c' -&gt; a (b, b') (c, c')
</span><span class="hs-operator hs-var">***</span></span><span> </span><span class="annot"><span class="annottext">Value -&gt; FieldValue
forall t. ToSchemalessValue t =&gt; t -&gt; FieldValue
</span><span class="hs-identifier hs-var">SLess.toSchemalessValue</span></span><span class="hs-special">)</span><span>
</span><span id="line-78"></span><span>                 </span><span class="annot"><span class="annottext">([(Text, Value)] -&gt; [(FieldValue, FieldValue)])
-&gt; [(Text, Value)] -&gt; [(FieldValue, FieldValue)]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">HashMap Text Value -&gt; [(Text, Value)]
forall k v. HashMap k v -&gt; [(k, v)]
</span><span class="hs-identifier hs-var">HM.toList</span></span><span> </span><span class="annot"><span class="annottext">HashMap Text Value
</span><a href="#local-6989586621679159101"><span class="hs-identifier hs-var">hm</span></a></span><span>
</span><span id="line-79"></span><span>  </span><span class="annot"><span class="hs-identifier hs-var">toSchemalessValue</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">AVal.Union</span></span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span id="local-6989586621679159097"><span class="annot"><span class="annottext">v :: Value
</span><a href="#local-6989586621679159097"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-80"></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Value -&gt; FieldValue
forall t. ToSchemalessValue t =&gt; t -&gt; FieldValue
</span><span class="hs-identifier hs-var">SLess.toSchemalessValue</span></span><span> </span><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621679159097"><span class="hs-identifier hs-var">v</span></a></span><span>
</span><span id="line-81"></span><span>  </span><span class="annot"><span class="hs-identifier hs-var">toSchemalessValue</span></span><span> </span><span id="local-6989586621679159096"><span class="annot"><span class="annottext">r :: Value
</span><a href="#local-6989586621679159096"><span class="hs-identifier hs-var">r</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">AVal.Record</span></span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span>
</span><span id="line-82"></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Term -&gt; FieldValue
</span><span class="hs-identifier hs-var">SLess.FSchematic</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Value -&gt; Term
forall t. ToSchemalessTerm t =&gt; t -&gt; Term
</span><span class="hs-identifier hs-var">SLess.toSchemalessTerm</span></span><span> </span><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621679159096"><span class="hs-identifier hs-var">r</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-83"></span><span>  </span><span class="annot"><span class="hs-identifier hs-var">toSchemalessValue</span></span><span> </span><span id="local-6989586621679159094"><span class="annot"><span class="annottext">e :: Value
</span><a href="#local-6989586621679159094"><span class="hs-identifier hs-var">e</span></a></span></span><span class="hs-glyph">@</span><span class="annot"><span class="hs-identifier hs-type">AVal.Enum</span></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span>
</span><span id="line-84"></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Term -&gt; FieldValue
</span><span class="hs-identifier hs-var">SLess.FSchematic</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Value -&gt; Term
forall t. ToSchemalessTerm t =&gt; t -&gt; Term
</span><span class="hs-identifier hs-var">SLess.toSchemalessTerm</span></span><span> </span><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621679159094"><span class="hs-identifier hs-var">e</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-85"></span><span>
</span><span id="line-86"></span><span id="local-6989586621679159091"><span id="local-6989586621679159092"><span id="local-6989586621679159093"><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Mu.Adapter.Avro.html#HasAvroSchemas"><span class="hs-identifier hs-type">HasAvroSchemas</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679159093"><span class="hs-identifier hs-type">sch</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679159093"><span class="hs-identifier hs-type">sch</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-87"></span><span>         </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">A.HasAvroSchema</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">WithSchema</span></span><span> </span><span class="annot"><a href="#local-6989586621679159093"><span class="hs-identifier hs-type">sch</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679159092"><span class="hs-identifier hs-type">sty</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679159091"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-88"></span><span>  </span><span id="local-6989586621679159088"><span class="annot"><span class="annottext">schema :: Tagged (WithSchema sch sty t) Schema
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">schema</span></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Schema -&gt; Tagged (WithSchema sch sty t) Schema
forall k (s :: k) b. b -&gt; Tagged s b
</span><span class="hs-identifier hs-var">Tagged</span></span><span> </span><span class="annot"><span class="annottext">(Schema -&gt; Tagged (WithSchema sch sty t) Schema)
-&gt; Schema -&gt; Tagged (WithSchema sch sty t) Schema
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Vector Schema -&gt; Schema
</span><span class="hs-identifier hs-var">ASch.Union</span></span><span> </span><span class="annot"><span class="annottext">(Vector Schema -&gt; Schema) -&gt; Vector Schema -&gt; Schema
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Proxy sch -&gt; Proxy sch -&gt; [TypeName] -&gt; Vector Schema
forall tn fn (r :: Schema tn fn) (sch :: Schema tn fn).
HasAvroSchemas r sch =&gt;
Proxy r -&gt; Proxy sch -&gt; [TypeName] -&gt; Vector Schema
</span><a href="Mu.Adapter.Avro.html#schemas"><span class="hs-identifier hs-var">schemas</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Proxy sch
forall k (t :: k). Proxy t
</span><span class="hs-identifier hs-var">Proxy</span></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621679159093"><span class="hs-identifier hs-type">sch</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Proxy sch
forall k (t :: k). Proxy t
</span><span class="hs-identifier hs-var">Proxy</span></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621679159093"><span class="hs-identifier hs-type">sch</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[TypeName]
</span><a href="#local-6989586621679159082"><span class="hs-identifier hs-var">ts</span></a></span><span>
</span><span id="line-89"></span><span>    </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621679159082"><span class="annot"><span class="annottext">ts :: [TypeName]
</span><a href="#local-6989586621679159082"><span class="hs-identifier hs-var hs-var">ts</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Proxy sch -&gt; Proxy sch -&gt; [TypeName]
forall tn fn (r :: Schema tn fn) (sch :: Schema tn fn).
HasAvroSchemas r sch =&gt;
Proxy r -&gt; Proxy sch -&gt; [TypeName]
</span><a href="Mu.Adapter.Avro.html#typeNames"><span class="hs-identifier hs-var">typeNames</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Proxy sch
forall k (t :: k). Proxy t
</span><span class="hs-identifier hs-var">Proxy</span></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621679159093"><span class="hs-identifier hs-type">sch</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Proxy sch
forall k (t :: k). Proxy t
</span><span class="hs-identifier hs-var">Proxy</span></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621679159093"><span class="hs-identifier hs-type">sch</span></a></span><span class="hs-special">)</span></span></span></span><span>
</span><span id="line-90"></span><span id="local-6989586621679159078"><span id="local-6989586621679159079"><span id="local-6989586621679159080"><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-identifier hs-type">FromSchema</span></span><span> </span><span class="annot"><a href="#local-6989586621679159080"><span class="hs-identifier hs-type">sch</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679159079"><span class="hs-identifier hs-type">sty</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679159078"><span class="hs-identifier hs-type">t</span></a></span><span>
</span><span id="line-91"></span><span>         </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">A.FromAvro</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Term</span></span><span> </span><span class="annot"><a href="#local-6989586621679159080"><span class="hs-identifier hs-type">sch</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679159080"><span class="hs-identifier hs-type">sch</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">:/:</span></span><span> </span><span class="annot"><a href="#local-6989586621679159079"><span class="hs-identifier hs-type">sty</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-92"></span><span>         </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">A.FromAvro</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">WithSchema</span></span><span> </span><span class="annot"><a href="#local-6989586621679159080"><span class="hs-identifier hs-type">sch</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679159079"><span class="hs-identifier hs-type">sty</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679159078"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-93"></span><span>  </span><span id="local-6989586621679159075"><span class="annot"><span class="annottext">fromAvro :: Value -&gt; Either [Char] (WithSchema sch sty t)
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">fromAvro</span></span></span><span> </span><span id="local-6989586621679159073"><span class="annot"><span class="annottext">entire :: Value
</span><a href="#local-6989586621679159073"><span class="hs-identifier hs-var">entire</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">AVal.Union</span></span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span id="local-6989586621679159072"><span class="annot"><span class="annottext">v :: Value
</span><a href="#local-6989586621679159072"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-94"></span><span>    </span><span class="hs-glyph">=</span><span>   </span><span class="hs-comment">-- remove first layer of union</span><span>
</span><span id="line-95"></span><span>        </span><span class="annot"><span class="annottext">t -&gt; WithSchema sch sty t
forall tn fn (sch :: Schema tn fn) (sty :: tn) a.
a -&gt; WithSchema sch sty a
</span><span class="hs-identifier hs-var">WithSchema</span></span><span> </span><span class="annot"><span class="annottext">(t -&gt; WithSchema sch sty t)
-&gt; (Term sch (sch :/: sty) -&gt; t)
-&gt; Term sch (sch :/: sty)
-&gt; WithSchema sch sty t
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">forall t (sty :: tn).
FromSchema sch sty t =&gt;
Term sch (sch :/: sty) -&gt; t
forall fn tn (sch :: Schema tn fn) t (sty :: tn).
FromSchema sch sty t =&gt;
Term sch (sch :/: sty) -&gt; t
</span><span class="hs-identifier hs-var">fromSchema'</span></span><span> </span><span class="hs-glyph">@</span><span class="annot"><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">@</span><span class="annot"><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621679159080"><span class="hs-identifier hs-type">sch</span></a></span><span> </span><span class="annot"><span class="annottext">(Term sch (sch :/: sty) -&gt; WithSchema sch sty t)
-&gt; Either [Char] (Term sch (sch :/: sty))
-&gt; Either [Char] (WithSchema sch sty t)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Value -&gt; Either [Char] (Term sch (sch :/: sty))
forall a. FromAvro a =&gt; Value -&gt; Either [Char] a
</span><span class="hs-identifier hs-var">AVal.fromAvro</span></span><span> </span><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621679159072"><span class="hs-identifier hs-var">v</span></a></span><span>
</span><span id="line-96"></span><span>    </span><span class="annot"><span class="annottext">Either [Char] (WithSchema sch sty t)
-&gt; Either [Char] (WithSchema sch sty t)
-&gt; Either [Char] (WithSchema sch sty t)
forall (f :: * -&gt; *) a. Alternative f =&gt; f a -&gt; f a -&gt; f a
</span><span class="hs-operator hs-var">&lt;|&gt;</span></span><span> </span><span class="hs-comment">-- try with the entire thing</span><span>
</span><span id="line-97"></span><span>        </span><span class="annot"><span class="annottext">t -&gt; WithSchema sch sty t
forall tn fn (sch :: Schema tn fn) (sty :: tn) a.
a -&gt; WithSchema sch sty a
</span><span class="hs-identifier hs-var">WithSchema</span></span><span> </span><span class="annot"><span class="annottext">(t -&gt; WithSchema sch sty t)
-&gt; (Term sch (sch :/: sty) -&gt; t)
-&gt; Term sch (sch :/: sty)
-&gt; WithSchema sch sty t
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">forall t (sty :: tn).
FromSchema sch sty t =&gt;
Term sch (sch :/: sty) -&gt; t
forall fn tn (sch :: Schema tn fn) t (sty :: tn).
FromSchema sch sty t =&gt;
Term sch (sch :/: sty) -&gt; t
</span><span class="hs-identifier hs-var">fromSchema'</span></span><span> </span><span class="hs-glyph">@</span><span class="annot"><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">@</span><span class="annot"><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621679159080"><span class="hs-identifier hs-type">sch</span></a></span><span> </span><span class="annot"><span class="annottext">(Term sch (sch :/: sty) -&gt; WithSchema sch sty t)
-&gt; Either [Char] (Term sch (sch :/: sty))
-&gt; Either [Char] (WithSchema sch sty t)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Value -&gt; Either [Char] (Term sch (sch :/: sty))
forall a. FromAvro a =&gt; Value -&gt; Either [Char] a
</span><span class="hs-identifier hs-var">AVal.fromAvro</span></span><span> </span><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621679159073"><span class="hs-identifier hs-var">entire</span></a></span><span>
</span><span id="line-98"></span><span>  </span><span class="annot"><span class="hs-identifier hs-var">fromAvro</span></span><span> </span><span id="local-6989586621679159067"><span class="annot"><span class="annottext">entire :: Value
</span><a href="#local-6989586621679159067"><span class="hs-identifier hs-var">entire</span></a></span></span><span>
</span><span id="line-99"></span><span>    </span><span class="hs-glyph">=</span><span>   </span><span class="annot"><span class="annottext">t -&gt; WithSchema sch sty t
forall tn fn (sch :: Schema tn fn) (sty :: tn) a.
a -&gt; WithSchema sch sty a
</span><span class="hs-identifier hs-var">WithSchema</span></span><span> </span><span class="annot"><span class="annottext">(t -&gt; WithSchema sch sty t)
-&gt; (Term sch (sch :/: sty) -&gt; t)
-&gt; Term sch (sch :/: sty)
-&gt; WithSchema sch sty t
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">forall t (sty :: tn).
FromSchema sch sty t =&gt;
Term sch (sch :/: sty) -&gt; t
forall fn tn (sch :: Schema tn fn) t (sty :: tn).
FromSchema sch sty t =&gt;
Term sch (sch :/: sty) -&gt; t
</span><span class="hs-identifier hs-var">fromSchema'</span></span><span> </span><span class="hs-glyph">@</span><span class="annot"><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">@</span><span class="annot"><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621679159080"><span class="hs-identifier hs-type">sch</span></a></span><span> </span><span class="annot"><span class="annottext">(Term sch (sch :/: sty) -&gt; WithSchema sch sty t)
-&gt; Either [Char] (Term sch (sch :/: sty))
-&gt; Either [Char] (WithSchema sch sty t)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Value -&gt; Either [Char] (Term sch (sch :/: sty))
forall a. FromAvro a =&gt; Value -&gt; Either [Char] a
</span><span class="hs-identifier hs-var">AVal.fromAvro</span></span><span> </span><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621679159067"><span class="hs-identifier hs-var">entire</span></a></span></span></span></span><span>
</span><span id="line-100"></span><span id="local-6989586621679159064"><span id="local-6989586621679159065"><span id="local-6989586621679159066"><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ToSchema</span></span><span> </span><span class="annot"><a href="#local-6989586621679159066"><span class="hs-identifier hs-type">sch</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679159065"><span class="hs-identifier hs-type">sty</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679159064"><span class="hs-identifier hs-type">t</span></a></span><span>
</span><span id="line-101"></span><span>         </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">A.ToAvro</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Term</span></span><span> </span><span class="annot"><a href="#local-6989586621679159066"><span class="hs-identifier hs-type">sch</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679159066"><span class="hs-identifier hs-type">sch</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">:/:</span></span><span> </span><span class="annot"><a href="#local-6989586621679159065"><span class="hs-identifier hs-type">sty</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-102"></span><span>         </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">KnownNat</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Mu.Adapter.Avro.html#IxOf"><span class="hs-identifier hs-type">IxOf</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679159066"><span class="hs-identifier hs-type">sch</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679159065"><span class="hs-identifier hs-type">sty</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-103"></span><span>         </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">A.ToAvro</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">WithSchema</span></span><span> </span><span class="annot"><a href="#local-6989586621679159066"><span class="hs-identifier hs-type">sch</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679159065"><span class="hs-identifier hs-type">sty</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679159064"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-104"></span><span>  </span><span id="local-6989586621679159061"><span class="annot"><span class="annottext">toAvro :: Schema -&gt; WithSchema sch sty t -&gt; Builder
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">toAvro</span></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">ASch.Union</span></span><span> </span><span id="local-6989586621679159059"><span class="annot"><span class="annottext">vs :: Vector Schema
</span><a href="#local-6989586621679159059"><span class="hs-identifier hs-var">vs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">WithSchema</span></span><span> </span><span id="local-6989586621679159058"><span class="annot"><span class="annottext">v :: t
</span><a href="#local-6989586621679159058"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-105"></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Vector Schema -&gt; Term sch (sch :/: sty) -&gt; Builder
forall a. ToAvro a =&gt; Int -&gt; Vector Schema -&gt; a -&gt; Builder
</span><span class="hs-identifier hs-var">putIndexedValue</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer -&gt; Int
forall a. Num a =&gt; Integer -&gt; a
</span><span class="hs-identifier hs-var">fromInteger</span></span><span> </span><span class="annot"><span class="annottext">(Integer -&gt; Int) -&gt; Integer -&gt; Int
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Proxy (IxOf sch sty) -&gt; Integer
forall (n :: Nat) (proxy :: Nat -&gt; *).
KnownNat n =&gt;
proxy n -&gt; Integer
</span><span class="hs-identifier hs-var">natVal</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Proxy (IxOf sch sty)
forall k (t :: k). Proxy t
</span><span class="hs-identifier hs-var">Proxy</span></span><span> </span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="Mu.Adapter.Avro.html#IxOf"><span class="hs-identifier hs-type">IxOf</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679159066"><span class="hs-identifier hs-type">sch</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679159065"><span class="hs-identifier hs-type">sty</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-106"></span><span>                      </span><span class="annot"><span class="annottext">Vector Schema
</span><a href="#local-6989586621679159059"><span class="hs-identifier hs-var">vs</span></a></span><span>
</span><span id="line-107"></span><span>                      </span><span class="hs-special">(</span><span class="annot"><span class="annottext">t -&gt; Term sch (sch :/: sty)
forall fn tn (sch :: Schema tn fn) t (sty :: tn).
ToSchema sch sty t =&gt;
t -&gt; Term sch (sch :/: sty)
</span><span class="hs-identifier hs-var">toSchema'</span></span><span> </span><span class="hs-glyph">@</span><span class="annot"><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">@</span><span class="annot"><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621679159066"><span class="hs-identifier hs-type">sch</span></a></span><span> </span><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679159058"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-108"></span><span>  </span><span class="annot"><span class="hs-identifier hs-var">toAvro</span></span><span> </span><span id="local-6989586621679159055"><span class="annot"><span class="annottext">s :: Schema
</span><a href="#local-6989586621679159055"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; Builder
forall a. HasCallStack =&gt; [Char] -&gt; a
</span><span class="hs-identifier hs-var">error</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-string">&quot;this should never happen:\n&quot;</span></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; [Char] -&gt; [Char]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Schema -&gt; [Char]
forall a. Show a =&gt; a -&gt; [Char]
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Schema
</span><a href="#local-6989586621679159055"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">)</span></span></span></span><span>
</span><span id="line-109"></span><span>
</span><span id="line-110"></span><span class="hs-keyword">class</span><span> </span><span id="HasAvroSchemas"><span class="annot"><a href="Mu.Adapter.Avro.html#HasAvroSchemas"><span class="hs-identifier hs-var">HasAvroSchemas</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679159581"><span class="annot"><a href="#local-6989586621679159581"><span class="hs-identifier hs-type">r</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Schema</span></span><span> </span><span id="local-6989586621679159583"><span class="annot"><a href="#local-6989586621679159583"><span class="hs-identifier hs-type hs-type">tn</span></a></span></span><span> </span><span id="local-6989586621679159582"><span class="annot"><a href="#local-6989586621679159582"><span class="hs-identifier hs-type hs-type">fn</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679159580"><span class="annot"><a href="#local-6989586621679159580"><span class="hs-identifier hs-type">sch</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Schema</span></span><span> </span><span class="annot"><a href="#local-6989586621679159583"><span class="hs-identifier hs-type">tn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679159582"><span class="hs-identifier hs-type">fn</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-111"></span><span>  </span><span id="schemas"><span class="annot"><a href="Mu.Adapter.Avro.html#schemas"><span class="hs-identifier hs-type">schemas</span></a></span></span><span>   </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Proxy</span></span><span> </span><span class="annot"><a href="#local-6989586621679159581"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Proxy</span></span><span> </span><span class="annot"><a href="#local-6989586621679159580"><span class="hs-identifier hs-type">sch</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">ASch.TypeName</span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">V.Vector</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">ASch.Schema</span></span><span>
</span><span id="line-112"></span><span>  </span><span id="typeNames"><span class="annot"><a href="Mu.Adapter.Avro.html#typeNames"><span class="hs-identifier hs-type">typeNames</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Proxy</span></span><span> </span><span class="annot"><a href="#local-6989586621679159581"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Proxy</span></span><span> </span><span class="annot"><a href="#local-6989586621679159580"><span class="hs-identifier hs-type">sch</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">ASch.TypeName</span></span><span class="hs-special">]</span><span>
</span><span id="line-113"></span><span id="local-6989586621679159054"><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Mu.Adapter.Avro.html#HasAvroSchemas"><span class="hs-identifier hs-type">HasAvroSchemas</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679159054"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-special">'</span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-114"></span><span>  </span><span id="local-6989586621679159050"><span class="annot"><span class="annottext">schemas :: Proxy r -&gt; Proxy '[] -&gt; [TypeName] -&gt; Vector Schema
</span><a href="#local-6989586621679159050"><span class="hs-identifier hs-var hs-var hs-var hs-var">schemas</span></a></span></span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Vector Schema
forall a. Vector a
</span><span class="hs-identifier hs-var">V.empty</span></span><span>
</span><span id="line-115"></span><span>  </span><span id="local-6989586621679159048"><span class="annot"><span class="annottext">typeNames :: Proxy r -&gt; Proxy '[] -&gt; [TypeName]
</span><a href="#local-6989586621679159048"><span class="hs-identifier hs-var hs-var hs-var hs-var">typeNames</span></a></span></span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span></span><span>
</span><span id="line-116"></span><span class="hs-keyword">instance</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679159045"><span class="annot"><a href="#local-6989586621679159045"><span class="hs-identifier hs-type">r</span></a></span></span><span> </span><span id="local-6989586621679159044"><span class="annot"><a href="#local-6989586621679159044"><span class="hs-identifier hs-type">d</span></a></span></span><span> </span><span id="local-6989586621679159043"><span class="annot"><a href="#local-6989586621679159043"><span class="hs-identifier hs-type">ds</span></a></span></span><span class="hs-operator">.</span><span>
</span><span id="line-117"></span><span>         </span><span class="hs-special">(</span><span class="annot"><a href="Mu.Adapter.Avro.html#HasAvroSchema%27"><span class="hs-identifier hs-type">HasAvroSchema'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Term</span></span><span> </span><span class="annot"><a href="#local-6989586621679159045"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679159044"><span class="hs-identifier hs-type">d</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Mu.Adapter.Avro.html#HasAvroSchemas"><span class="hs-identifier hs-type">HasAvroSchemas</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679159045"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679159043"><span class="hs-identifier hs-type">ds</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-118"></span><span>         </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Mu.Adapter.Avro.html#HasAvroSchemas"><span class="hs-identifier hs-type">HasAvroSchemas</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679159045"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679159044"><span class="hs-identifier hs-type">d</span></a></span><span> </span><span class="hs-special">'</span><span class="hs-glyph">:</span><span> </span><span class="annot"><a href="#local-6989586621679159043"><span class="hs-identifier hs-type">ds</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-119"></span><span>  </span><span id="local-6989586621679159042"><span class="annot"><span class="annottext">schemas :: Proxy r -&gt; Proxy (d : ds) -&gt; [TypeName] -&gt; Vector Schema
</span><a href="#local-6989586621679159042"><span class="hs-identifier hs-var hs-var hs-var hs-var">schemas</span></a></span></span><span> </span><span id="local-6989586621679159041"><span class="annot"><span class="annottext">pr :: Proxy r
</span><a href="#local-6989586621679159041"><span class="hs-identifier hs-var">pr</span></a></span></span><span> </span><span class="hs-identifier">_</span><span> </span><span id="local-6989586621679159040"><span class="annot"><span class="annottext">tys :: [TypeName]
</span><a href="#local-6989586621679159040"><span class="hs-identifier hs-var">tys</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Schema -&gt; Vector Schema -&gt; Vector Schema
forall a. a -&gt; Vector a -&gt; Vector a
</span><span class="hs-identifier hs-var">V.cons</span></span><span> </span><span class="annot"><span class="annottext">Schema
</span><a href="#local-6989586621679159038"><span class="hs-identifier hs-var">thisSchema</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Proxy r -&gt; Proxy ds -&gt; [TypeName] -&gt; Vector Schema
forall tn fn (r :: Schema tn fn) (sch :: Schema tn fn).
HasAvroSchemas r sch =&gt;
Proxy r -&gt; Proxy sch -&gt; [TypeName] -&gt; Vector Schema
</span><a href="Mu.Adapter.Avro.html#schemas"><span class="hs-identifier hs-var">schemas</span></a></span><span> </span><span class="annot"><span class="annottext">Proxy r
</span><a href="#local-6989586621679159041"><span class="hs-identifier hs-var">pr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Proxy ds
forall k (t :: k). Proxy t
</span><span class="hs-identifier hs-var">Proxy</span></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621679159043"><span class="hs-identifier hs-type">ds</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[TypeName]
</span><a href="#local-6989586621679159040"><span class="hs-identifier hs-var">tys</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-120"></span><span>    </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621679159038"><span class="annot"><span class="annottext">thisSchema :: Schema
</span><a href="#local-6989586621679159038"><span class="hs-identifier hs-var hs-var">thisSchema</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Tagged (Term r d) Schema -&gt; Schema
forall k (s :: k) b. Tagged s b -&gt; b
</span><span class="hs-identifier hs-var hs-var">unTagged</span></span><span> </span><span class="annot"><span class="annottext">(Tagged (Term r d) Schema -&gt; Schema)
-&gt; Tagged (Term r d) Schema -&gt; Schema
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[TypeName] -&gt; Tagged (Term r d) Schema
forall k (x :: k).
HasAvroSchema' x =&gt;
[TypeName] -&gt; Tagged x Schema
</span><a href="Mu.Adapter.Avro.html#schema%27"><span class="hs-identifier hs-var">schema'</span></a></span><span> </span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Term</span></span><span> </span><span class="annot"><a href="#local-6989586621679159045"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679159044"><span class="hs-identifier hs-type">d</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[TypeName]
</span><a href="#local-6989586621679159040"><span class="hs-identifier hs-var">tys</span></a></span><span> </span><span class="annot"><span class="annottext">[TypeName] -&gt; [TypeName] -&gt; [TypeName]
forall a. Eq a =&gt; [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">\\</span></span><span> </span><span class="annot"><span class="annottext">Proxy (Term r d) -&gt; [TypeName]
forall k (x :: k). HasAvroSchema' x =&gt; Proxy x -&gt; [TypeName]
</span><a href="Mu.Adapter.Avro.html#typeName%27"><span class="hs-identifier hs-var">typeName'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Proxy (Term r d)
forall k (t :: k). Proxy t
</span><span class="hs-identifier hs-var">Proxy</span></span><span> </span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Term</span></span><span> </span><span class="annot"><a href="#local-6989586621679159045"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679159044"><span class="hs-identifier hs-type">d</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-121"></span><span>  </span><span id="local-6989586621679159034"><span class="annot"><span class="annottext">typeNames :: Proxy r -&gt; Proxy (d : ds) -&gt; [TypeName]
</span><a href="#local-6989586621679159034"><span class="hs-identifier hs-var hs-var hs-var hs-var">typeNames</span></a></span></span><span> </span><span id="local-6989586621679159033"><span class="annot"><span class="annottext">pr :: Proxy r
</span><a href="#local-6989586621679159033"><span class="hs-identifier hs-var">pr</span></a></span></span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Proxy (Term r d) -&gt; [TypeName]
forall k (x :: k). HasAvroSchema' x =&gt; Proxy x -&gt; [TypeName]
</span><a href="Mu.Adapter.Avro.html#typeName%27"><span class="hs-identifier hs-var">typeName'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Proxy (Term r d)
forall k (t :: k). Proxy t
</span><span class="hs-identifier hs-var">Proxy</span></span><span> </span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Term</span></span><span> </span><span class="annot"><a href="#local-6989586621679159045"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679159044"><span class="hs-identifier hs-type">d</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[TypeName] -&gt; [TypeName] -&gt; [TypeName]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Proxy r -&gt; Proxy ds -&gt; [TypeName]
forall tn fn (r :: Schema tn fn) (sch :: Schema tn fn).
HasAvroSchemas r sch =&gt;
Proxy r -&gt; Proxy sch -&gt; [TypeName]
</span><a href="Mu.Adapter.Avro.html#typeNames"><span class="hs-identifier hs-var">typeNames</span></a></span><span> </span><span class="annot"><span class="annottext">Proxy r
</span><a href="#local-6989586621679159033"><span class="hs-identifier hs-var">pr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Proxy ds
forall k (t :: k). Proxy t
</span><span class="hs-identifier hs-var">Proxy</span></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621679159043"><span class="hs-identifier hs-type">ds</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-122"></span><span>
</span><span id="line-123"></span><span class="hs-keyword">type</span><span> </span><span class="hs-keyword">family</span><span> </span><span id="IxOf"><span class="annot"><a href="Mu.Adapter.Avro.html#IxOf"><span class="hs-identifier hs-var">IxOf</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679159032"><span class="annot"><a href="#local-6989586621679159032"><span class="hs-identifier hs-type">sch</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Schema</span></span><span> </span><span id="local-6989586621679159031"><span class="annot"><a href="#local-6989586621679159031"><span class="hs-identifier hs-type hs-type">tn</span></a></span></span><span> </span><span id="local-6989586621679159030"><span class="annot"><a href="#local-6989586621679159030"><span class="hs-identifier hs-type hs-type">fn</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679159029"><span class="annot"><a href="#local-6989586621679159029"><span class="hs-identifier hs-type">sty</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679159031"><span class="hs-identifier hs-type">tn</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Nat</span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-124"></span><span>  </span><span id="IxOf"><span class="annot"><a href="Mu.Adapter.Avro.html#IxOf"><span class="hs-identifier hs-var">IxOf</span></a></span></span><span> </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><span class="hs-identifier hs-type">DRecord</span></span><span> </span><span id="local-6989586621679159028"><span class="annot"><a href="#local-6989586621679159028"><span class="hs-identifier hs-type hs-type">nm</span></a></span></span><span> </span><span id="local-6989586621679159027"><span class="annot"><a href="#local-6989586621679159027"><span class="hs-identifier hs-type hs-type">fs</span></a></span></span><span> </span><span class="hs-special">'</span><span class="hs-glyph">:</span><span> </span><span id="local-6989586621679159026"><span class="annot"><a href="#local-6989586621679159026"><span class="hs-identifier hs-type hs-type">rest</span></a></span></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679159028"><span class="hs-identifier hs-type">nm</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-number">0</span></span><span>
</span><span id="line-125"></span><span>  </span><span id="IxOf"><span class="annot"><a href="Mu.Adapter.Avro.html#IxOf"><span class="hs-identifier hs-var">IxOf</span></a></span></span><span> </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><span class="hs-identifier hs-type">DEnum</span></span><span>   </span><span id="local-6989586621679159025"><span class="annot"><a href="#local-6989586621679159025"><span class="hs-identifier hs-type hs-type">nm</span></a></span></span><span> </span><span id="local-6989586621679159024"><span class="annot"><a href="#local-6989586621679159024"><span class="hs-identifier hs-type hs-type">cs</span></a></span></span><span> </span><span class="hs-special">'</span><span class="hs-glyph">:</span><span> </span><span id="local-6989586621679159023"><span class="annot"><a href="#local-6989586621679159023"><span class="hs-identifier hs-type hs-type">rest</span></a></span></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679159025"><span class="hs-identifier hs-type">nm</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-number">0</span></span><span>
</span><span id="line-126"></span><span>  </span><span id="IxOf"><span class="annot"><a href="Mu.Adapter.Avro.html#IxOf"><span class="hs-identifier hs-var">IxOf</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679159022"><span class="annot"><a href="#local-6989586621679159022"><span class="hs-identifier hs-type hs-type">other</span></a></span></span><span>          </span><span class="hs-special">'</span><span class="hs-glyph">:</span><span> </span><span id="local-6989586621679159021"><span class="annot"><a href="#local-6989586621679159021"><span class="hs-identifier hs-type hs-type">rest</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679159020"><span class="annot"><a href="#local-6989586621679159020"><span class="hs-identifier hs-type hs-type">nm</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">+</span></span><span> </span><span class="annot"><a href="Mu.Adapter.Avro.html#IxOf"><span class="hs-identifier hs-type">IxOf</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679159021"><span class="hs-identifier hs-type">rest</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679159020"><span class="hs-identifier hs-type">nm</span></a></span><span>
</span><span id="line-127"></span><span>
</span><span id="line-128"></span><span class="hs-comment">-- HasAvroSchema instances</span><span>
</span><span id="line-129"></span><span>
</span><span id="line-130"></span><span class="hs-keyword">class</span><span> </span><span id="HasAvroSchema%27"><span class="annot"><a href="Mu.Adapter.Avro.html#HasAvroSchema%27"><span class="hs-identifier hs-var">HasAvroSchema'</span></a></span></span><span> </span><span id="local-6989586621679159512"><span class="annot"><a href="#local-6989586621679159512"><span class="hs-identifier hs-type">x</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-131"></span><span>  </span><span id="typeName%27"><span class="annot"><a href="Mu.Adapter.Avro.html#typeName%27"><span class="hs-identifier hs-type">typeName'</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Proxy</span></span><span> </span><span class="annot"><a href="#local-6989586621679159512"><span class="hs-identifier hs-type">x</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">ASch.TypeName</span></span><span class="hs-special">]</span><span>
</span><span id="line-132"></span><span>  </span><span id="schema%27"><span class="annot"><a href="Mu.Adapter.Avro.html#schema%27"><span class="hs-identifier hs-type">schema'</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">ASch.TypeName</span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Tagged</span></span><span> </span><span class="annot"><a href="#local-6989586621679159512"><span class="hs-identifier hs-type">x</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">ASch.Schema</span></span><span>
</span><span id="line-133"></span><span>
</span><span id="line-134"></span><span id="local-6989586621679159018"><span id="local-6989586621679159019"><span class="hs-keyword">instance</span><span> </span><span class="annot"><span class="hs-identifier hs-type">TypeError</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span> </span><span class="annot"><span class="hs-string">&quot;you should never use HasAvroSchema directly on Term, use WithSchema&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-135"></span><span>         </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">A.HasAvroSchema</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Term</span></span><span> </span><span class="annot"><a href="#local-6989586621679159019"><span class="hs-identifier hs-type">sch</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679159018"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-136"></span><span>  </span><span id="local-6989586621679159016"><span class="annot"><span class="annottext">schema :: Tagged (Term sch t) Schema
</span><a href="#local-6989586621679159016"><span class="hs-identifier hs-var hs-var hs-var hs-var">schema</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; Tagged (Term sch t) Schema
forall a. HasCallStack =&gt; [Char] -&gt; a
</span><span class="hs-identifier hs-var">error</span></span><span> </span><span class="annot"><span class="hs-string">&quot;this should never happen&quot;</span></span></span></span><span>
</span><span id="line-137"></span><span id="local-6989586621679159014"><span id="local-6989586621679159015"><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Mu.Adapter.Avro.html#HasAvroSchema%27"><span class="hs-identifier hs-type">HasAvroSchema'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">FieldValue</span></span><span> </span><span class="annot"><a href="#local-6989586621679159015"><span class="hs-identifier hs-type">sch</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679159014"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-138"></span><span>         </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">A.HasAvroSchema</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">FieldValue</span></span><span> </span><span class="annot"><a href="#local-6989586621679159015"><span class="hs-identifier hs-type">sch</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679159014"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-139"></span><span>  </span><span id="local-6989586621679159012"><span class="annot"><span class="annottext">schema :: Tagged (FieldValue sch t) Schema
</span><a href="#local-6989586621679159012"><span class="hs-identifier hs-var hs-var hs-var hs-var">schema</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[TypeName] -&gt; Tagged (FieldValue sch t) Schema
forall k (x :: k).
HasAvroSchema' x =&gt;
[TypeName] -&gt; Tagged x Schema
</span><a href="Mu.Adapter.Avro.html#schema%27"><span class="hs-identifier hs-var">schema'</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span></span></span><span>
</span><span id="line-140"></span><span>
</span><span id="line-141"></span><span id="local-6989586621679159009"><span id="local-6989586621679159010"><span id="local-6989586621679159011"><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">KnownName</span></span><span> </span><span class="annot"><a href="#local-6989586621679159011"><span class="hs-identifier hs-type">name</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Mu.Adapter.Avro.html#HasAvroSchemaFields"><span class="hs-identifier hs-type">HasAvroSchemaFields</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679159010"><span class="hs-identifier hs-type">sch</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679159009"><span class="hs-identifier hs-type">args</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-142"></span><span>         </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Mu.Adapter.Avro.html#HasAvroSchema%27"><span class="hs-identifier hs-type">HasAvroSchema'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Term</span></span><span> </span><span class="annot"><a href="#local-6989586621679159010"><span class="hs-identifier hs-type">sch</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><span class="hs-identifier hs-type">DRecord</span></span><span> </span><span class="annot"><a href="#local-6989586621679159011"><span class="hs-identifier hs-type">name</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679159009"><span class="hs-identifier hs-type">args</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-143"></span><span>  </span><span id="local-6989586621679159005"><span class="annot"><span class="annottext">typeName' :: Proxy (Term sch ('DRecord name args)) -&gt; [TypeName]
</span><a href="#local-6989586621679159005"><span class="hs-identifier hs-var hs-var hs-var hs-var">typeName'</span></a></span></span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Proxy name -&gt; TypeName
forall k (s :: k) (proxy :: k -&gt; *).
KnownName s =&gt;
proxy s -&gt; TypeName
</span><a href="Mu.Adapter.Avro.html#nameTypeName"><span class="hs-identifier hs-var">nameTypeName</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Proxy name
forall k (t :: k). Proxy t
</span><span class="hs-identifier hs-var">Proxy</span></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621679159011"><span class="hs-identifier hs-type">name</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-144"></span><span>  </span><span id="local-6989586621679159003"><span class="annot"><span class="annottext">schema' :: [TypeName] -&gt; Tagged (Term sch ('DRecord name args)) Schema
</span><a href="#local-6989586621679159003"><span class="hs-identifier hs-var hs-var hs-var hs-var">schema'</span></a></span></span><span> </span><span id="local-6989586621679159002"><span class="annot"><span class="annottext">visited :: [TypeName]
</span><a href="#local-6989586621679159002"><span class="hs-identifier hs-var">visited</span></a></span></span><span>
</span><span id="line-145"></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">TypeName
</span><a href="#local-6989586621679159001"><span class="hs-identifier hs-var">recordName</span></a></span><span> </span><span class="annot"><span class="annottext">TypeName -&gt; [TypeName] -&gt; Bool
forall (t :: * -&gt; *) a. (Foldable t, Eq a) =&gt; a -&gt; t a -&gt; Bool
</span><span class="hs-operator hs-var">`elem`</span></span><span> </span><span class="annot"><span class="annottext">[TypeName]
</span><a href="#local-6989586621679159002"><span class="hs-identifier hs-var">visited</span></a></span><span>
</span><span id="line-146"></span><span>         </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">Schema -&gt; Tagged (Term sch ('DRecord name args)) Schema
forall k (s :: k) b. b -&gt; Tagged s b
</span><span class="hs-identifier hs-var">Tagged</span></span><span> </span><span class="annot"><span class="annottext">(Schema -&gt; Tagged (Term sch ('DRecord name args)) Schema)
-&gt; Schema -&gt; Tagged (Term sch ('DRecord name args)) Schema
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">TypeName -&gt; Schema
</span><span class="hs-identifier hs-var">ASch.NamedType</span></span><span> </span><span class="annot"><span class="annottext">TypeName
</span><a href="#local-6989586621679159001"><span class="hs-identifier hs-var">recordName</span></a></span><span>
</span><span id="line-147"></span><span>         </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">Schema -&gt; Tagged (Term sch ('DRecord name args)) Schema
forall k (s :: k) b. b -&gt; Tagged s b
</span><span class="hs-identifier hs-var">Tagged</span></span><span> </span><span class="annot"><span class="annottext">(Schema -&gt; Tagged (Term sch ('DRecord name args)) Schema)
-&gt; Schema -&gt; Tagged (Term sch ('DRecord name args)) Schema
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">TypeName -&gt; [TypeName] -&gt; Maybe Text -&gt; [Field] -&gt; Schema
</span><span class="hs-identifier hs-var">ASch.Record</span></span><span> </span><span class="annot"><span class="annottext">TypeName
</span><a href="#local-6989586621679159001"><span class="hs-identifier hs-var">recordName</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">Maybe Text
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="annot"><span class="annottext">[Field]
</span><a href="#local-6989586621679158997"><span class="hs-identifier hs-var">fields</span></a></span><span>
</span><span id="line-148"></span><span>    </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621679159001"><span class="annot"><span class="annottext">recordName :: TypeName
</span><a href="#local-6989586621679159001"><span class="hs-identifier hs-var hs-var">recordName</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Proxy name -&gt; TypeName
forall k (s :: k) (proxy :: k -&gt; *).
KnownName s =&gt;
proxy s -&gt; TypeName
</span><a href="Mu.Adapter.Avro.html#nameTypeName"><span class="hs-identifier hs-var">nameTypeName</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Proxy name
forall k (t :: k). Proxy t
</span><span class="hs-identifier hs-var">Proxy</span></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621679159011"><span class="hs-identifier hs-type">name</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-149"></span><span>          </span><span id="local-6989586621679158997"><span class="annot"><span class="annottext">fields :: [Field]
</span><a href="#local-6989586621679158997"><span class="hs-identifier hs-var hs-var">fields</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Proxy sch -&gt; Proxy args -&gt; [TypeName] -&gt; [Field]
forall k tn fn (sch :: k) (fs :: [FieldDef tn fn]).
HasAvroSchemaFields sch fs =&gt;
Proxy sch -&gt; Proxy fs -&gt; [TypeName] -&gt; [Field]
</span><a href="Mu.Adapter.Avro.html#schemaF"><span class="hs-identifier hs-var">schemaF</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Proxy sch
forall k (t :: k). Proxy t
</span><span class="hs-identifier hs-var">Proxy</span></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621679159010"><span class="hs-identifier hs-type">sch</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Proxy args
forall k (t :: k). Proxy t
</span><span class="hs-identifier hs-var">Proxy</span></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621679159009"><span class="hs-identifier hs-type">args</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[TypeName]
</span><a href="#local-6989586621679159002"><span class="hs-identifier hs-var">visited</span></a></span></span></span></span><span>
</span><span id="line-150"></span><span id="local-6989586621679158993"><span id="local-6989586621679158994"><span id="local-6989586621679158995"><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">KnownName</span></span><span> </span><span class="annot"><a href="#local-6989586621679158995"><span class="hs-identifier hs-type">name</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Mu.Adapter.Avro.html#HasAvroSchemaEnum"><span class="hs-identifier hs-type">HasAvroSchemaEnum</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679158994"><span class="hs-identifier hs-type">choices</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-151"></span><span>          </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Mu.Adapter.Avro.html#HasAvroSchema%27"><span class="hs-identifier hs-type">HasAvroSchema'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Term</span></span><span> </span><span class="annot"><a href="#local-6989586621679158993"><span class="hs-identifier hs-type">sch</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><span class="hs-identifier hs-type">DEnum</span></span><span> </span><span class="annot"><a href="#local-6989586621679158995"><span class="hs-identifier hs-type">name</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679158994"><span class="hs-identifier hs-type">choices</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-152"></span><span>  </span><span id="local-6989586621679158990"><span class="annot"><span class="annottext">typeName' :: Proxy (Term sch ('DEnum name choices)) -&gt; [TypeName]
</span><a href="#local-6989586621679158990"><span class="hs-identifier hs-var hs-var hs-var hs-var">typeName'</span></a></span></span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Proxy name -&gt; TypeName
forall k (s :: k) (proxy :: k -&gt; *).
KnownName s =&gt;
proxy s -&gt; TypeName
</span><a href="Mu.Adapter.Avro.html#nameTypeName"><span class="hs-identifier hs-var">nameTypeName</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Proxy name
forall k (t :: k). Proxy t
</span><span class="hs-identifier hs-var">Proxy</span></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621679158995"><span class="hs-identifier hs-type">name</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-153"></span><span>  </span><span id="local-6989586621679158989"><span class="annot"><span class="annottext">schema' :: [TypeName] -&gt; Tagged (Term sch ('DEnum name choices)) Schema
</span><a href="#local-6989586621679158989"><span class="hs-identifier hs-var hs-var hs-var hs-var">schema'</span></a></span></span><span> </span><span id="local-6989586621679158988"><span class="annot"><span class="annottext">visited :: [TypeName]
</span><a href="#local-6989586621679158988"><span class="hs-identifier hs-var">visited</span></a></span></span><span>
</span><span id="line-154"></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">TypeName
</span><a href="#local-6989586621679158987"><span class="hs-identifier hs-var">enumName</span></a></span><span> </span><span class="annot"><span class="annottext">TypeName -&gt; [TypeName] -&gt; Bool
forall (t :: * -&gt; *) a. (Foldable t, Eq a) =&gt; a -&gt; t a -&gt; Bool
</span><span class="hs-operator hs-var">`elem`</span></span><span> </span><span class="annot"><span class="annottext">[TypeName]
</span><a href="#local-6989586621679158988"><span class="hs-identifier hs-var">visited</span></a></span><span>
</span><span id="line-155"></span><span>         </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">Schema -&gt; Tagged (Term sch ('DEnum name choices)) Schema
forall k (s :: k) b. b -&gt; Tagged s b
</span><span class="hs-identifier hs-var">Tagged</span></span><span> </span><span class="annot"><span class="annottext">(Schema -&gt; Tagged (Term sch ('DEnum name choices)) Schema)
-&gt; Schema -&gt; Tagged (Term sch ('DEnum name choices)) Schema
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">TypeName -&gt; Schema
</span><span class="hs-identifier hs-var">ASch.NamedType</span></span><span> </span><span class="annot"><span class="annottext">TypeName
</span><a href="#local-6989586621679158987"><span class="hs-identifier hs-var">enumName</span></a></span><span>
</span><span id="line-156"></span><span>         </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">Schema -&gt; Tagged (Term sch ('DEnum name choices)) Schema
forall k (s :: k) b. b -&gt; Tagged s b
</span><span class="hs-identifier hs-var">Tagged</span></span><span> </span><span class="annot"><span class="annottext">(Schema -&gt; Tagged (Term sch ('DEnum name choices)) Schema)
-&gt; Schema -&gt; Tagged (Term sch ('DEnum name choices)) Schema
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">TypeName -&gt; [TypeName] -&gt; Maybe Text -&gt; [Text] -&gt; Schema
</span><span class="hs-identifier hs-var">ASch.mkEnum</span></span><span> </span><span class="annot"><span class="annottext">TypeName
</span><a href="#local-6989586621679158987"><span class="hs-identifier hs-var">enumName</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">Maybe Text
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="annot"><span class="annottext">[Text]
</span><a href="#local-6989586621679158985"><span class="hs-identifier hs-var">choicesNames</span></a></span><span>
</span><span id="line-157"></span><span>    </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621679158987"><span class="annot"><span class="annottext">enumName :: TypeName
</span><a href="#local-6989586621679158987"><span class="hs-identifier hs-var hs-var">enumName</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Proxy name -&gt; TypeName
forall k (s :: k) (proxy :: k -&gt; *).
KnownName s =&gt;
proxy s -&gt; TypeName
</span><a href="Mu.Adapter.Avro.html#nameTypeName"><span class="hs-identifier hs-var">nameTypeName</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Proxy name
forall k (t :: k). Proxy t
</span><span class="hs-identifier hs-var">Proxy</span></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621679158995"><span class="hs-identifier hs-type">name</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-158"></span><span>          </span><span id="local-6989586621679158985"><span class="annot"><span class="annottext">choicesNames :: [Text]
</span><a href="#local-6989586621679158985"><span class="hs-identifier hs-var hs-var">choicesNames</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Proxy choices -&gt; [Text]
forall fn (fs :: [ChoiceDef fn]).
HasAvroSchemaEnum fs =&gt;
Proxy fs -&gt; [Text]
</span><a href="Mu.Adapter.Avro.html#schemaE"><span class="hs-identifier hs-var">schemaE</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Proxy choices
forall k (t :: k). Proxy t
</span><span class="hs-identifier hs-var">Proxy</span></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621679158994"><span class="hs-identifier hs-type">choices</span></a></span><span class="hs-special">)</span></span></span></span><span>
</span><span id="line-159"></span><span id="local-6989586621679158982"><span id="local-6989586621679158983"><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Mu.Adapter.Avro.html#HasAvroSchema%27"><span class="hs-identifier hs-type">HasAvroSchema'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">FieldValue</span></span><span> </span><span class="annot"><a href="#local-6989586621679158983"><span class="hs-identifier hs-type">sch</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679158982"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-160"></span><span>         </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Mu.Adapter.Avro.html#HasAvroSchema%27"><span class="hs-identifier hs-type">HasAvroSchema'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Term</span></span><span> </span><span class="annot"><a href="#local-6989586621679158983"><span class="hs-identifier hs-type">sch</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><span class="hs-identifier hs-type">DSimple</span></span><span> </span><span class="annot"><a href="#local-6989586621679158982"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-161"></span><span>  </span><span id="local-6989586621679158979"><span class="annot"><span class="annottext">typeName' :: Proxy (Term sch ('DSimple t)) -&gt; [TypeName]
</span><a href="#local-6989586621679158979"><span class="hs-identifier hs-var hs-var hs-var hs-var">typeName'</span></a></span></span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-162"></span><span>  </span><span id="local-6989586621679158978"><span class="annot"><span class="annottext">schema' :: [TypeName] -&gt; Tagged (Term sch ('DSimple t)) Schema
</span><a href="#local-6989586621679158978"><span class="hs-identifier hs-var hs-var hs-var hs-var">schema'</span></a></span></span><span> </span><span id="local-6989586621679158977"><span class="annot"><span class="annottext">visited :: [TypeName]
</span><a href="#local-6989586621679158977"><span class="hs-identifier hs-var">visited</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Tagged (FieldValue sch t) Schema
-&gt; Tagged (Term sch ('DSimple t)) Schema
forall a b. Coercible a b =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">coerce</span></span><span> </span><span class="annot"><span class="annottext">(Tagged (FieldValue sch t) Schema
 -&gt; Tagged (Term sch ('DSimple t)) Schema)
-&gt; Tagged (FieldValue sch t) Schema
-&gt; Tagged (Term sch ('DSimple t)) Schema
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[TypeName] -&gt; Tagged (FieldValue sch t) Schema
forall k (x :: k).
HasAvroSchema' x =&gt;
[TypeName] -&gt; Tagged x Schema
</span><a href="Mu.Adapter.Avro.html#schema%27"><span class="hs-identifier hs-var">schema'</span></a></span><span> </span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">FieldValue</span></span><span> </span><span class="annot"><a href="#local-6989586621679158983"><span class="hs-identifier hs-type">sch</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679158982"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[TypeName]
</span><a href="#local-6989586621679158977"><span class="hs-identifier hs-var">visited</span></a></span></span></span><span>
</span><span id="line-163"></span><span>
</span><span id="line-164"></span><span id="local-6989586621679158976"><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Mu.Adapter.Avro.html#HasAvroSchema%27"><span class="hs-identifier hs-type">HasAvroSchema'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">FieldValue</span></span><span> </span><span class="annot"><a href="#local-6989586621679158976"><span class="hs-identifier hs-type">sch</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><span class="hs-identifier hs-type">TNull</span></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-165"></span><span>  </span><span id="local-6989586621679158973"><span class="annot"><span class="annottext">typeName' :: Proxy (FieldValue sch 'TNull) -&gt; [TypeName]
</span><a href="#local-6989586621679158973"><span class="hs-identifier hs-var hs-var hs-var hs-var">typeName'</span></a></span></span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-166"></span><span>  </span><span id="local-6989586621679158972"><span class="annot"><span class="annottext">schema' :: [TypeName] -&gt; Tagged (FieldValue sch 'TNull) Schema
</span><a href="#local-6989586621679158972"><span class="hs-identifier hs-var hs-var hs-var hs-var">schema'</span></a></span></span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Schema -&gt; Tagged (FieldValue sch 'TNull) Schema
forall k (s :: k) b. b -&gt; Tagged s b
</span><span class="hs-identifier hs-var">Tagged</span></span><span> </span><span class="annot"><span class="annottext">Schema
</span><span class="hs-identifier hs-var">ASch.Null</span></span></span><span>
</span><span id="line-167"></span><span id="local-6989586621679158969"><span id="local-6989586621679158970"><span class="hs-keyword">instance</span><span> </span><span class="annot"><span class="hs-identifier hs-type">A.HasAvroSchema</span></span><span> </span><span class="annot"><a href="#local-6989586621679158970"><span class="hs-identifier hs-type">t</span></a></span><span>
</span><span id="line-168"></span><span>         </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Mu.Adapter.Avro.html#HasAvroSchema%27"><span class="hs-identifier hs-type">HasAvroSchema'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">FieldValue</span></span><span> </span><span class="annot"><a href="#local-6989586621679158969"><span class="hs-identifier hs-type">sch</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><span class="hs-identifier hs-type">TPrimitive</span></span><span> </span><span class="annot"><a href="#local-6989586621679158970"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-169"></span><span>  </span><span id="local-6989586621679158966"><span class="annot"><span class="annottext">typeName' :: Proxy (FieldValue sch ('TPrimitive t)) -&gt; [TypeName]
</span><a href="#local-6989586621679158966"><span class="hs-identifier hs-var hs-var hs-var hs-var">typeName'</span></a></span></span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-170"></span><span>  </span><span id="local-6989586621679158965"><span class="annot"><span class="annottext">schema' :: [TypeName] -&gt; Tagged (FieldValue sch ('TPrimitive t)) Schema
</span><a href="#local-6989586621679158965"><span class="hs-identifier hs-var hs-var hs-var hs-var">schema'</span></a></span></span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Tagged t Schema -&gt; Tagged (FieldValue sch ('TPrimitive t)) Schema
forall a b. Coercible a b =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">coerce</span></span><span> </span><span class="annot"><span class="annottext">(Tagged t Schema -&gt; Tagged (FieldValue sch ('TPrimitive t)) Schema)
-&gt; Tagged t Schema
-&gt; Tagged (FieldValue sch ('TPrimitive t)) Schema
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">HasAvroSchema t =&gt; Tagged t Schema
forall a. HasAvroSchema a =&gt; Tagged a Schema
</span><span class="hs-identifier hs-var">A.schema</span></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621679158970"><span class="hs-identifier hs-type">t</span></a></span></span></span><span>
</span><span id="line-171"></span><span id="local-6989586621679158963"><span id="local-6989586621679158964"><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Mu.Adapter.Avro.html#HasAvroSchema%27"><span class="hs-identifier hs-type">HasAvroSchema'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Term</span></span><span> </span><span class="annot"><a href="#local-6989586621679158964"><span class="hs-identifier hs-type">sch</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679158964"><span class="hs-identifier hs-type">sch</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">:/:</span></span><span> </span><span class="annot"><a href="#local-6989586621679158963"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-172"></span><span>         </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Mu.Adapter.Avro.html#HasAvroSchema%27"><span class="hs-identifier hs-type">HasAvroSchema'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">FieldValue</span></span><span> </span><span class="annot"><a href="#local-6989586621679158964"><span class="hs-identifier hs-type">sch</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><span class="hs-identifier hs-type">TSchematic</span></span><span> </span><span class="annot"><a href="#local-6989586621679158963"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-173"></span><span>  </span><span id="local-6989586621679158960"><span class="annot"><span class="annottext">typeName' :: Proxy (FieldValue sch ('TSchematic t)) -&gt; [TypeName]
</span><a href="#local-6989586621679158960"><span class="hs-identifier hs-var hs-var hs-var hs-var">typeName'</span></a></span></span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-174"></span><span>  </span><span id="local-6989586621679158959"><span class="annot"><span class="annottext">schema' :: [TypeName] -&gt; Tagged (FieldValue sch ('TSchematic t)) Schema
</span><a href="#local-6989586621679158959"><span class="hs-identifier hs-var hs-var hs-var hs-var">schema'</span></a></span></span><span> </span><span id="local-6989586621679158958"><span class="annot"><span class="annottext">visited :: [TypeName]
</span><a href="#local-6989586621679158958"><span class="hs-identifier hs-var">visited</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Tagged (Term sch (sch :/: t)) Schema
-&gt; Tagged (FieldValue sch ('TSchematic t)) Schema
forall a b. Coercible a b =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">coerce</span></span><span> </span><span class="annot"><span class="annottext">(Tagged (Term sch (sch :/: t)) Schema
 -&gt; Tagged (FieldValue sch ('TSchematic t)) Schema)
-&gt; Tagged (Term sch (sch :/: t)) Schema
-&gt; Tagged (FieldValue sch ('TSchematic t)) Schema
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[TypeName] -&gt; Tagged (Term sch (sch :/: t)) Schema
forall k (x :: k).
HasAvroSchema' x =&gt;
[TypeName] -&gt; Tagged x Schema
</span><a href="Mu.Adapter.Avro.html#schema%27"><span class="hs-identifier hs-var">schema'</span></a></span><span> </span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Term</span></span><span> </span><span class="annot"><a href="#local-6989586621679158964"><span class="hs-identifier hs-type">sch</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679158964"><span class="hs-identifier hs-type">sch</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">:/:</span></span><span> </span><span class="annot"><a href="#local-6989586621679158963"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[TypeName]
</span><a href="#local-6989586621679158958"><span class="hs-identifier hs-var">visited</span></a></span></span></span><span>
</span><span id="line-175"></span><span class="hs-keyword">instance</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679158955"><span class="annot"><a href="#local-6989586621679158955"><span class="hs-identifier hs-type">sch</span></a></span></span><span> </span><span id="local-6989586621679158954"><span class="annot"><a href="#local-6989586621679158954"><span class="hs-identifier hs-type">choices</span></a></span></span><span class="hs-operator">.</span><span>
</span><span id="line-176"></span><span>         </span><span class="annot"><a href="Mu.Adapter.Avro.html#HasAvroSchemaUnion"><span class="hs-identifier hs-type">HasAvroSchemaUnion</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">FieldValue</span></span><span> </span><span class="annot"><a href="#local-6989586621679158955"><span class="hs-identifier hs-type">sch</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679158954"><span class="hs-identifier hs-type">choices</span></a></span><span>
</span><span id="line-177"></span><span>         </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Mu.Adapter.Avro.html#HasAvroSchema%27"><span class="hs-identifier hs-type">HasAvroSchema'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">FieldValue</span></span><span> </span><span class="annot"><a href="#local-6989586621679158955"><span class="hs-identifier hs-type">sch</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><span class="hs-identifier hs-type">TUnion</span></span><span> </span><span class="annot"><a href="#local-6989586621679158954"><span class="hs-identifier hs-type">choices</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-178"></span><span>  </span><span id="local-6989586621679158953"><span class="annot"><span class="annottext">typeName' :: Proxy (FieldValue sch ('TUnion choices)) -&gt; [TypeName]
</span><a href="#local-6989586621679158953"><span class="hs-identifier hs-var hs-var hs-var hs-var">typeName'</span></a></span></span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-179"></span><span>  </span><span id="local-6989586621679158952"><span class="annot"><span class="annottext">schema' :: [TypeName] -&gt; Tagged (FieldValue sch ('TUnion choices)) Schema
</span><a href="#local-6989586621679158952"><span class="hs-identifier hs-var hs-var hs-var hs-var">schema'</span></a></span></span><span> </span><span id="local-6989586621679158951"><span class="annot"><span class="annottext">visited :: [TypeName]
</span><a href="#local-6989586621679158951"><span class="hs-identifier hs-var">visited</span></a></span></span><span>
</span><span id="line-180"></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Schema -&gt; Tagged (FieldValue sch ('TUnion choices)) Schema
forall k (s :: k) b. b -&gt; Tagged s b
</span><span class="hs-identifier hs-var">Tagged</span></span><span> </span><span class="annot"><span class="annottext">(Schema -&gt; Tagged (FieldValue sch ('TUnion choices)) Schema)
-&gt; Schema -&gt; Tagged (FieldValue sch ('TUnion choices)) Schema
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">NonEmpty Schema -&gt; Schema
</span><span class="hs-identifier hs-var">ASch.mkUnion</span></span><span> </span><span class="annot"><span class="annottext">(NonEmpty Schema -&gt; Schema) -&gt; NonEmpty Schema -&gt; Schema
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Proxy (FieldValue sch)
-&gt; Proxy choices -&gt; [TypeName] -&gt; NonEmpty Schema
forall k (f :: k -&gt; *) (xs :: [k]).
HasAvroSchemaUnion f xs =&gt;
Proxy f -&gt; Proxy xs -&gt; [TypeName] -&gt; NonEmpty Schema
</span><a href="Mu.Adapter.Avro.html#schemaU"><span class="hs-identifier hs-var">schemaU</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Proxy (FieldValue sch)
forall k (t :: k). Proxy t
</span><span class="hs-identifier hs-var">Proxy</span></span><span> </span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">FieldValue</span></span><span> </span><span class="annot"><a href="#local-6989586621679158955"><span class="hs-identifier hs-type">sch</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Proxy choices
forall k (t :: k). Proxy t
</span><span class="hs-identifier hs-var">Proxy</span></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621679158954"><span class="hs-identifier hs-type">choices</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[TypeName]
</span><a href="#local-6989586621679158951"><span class="hs-identifier hs-var">visited</span></a></span><span>
</span><span id="line-181"></span><span id="local-6989586621679158947"><span id="local-6989586621679158948"><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Mu.Adapter.Avro.html#HasAvroSchema%27"><span class="hs-identifier hs-type">HasAvroSchema'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">FieldValue</span></span><span> </span><span class="annot"><a href="#local-6989586621679158948"><span class="hs-identifier hs-type">sch</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679158947"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-182"></span><span>         </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Mu.Adapter.Avro.html#HasAvroSchema%27"><span class="hs-identifier hs-type">HasAvroSchema'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">FieldValue</span></span><span> </span><span class="annot"><a href="#local-6989586621679158948"><span class="hs-identifier hs-type">sch</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><span class="hs-identifier hs-type">TOption</span></span><span> </span><span class="annot"><a href="#local-6989586621679158947"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-183"></span><span>  </span><span id="local-6989586621679158944"><span class="annot"><span class="annottext">typeName' :: Proxy (FieldValue sch ('TOption t)) -&gt; [TypeName]
</span><a href="#local-6989586621679158944"><span class="hs-identifier hs-var hs-var hs-var hs-var">typeName'</span></a></span></span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-184"></span><span>  </span><span id="local-6989586621679158943"><span class="annot"><span class="annottext">schema' :: [TypeName] -&gt; Tagged (FieldValue sch ('TOption t)) Schema
</span><a href="#local-6989586621679158943"><span class="hs-identifier hs-var hs-var hs-var hs-var">schema'</span></a></span></span><span> </span><span id="local-6989586621679158942"><span class="annot"><span class="annottext">visited :: [TypeName]
</span><a href="#local-6989586621679158942"><span class="hs-identifier hs-var">visited</span></a></span></span><span>
</span><span id="line-185"></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Schema -&gt; Tagged (FieldValue sch ('TOption t)) Schema
forall k (s :: k) b. b -&gt; Tagged s b
</span><span class="hs-identifier hs-var">Tagged</span></span><span> </span><span class="annot"><span class="annottext">(Schema -&gt; Tagged (FieldValue sch ('TOption t)) Schema)
-&gt; Schema -&gt; Tagged (FieldValue sch ('TOption t)) Schema
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">NonEmpty Schema -&gt; Schema
</span><span class="hs-identifier hs-var">ASch.mkUnion</span></span><span> </span><span class="annot"><span class="annottext">(NonEmpty Schema -&gt; Schema) -&gt; NonEmpty Schema -&gt; Schema
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Schema
</span><span class="hs-identifier hs-var">ASch.Null</span></span><span> </span><span class="annot"><span class="annottext">Schema -&gt; [Schema] -&gt; NonEmpty Schema
forall a. a -&gt; [a] -&gt; NonEmpty a
</span><span class="hs-operator hs-var">:|</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Schema
</span><a href="#local-6989586621679158940"><span class="hs-identifier hs-var">iSchema</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-186"></span><span>    </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621679158940"><span class="annot"><span class="annottext">iSchema :: Schema
</span><a href="#local-6989586621679158940"><span class="hs-identifier hs-var hs-var">iSchema</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Tagged (FieldValue sch t) Schema -&gt; Schema
forall k (s :: k) b. Tagged s b -&gt; b
</span><span class="hs-identifier hs-var hs-var">unTagged</span></span><span> </span><span class="annot"><span class="annottext">(Tagged (FieldValue sch t) Schema -&gt; Schema)
-&gt; Tagged (FieldValue sch t) Schema -&gt; Schema
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[TypeName] -&gt; Tagged (FieldValue sch t) Schema
forall k (x :: k).
HasAvroSchema' x =&gt;
[TypeName] -&gt; Tagged x Schema
</span><a href="Mu.Adapter.Avro.html#schema%27"><span class="hs-identifier hs-var">schema'</span></a></span><span> </span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">FieldValue</span></span><span> </span><span class="annot"><a href="#local-6989586621679158948"><span class="hs-identifier hs-type">sch</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679158947"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[TypeName]
</span><a href="#local-6989586621679158942"><span class="hs-identifier hs-var">visited</span></a></span></span></span><span>
</span><span id="line-187"></span><span id="local-6989586621679158938"><span id="local-6989586621679158939"><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Mu.Adapter.Avro.html#HasAvroSchema%27"><span class="hs-identifier hs-type">HasAvroSchema'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">FieldValue</span></span><span> </span><span class="annot"><a href="#local-6989586621679158939"><span class="hs-identifier hs-type">sch</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679158938"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-188"></span><span>         </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Mu.Adapter.Avro.html#HasAvroSchema%27"><span class="hs-identifier hs-type">HasAvroSchema'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">FieldValue</span></span><span> </span><span class="annot"><a href="#local-6989586621679158939"><span class="hs-identifier hs-type">sch</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><span class="hs-identifier hs-type">TList</span></span><span> </span><span class="annot"><a href="#local-6989586621679158938"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-189"></span><span>  </span><span id="local-6989586621679158935"><span class="annot"><span class="annottext">typeName' :: Proxy (FieldValue sch ('TList t)) -&gt; [TypeName]
</span><a href="#local-6989586621679158935"><span class="hs-identifier hs-var hs-var hs-var hs-var">typeName'</span></a></span></span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-190"></span><span>  </span><span id="local-6989586621679158934"><span class="annot"><span class="annottext">schema' :: [TypeName] -&gt; Tagged (FieldValue sch ('TList t)) Schema
</span><a href="#local-6989586621679158934"><span class="hs-identifier hs-var hs-var hs-var hs-var">schema'</span></a></span></span><span> </span><span id="local-6989586621679158933"><span class="annot"><span class="annottext">visited :: [TypeName]
</span><a href="#local-6989586621679158933"><span class="hs-identifier hs-var">visited</span></a></span></span><span>
</span><span id="line-191"></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Schema -&gt; Tagged (FieldValue sch ('TList t)) Schema
forall k (s :: k) b. b -&gt; Tagged s b
</span><span class="hs-identifier hs-var">Tagged</span></span><span> </span><span class="annot"><span class="annottext">(Schema -&gt; Tagged (FieldValue sch ('TList t)) Schema)
-&gt; Schema -&gt; Tagged (FieldValue sch ('TList t)) Schema
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Schema -&gt; Schema
</span><span class="hs-identifier hs-var">ASch.Array</span></span><span> </span><span class="annot"><span class="annottext">Schema
</span><a href="#local-6989586621679158931"><span class="hs-identifier hs-var">iSchema</span></a></span><span>
</span><span id="line-192"></span><span>    </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621679158931"><span class="annot"><span class="annottext">iSchema :: Schema
</span><a href="#local-6989586621679158931"><span class="hs-identifier hs-var hs-var">iSchema</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Tagged (FieldValue sch t) Schema -&gt; Schema
forall k (s :: k) b. Tagged s b -&gt; b
</span><span class="hs-identifier hs-var hs-var">unTagged</span></span><span> </span><span class="annot"><span class="annottext">(Tagged (FieldValue sch t) Schema -&gt; Schema)
-&gt; Tagged (FieldValue sch t) Schema -&gt; Schema
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[TypeName] -&gt; Tagged (FieldValue sch t) Schema
forall k (x :: k).
HasAvroSchema' x =&gt;
[TypeName] -&gt; Tagged x Schema
</span><a href="Mu.Adapter.Avro.html#schema%27"><span class="hs-identifier hs-var">schema'</span></a></span><span> </span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">FieldValue</span></span><span> </span><span class="annot"><a href="#local-6989586621679158939"><span class="hs-identifier hs-type">sch</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679158938"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[TypeName]
</span><a href="#local-6989586621679158933"><span class="hs-identifier hs-var">visited</span></a></span></span></span><span>
</span><span id="line-193"></span><span class="hs-comment">-- These are the only two versions of Map supported by the library</span><span>
</span><span id="line-194"></span><span id="local-6989586621679158929"><span id="local-6989586621679158930"><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Mu.Adapter.Avro.html#HasAvroSchema%27"><span class="hs-identifier hs-type">HasAvroSchema'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">FieldValue</span></span><span> </span><span class="annot"><a href="#local-6989586621679158930"><span class="hs-identifier hs-type">sch</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679158929"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-195"></span><span>         </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Mu.Adapter.Avro.html#HasAvroSchema%27"><span class="hs-identifier hs-type">HasAvroSchema'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">FieldValue</span></span><span> </span><span class="annot"><a href="#local-6989586621679158930"><span class="hs-identifier hs-type">sch</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><span class="hs-identifier hs-type">TMap</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><span class="hs-identifier hs-type">TPrimitive</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">T.Text</span></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679158929"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-196"></span><span>  </span><span id="local-6989586621679158926"><span class="annot"><span class="annottext">typeName' :: Proxy (FieldValue sch ('TMap ('TPrimitive Text) v)) -&gt; [TypeName]
</span><a href="#local-6989586621679158926"><span class="hs-identifier hs-var hs-var hs-var hs-var">typeName'</span></a></span></span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-197"></span><span>  </span><span id="local-6989586621679158925"><span class="annot"><span class="annottext">schema' :: [TypeName]
-&gt; Tagged (FieldValue sch ('TMap ('TPrimitive Text) v)) Schema
</span><a href="#local-6989586621679158925"><span class="hs-identifier hs-var hs-var hs-var hs-var">schema'</span></a></span></span><span> </span><span id="local-6989586621679158924"><span class="annot"><span class="annottext">visited :: [TypeName]
</span><a href="#local-6989586621679158924"><span class="hs-identifier hs-var">visited</span></a></span></span><span>
</span><span id="line-198"></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Schema
-&gt; Tagged (FieldValue sch ('TMap ('TPrimitive Text) v)) Schema
forall k (s :: k) b. b -&gt; Tagged s b
</span><span class="hs-identifier hs-var">Tagged</span></span><span> </span><span class="annot"><span class="annottext">(Schema
 -&gt; Tagged (FieldValue sch ('TMap ('TPrimitive Text) v)) Schema)
-&gt; Schema
-&gt; Tagged (FieldValue sch ('TMap ('TPrimitive Text) v)) Schema
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Schema -&gt; Schema
</span><span class="hs-identifier hs-var">ASch.Map</span></span><span> </span><span class="annot"><span class="annottext">Schema
</span><a href="#local-6989586621679158922"><span class="hs-identifier hs-var">iSchema</span></a></span><span>
</span><span id="line-199"></span><span>    </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621679158922"><span class="annot"><span class="annottext">iSchema :: Schema
</span><a href="#local-6989586621679158922"><span class="hs-identifier hs-var hs-var">iSchema</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Tagged (FieldValue sch v) Schema -&gt; Schema
forall k (s :: k) b. Tagged s b -&gt; b
</span><span class="hs-identifier hs-var hs-var">unTagged</span></span><span> </span><span class="annot"><span class="annottext">(Tagged (FieldValue sch v) Schema -&gt; Schema)
-&gt; Tagged (FieldValue sch v) Schema -&gt; Schema
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[TypeName] -&gt; Tagged (FieldValue sch v) Schema
forall k (x :: k).
HasAvroSchema' x =&gt;
[TypeName] -&gt; Tagged x Schema
</span><a href="Mu.Adapter.Avro.html#schema%27"><span class="hs-identifier hs-var">schema'</span></a></span><span> </span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">FieldValue</span></span><span> </span><span class="annot"><a href="#local-6989586621679158930"><span class="hs-identifier hs-type">sch</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679158929"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[TypeName]
</span><a href="#local-6989586621679158924"><span class="hs-identifier hs-var">visited</span></a></span></span></span><span>
</span><span id="line-200"></span><span id="local-6989586621679158920"><span id="local-6989586621679158921"><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Mu.Adapter.Avro.html#HasAvroSchema%27"><span class="hs-identifier hs-type">HasAvroSchema'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">FieldValue</span></span><span> </span><span class="annot"><a href="#local-6989586621679158921"><span class="hs-identifier hs-type">sch</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679158920"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-201"></span><span>         </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Mu.Adapter.Avro.html#HasAvroSchema%27"><span class="hs-identifier hs-type">HasAvroSchema'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">FieldValue</span></span><span> </span><span class="annot"><a href="#local-6989586621679158921"><span class="hs-identifier hs-type">sch</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><span class="hs-identifier hs-type">TMap</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><span class="hs-identifier hs-type">TPrimitive</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679158920"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-202"></span><span>  </span><span id="local-6989586621679158916"><span class="annot"><span class="annottext">typeName' :: Proxy (FieldValue sch ('TMap ('TPrimitive [Char]) v)) -&gt; [TypeName]
</span><a href="#local-6989586621679158916"><span class="hs-identifier hs-var hs-var hs-var hs-var">typeName'</span></a></span></span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-203"></span><span>  </span><span id="local-6989586621679158915"><span class="annot"><span class="annottext">schema' :: [TypeName]
-&gt; Tagged (FieldValue sch ('TMap ('TPrimitive [Char]) v)) Schema
</span><a href="#local-6989586621679158915"><span class="hs-identifier hs-var hs-var hs-var hs-var">schema'</span></a></span></span><span> </span><span id="local-6989586621679158914"><span class="annot"><span class="annottext">visited :: [TypeName]
</span><a href="#local-6989586621679158914"><span class="hs-identifier hs-var">visited</span></a></span></span><span>
</span><span id="line-204"></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Schema
-&gt; Tagged (FieldValue sch ('TMap ('TPrimitive [Char]) v)) Schema
forall k (s :: k) b. b -&gt; Tagged s b
</span><span class="hs-identifier hs-var">Tagged</span></span><span> </span><span class="annot"><span class="annottext">(Schema
 -&gt; Tagged (FieldValue sch ('TMap ('TPrimitive [Char]) v)) Schema)
-&gt; Schema
-&gt; Tagged (FieldValue sch ('TMap ('TPrimitive [Char]) v)) Schema
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Schema -&gt; Schema
</span><span class="hs-identifier hs-var">ASch.Map</span></span><span> </span><span class="annot"><span class="annottext">Schema
</span><a href="#local-6989586621679158913"><span class="hs-identifier hs-var">iSchema</span></a></span><span>
</span><span id="line-205"></span><span>    </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621679158913"><span class="annot"><span class="annottext">iSchema :: Schema
</span><a href="#local-6989586621679158913"><span class="hs-identifier hs-var hs-var">iSchema</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Tagged (FieldValue sch v) Schema -&gt; Schema
forall k (s :: k) b. Tagged s b -&gt; b
</span><span class="hs-identifier hs-var hs-var">unTagged</span></span><span> </span><span class="annot"><span class="annottext">(Tagged (FieldValue sch v) Schema -&gt; Schema)
-&gt; Tagged (FieldValue sch v) Schema -&gt; Schema
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[TypeName] -&gt; Tagged (FieldValue sch v) Schema
forall k (x :: k).
HasAvroSchema' x =&gt;
[TypeName] -&gt; Tagged x Schema
</span><a href="Mu.Adapter.Avro.html#schema%27"><span class="hs-identifier hs-var">schema'</span></a></span><span> </span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">FieldValue</span></span><span> </span><span class="annot"><a href="#local-6989586621679158921"><span class="hs-identifier hs-type">sch</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679158920"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[TypeName]
</span><a href="#local-6989586621679158914"><span class="hs-identifier hs-var">visited</span></a></span></span></span><span>
</span><span id="line-206"></span><span>
</span><span id="line-207"></span><span class="hs-keyword">class</span><span> </span><span id="HasAvroSchemaUnion"><span class="annot"><a href="Mu.Adapter.Avro.html#HasAvroSchemaUnion"><span class="hs-identifier hs-var">HasAvroSchemaUnion</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679159441"><span class="annot"><a href="#local-6989586621679159441"><span class="hs-identifier hs-type">f</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span id="local-6989586621679159442"><span class="annot"><a href="#local-6989586621679159442"><span class="hs-identifier hs-type hs-type">k</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-operator">*</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679159440"><span class="annot"><a href="#local-6989586621679159440"><span class="hs-identifier hs-type">xs</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679159442"><span class="hs-identifier hs-type">k</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-208"></span><span>  </span><span id="schemaU"><span class="annot"><a href="Mu.Adapter.Avro.html#schemaU"><span class="hs-identifier hs-type">schemaU</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Proxy</span></span><span> </span><span class="annot"><a href="#local-6989586621679159441"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Proxy</span></span><span> </span><span class="annot"><a href="#local-6989586621679159440"><span class="hs-identifier hs-type">xs</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">ASch.TypeName</span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">NonEmpty</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">ASch.Schema</span></span><span>
</span><span id="line-209"></span><span id="local-6989586621679158911"><span id="local-6989586621679158912"><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Mu.Adapter.Avro.html#HasAvroSchema%27"><span class="hs-identifier hs-type">HasAvroSchema'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679158912"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679158911"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Mu.Adapter.Avro.html#HasAvroSchemaUnion"><span class="hs-identifier hs-type">HasAvroSchemaUnion</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679158912"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="hs-special">'</span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679158911"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-210"></span><span>  </span><span id="local-6989586621679158908"><span class="annot"><span class="annottext">schemaU :: Proxy f -&gt; Proxy '[v] -&gt; [TypeName] -&gt; NonEmpty Schema
</span><a href="#local-6989586621679158908"><span class="hs-identifier hs-var hs-var hs-var hs-var">schemaU</span></a></span></span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span id="local-6989586621679158907"><span class="annot"><span class="annottext">visited :: [TypeName]
</span><a href="#local-6989586621679158907"><span class="hs-identifier hs-var">visited</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Schema
</span><a href="#local-6989586621679158906"><span class="hs-identifier hs-var">vSchema</span></a></span><span> </span><span class="annot"><span class="annottext">Schema -&gt; [Schema] -&gt; NonEmpty Schema
forall a. a -&gt; [a] -&gt; NonEmpty a
</span><span class="hs-operator hs-var">:|</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-211"></span><span>    </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621679158906"><span class="annot"><span class="annottext">vSchema :: Schema
</span><a href="#local-6989586621679158906"><span class="hs-identifier hs-var hs-var">vSchema</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Tagged (f v) Schema -&gt; Schema
forall k (s :: k) b. Tagged s b -&gt; b
</span><span class="hs-identifier hs-var hs-var">unTagged</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[TypeName] -&gt; Tagged (f v) Schema
forall k (x :: k).
HasAvroSchema' x =&gt;
[TypeName] -&gt; Tagged x Schema
</span><a href="Mu.Adapter.Avro.html#schema%27"><span class="hs-identifier hs-var">schema'</span></a></span><span> </span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679158912"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679158911"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[TypeName]
</span><a href="#local-6989586621679158907"><span class="hs-identifier hs-var">visited</span></a></span><span class="hs-special">)</span></span></span><span>
</span><span id="line-212"></span><span id="local-6989586621679158902"><span id="local-6989586621679158903"><span id="local-6989586621679158904"><span id="local-6989586621679158905"><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Mu.Adapter.Avro.html#HasAvroSchema%27"><span class="hs-identifier hs-type">HasAvroSchema'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679158905"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679158904"><span class="hs-identifier hs-type">x</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Mu.Adapter.Avro.html#HasAvroSchemaUnion"><span class="hs-identifier hs-type">HasAvroSchemaUnion</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679158905"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679158903"><span class="hs-identifier hs-type">y</span></a></span><span> </span><span class="hs-special">'</span><span class="hs-glyph">:</span><span> </span><span class="annot"><a href="#local-6989586621679158902"><span class="hs-identifier hs-type">zs</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-213"></span><span>         </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Mu.Adapter.Avro.html#HasAvroSchemaUnion"><span class="hs-identifier hs-type">HasAvroSchemaUnion</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679158905"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679158904"><span class="hs-identifier hs-type">x</span></a></span><span> </span><span class="hs-special">'</span><span class="hs-glyph">:</span><span> </span><span class="annot"><a href="#local-6989586621679158903"><span class="hs-identifier hs-type">y</span></a></span><span> </span><span class="hs-special">'</span><span class="hs-glyph">:</span><span> </span><span class="annot"><a href="#local-6989586621679158902"><span class="hs-identifier hs-type">zs</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-214"></span><span>  </span><span id="local-6989586621679158900"><span class="annot"><span class="annottext">schemaU :: Proxy f -&gt; Proxy (x : y : zs) -&gt; [TypeName] -&gt; NonEmpty Schema
</span><a href="#local-6989586621679158900"><span class="hs-identifier hs-var hs-var hs-var hs-var">schemaU</span></a></span></span><span> </span><span id="local-6989586621679158899"><span class="annot"><span class="annottext">p :: Proxy f
</span><a href="#local-6989586621679158899"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-identifier">_</span><span> </span><span id="local-6989586621679158898"><span class="annot"><span class="annottext">visited :: [TypeName]
</span><a href="#local-6989586621679158898"><span class="hs-identifier hs-var">visited</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Schema
</span><a href="#local-6989586621679158897"><span class="hs-identifier hs-var">xSchema</span></a></span><span> </span><span class="annot"><span class="annottext">Schema -&gt; [Schema] -&gt; NonEmpty Schema
forall a. a -&gt; [a] -&gt; NonEmpty a
</span><span class="hs-operator hs-var">:|</span></span><span> </span><span class="annot"><span class="annottext">NonEmpty Schema -&gt; [Schema]
forall a. NonEmpty a -&gt; [a]
</span><span class="hs-identifier hs-var">NonEmptyList.toList</span></span><span> </span><span class="annot"><span class="annottext">NonEmpty Schema
</span><a href="#local-6989586621679158895"><span class="hs-identifier hs-var">yzsSchema</span></a></span><span>
</span><span id="line-215"></span><span>    </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621679158897"><span class="annot"><span class="annottext">xSchema :: Schema
</span><a href="#local-6989586621679158897"><span class="hs-identifier hs-var hs-var">xSchema</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Tagged (f x) Schema -&gt; Schema
forall k (s :: k) b. Tagged s b -&gt; b
</span><span class="hs-identifier hs-var hs-var">unTagged</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[TypeName] -&gt; Tagged (f x) Schema
forall k (x :: k).
HasAvroSchema' x =&gt;
[TypeName] -&gt; Tagged x Schema
</span><a href="Mu.Adapter.Avro.html#schema%27"><span class="hs-identifier hs-var">schema'</span></a></span><span> </span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679158905"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679158904"><span class="hs-identifier hs-type">x</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[TypeName]
</span><a href="#local-6989586621679158898"><span class="hs-identifier hs-var">visited</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-216"></span><span>          </span><span id="local-6989586621679158895"><span class="annot"><span class="annottext">yzsSchema :: NonEmpty Schema
</span><a href="#local-6989586621679158895"><span class="hs-identifier hs-var hs-var">yzsSchema</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Proxy f -&gt; Proxy (y : zs) -&gt; [TypeName] -&gt; NonEmpty Schema
forall k (f :: k -&gt; *) (xs :: [k]).
HasAvroSchemaUnion f xs =&gt;
Proxy f -&gt; Proxy xs -&gt; [TypeName] -&gt; NonEmpty Schema
</span><a href="Mu.Adapter.Avro.html#schemaU"><span class="hs-identifier hs-var">schemaU</span></a></span><span> </span><span class="annot"><span class="annottext">Proxy f
</span><a href="#local-6989586621679158899"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Proxy (y : zs)
forall k (t :: k). Proxy t
</span><span class="hs-identifier hs-var">Proxy</span></span><span> </span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679158903"><span class="hs-identifier hs-type">y</span></a></span><span> </span><span class="hs-special">'</span><span class="hs-glyph">:</span><span> </span><span class="annot"><a href="#local-6989586621679158902"><span class="hs-identifier hs-type">zs</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[TypeName]
</span><a href="#local-6989586621679158898"><span class="hs-identifier hs-var">visited</span></a></span></span></span></span></span><span>
</span><span id="line-217"></span><span>
</span><span id="line-218"></span><span class="hs-keyword">class</span><span> </span><span id="HasAvroSchemaFields"><span class="annot"><a href="Mu.Adapter.Avro.html#HasAvroSchemaFields"><span class="hs-identifier hs-var">HasAvroSchemaFields</span></a></span></span><span> </span><span id="local-6989586621679159481"><span class="annot"><a href="#local-6989586621679159481"><span class="hs-identifier hs-type">sch</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679159480"><span class="annot"><a href="#local-6989586621679159480"><span class="hs-identifier hs-type">fs</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">FieldDef</span></span><span> </span><span id="local-6989586621679159483"><span class="annot"><a href="#local-6989586621679159483"><span class="hs-identifier hs-type hs-type">tn</span></a></span></span><span> </span><span id="local-6989586621679159482"><span class="annot"><a href="#local-6989586621679159482"><span class="hs-identifier hs-type hs-type">fn</span></a></span></span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-219"></span><span>  </span><span id="schemaF"><span class="annot"><a href="Mu.Adapter.Avro.html#schemaF"><span class="hs-identifier hs-type">schemaF</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Proxy</span></span><span> </span><span class="annot"><a href="#local-6989586621679159481"><span class="hs-identifier hs-type">sch</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Proxy</span></span><span> </span><span class="annot"><a href="#local-6989586621679159480"><span class="hs-identifier hs-type">fs</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">ASch.TypeName</span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">ASch.Field</span></span><span class="hs-special">]</span><span>
</span><span id="line-220"></span><span id="local-6989586621679158894"><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Mu.Adapter.Avro.html#HasAvroSchemaFields"><span class="hs-identifier hs-type">HasAvroSchemaFields</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679158894"><span class="hs-identifier hs-type">sch</span></a></span><span> </span><span class="hs-special">'</span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-221"></span><span>  </span><span id="local-6989586621679158891"><span class="annot"><span class="annottext">schemaF :: Proxy sch -&gt; Proxy '[] -&gt; [TypeName] -&gt; [Field]
</span><a href="#local-6989586621679158891"><span class="hs-identifier hs-var hs-var hs-var hs-var">schemaF</span></a></span></span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span></span><span>
</span><span id="line-222"></span><span id="local-6989586621679158887"><span id="local-6989586621679158888"><span id="local-6989586621679158889"><span id="local-6989586621679158890"><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">KnownName</span></span><span> </span><span class="annot"><a href="#local-6989586621679158890"><span class="hs-identifier hs-type">name</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Mu.Adapter.Avro.html#HasAvroSchema%27"><span class="hs-identifier hs-type">HasAvroSchema'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">FieldValue</span></span><span> </span><span class="annot"><a href="#local-6989586621679158889"><span class="hs-identifier hs-type">sch</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679158888"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Mu.Adapter.Avro.html#HasAvroSchemaFields"><span class="hs-identifier hs-type">HasAvroSchemaFields</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679158889"><span class="hs-identifier hs-type">sch</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679158887"><span class="hs-identifier hs-type">fs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-223"></span><span>         </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Mu.Adapter.Avro.html#HasAvroSchemaFields"><span class="hs-identifier hs-type">HasAvroSchemaFields</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679158889"><span class="hs-identifier hs-type">sch</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><span class="hs-identifier hs-type">FieldDef</span></span><span> </span><span class="annot"><a href="#local-6989586621679158890"><span class="hs-identifier hs-type">name</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679158888"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="hs-special">'</span><span class="hs-glyph">:</span><span> </span><span class="annot"><a href="#local-6989586621679158887"><span class="hs-identifier hs-type">fs</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-224"></span><span>  </span><span id="local-6989586621679158885"><span class="annot"><span class="annottext">schemaF :: Proxy sch -&gt; Proxy ('FieldDef name t : fs) -&gt; [TypeName] -&gt; [Field]
</span><a href="#local-6989586621679158885"><span class="hs-identifier hs-var hs-var hs-var hs-var">schemaF</span></a></span></span><span> </span><span id="local-6989586621679158884"><span class="annot"><span class="annottext">psch :: Proxy sch
</span><a href="#local-6989586621679158884"><span class="hs-identifier hs-var">psch</span></a></span></span><span> </span><span class="hs-identifier">_</span><span> </span><span id="local-6989586621679158883"><span class="annot"><span class="annottext">visited :: [TypeName]
</span><a href="#local-6989586621679158883"><span class="hs-identifier hs-var">visited</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Field
</span><a href="#local-6989586621679158882"><span class="hs-identifier hs-var">schemaThis</span></a></span><span> </span><span class="annot"><span class="annottext">Field -&gt; [Field] -&gt; [Field]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">Proxy sch -&gt; Proxy fs -&gt; [TypeName] -&gt; [Field]
forall k tn fn (sch :: k) (fs :: [FieldDef tn fn]).
HasAvroSchemaFields sch fs =&gt;
Proxy sch -&gt; Proxy fs -&gt; [TypeName] -&gt; [Field]
</span><a href="Mu.Adapter.Avro.html#schemaF"><span class="hs-identifier hs-var">schemaF</span></a></span><span> </span><span class="annot"><span class="annottext">Proxy sch
</span><a href="#local-6989586621679158884"><span class="hs-identifier hs-var">psch</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Proxy fs
forall k (t :: k). Proxy t
</span><span class="hs-identifier hs-var">Proxy</span></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621679158887"><span class="hs-identifier hs-type">fs</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[TypeName]
</span><a href="#local-6989586621679158883"><span class="hs-identifier hs-var">visited</span></a></span><span>
</span><span id="line-225"></span><span>    </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621679158881"><span class="annot"><span class="annottext">fieldName :: Text
</span><a href="#local-6989586621679158881"><span class="hs-identifier hs-var hs-var">fieldName</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Proxy name -&gt; Text
forall k (s :: k) (proxy :: k -&gt; *). KnownName s =&gt; proxy s -&gt; Text
</span><a href="Mu.Adapter.Avro.html#nameText"><span class="hs-identifier hs-var">nameText</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Proxy name
forall k (t :: k). Proxy t
</span><span class="hs-identifier hs-var">Proxy</span></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621679158890"><span class="hs-identifier hs-type">name</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-226"></span><span>          </span><span id="local-6989586621679158879"><span class="annot"><span class="annottext">schemaT :: Schema
</span><a href="#local-6989586621679158879"><span class="hs-identifier hs-var hs-var">schemaT</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Tagged (FieldValue sch t) Schema -&gt; Schema
forall k (s :: k) b. Tagged s b -&gt; b
</span><span class="hs-identifier hs-var hs-var">unTagged</span></span><span> </span><span class="annot"><span class="annottext">(Tagged (FieldValue sch t) Schema -&gt; Schema)
-&gt; Tagged (FieldValue sch t) Schema -&gt; Schema
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[TypeName] -&gt; Tagged (FieldValue sch t) Schema
forall k (x :: k).
HasAvroSchema' x =&gt;
[TypeName] -&gt; Tagged x Schema
</span><a href="Mu.Adapter.Avro.html#schema%27"><span class="hs-identifier hs-var">schema'</span></a></span><span> </span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">FieldValue</span></span><span> </span><span class="annot"><a href="#local-6989586621679158889"><span class="hs-identifier hs-type">sch</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679158888"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[TypeName]
</span><a href="#local-6989586621679158883"><span class="hs-identifier hs-var">visited</span></a></span><span>
</span><span id="line-227"></span><span>          </span><span id="local-6989586621679158882"><span class="annot"><span class="annottext">schemaThis :: Field
</span><a href="#local-6989586621679158882"><span class="hs-identifier hs-var hs-var">schemaThis</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Text
-&gt; [Text]
-&gt; Maybe Text
-&gt; Maybe Order
-&gt; Schema
-&gt; Maybe DefaultValue
-&gt; Field
</span><span class="hs-identifier hs-var">ASch.Field</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679158881"><span class="hs-identifier hs-var">fieldName</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">Maybe Text
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="annot"><span class="annottext">Maybe Order
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="annot"><span class="annottext">Schema
</span><a href="#local-6989586621679158879"><span class="hs-identifier hs-var">schemaT</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe DefaultValue
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span></span></span></span></span><span>
</span><span id="line-228"></span><span>
</span><span id="line-229"></span><span class="hs-keyword">class</span><span> </span><span id="HasAvroSchemaEnum"><span class="annot"><a href="Mu.Adapter.Avro.html#HasAvroSchemaEnum"><span class="hs-identifier hs-var">HasAvroSchemaEnum</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679159470"><span class="annot"><a href="#local-6989586621679159470"><span class="hs-identifier hs-type">fs</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">ChoiceDef</span></span><span> </span><span id="local-6989586621679159471"><span class="annot"><a href="#local-6989586621679159471"><span class="hs-identifier hs-type hs-type">fn</span></a></span></span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-230"></span><span>  </span><span id="schemaE"><span class="annot"><a href="Mu.Adapter.Avro.html#schemaE"><span class="hs-identifier hs-type">schemaE</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Proxy</span></span><span> </span><span class="annot"><a href="#local-6989586621679159470"><span class="hs-identifier hs-type">fs</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">T.Text</span></span><span class="hs-special">]</span><span>
</span><span id="line-231"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Mu.Adapter.Avro.html#HasAvroSchemaEnum"><span class="hs-identifier hs-type">HasAvroSchemaEnum</span></a></span><span> </span><span class="hs-special">'</span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-232"></span><span>  </span><span id="local-6989586621679158875"><span class="annot"><span class="annottext">schemaE :: Proxy '[] -&gt; [Text]
</span><a href="#local-6989586621679158875"><span class="hs-identifier hs-var hs-var hs-var hs-var">schemaE</span></a></span></span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-233"></span><span id="local-6989586621679158873"><span id="local-6989586621679158874"><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">KnownName</span></span><span> </span><span class="annot"><a href="#local-6989586621679158874"><span class="hs-identifier hs-type">name</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Mu.Adapter.Avro.html#HasAvroSchemaEnum"><span class="hs-identifier hs-type">HasAvroSchemaEnum</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679158873"><span class="hs-identifier hs-type">fs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-234"></span><span>         </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Mu.Adapter.Avro.html#HasAvroSchemaEnum"><span class="hs-identifier hs-type">HasAvroSchemaEnum</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><span class="hs-identifier hs-type">ChoiceDef</span></span><span> </span><span class="annot"><a href="#local-6989586621679158874"><span class="hs-identifier hs-type">name</span></a></span><span> </span><span class="hs-special">'</span><span class="hs-glyph">:</span><span> </span><span class="annot"><a href="#local-6989586621679158873"><span class="hs-identifier hs-type">fs</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-235"></span><span>  </span><span id="local-6989586621679158871"><span class="annot"><span class="annottext">schemaE :: Proxy ('ChoiceDef name : fs) -&gt; [Text]
</span><a href="#local-6989586621679158871"><span class="hs-identifier hs-var hs-var hs-var hs-var">schemaE</span></a></span></span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Proxy name -&gt; Text
forall k (s :: k) (proxy :: k -&gt; *). KnownName s =&gt; proxy s -&gt; Text
</span><a href="Mu.Adapter.Avro.html#nameText"><span class="hs-identifier hs-var">nameText</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Proxy name
forall k (t :: k). Proxy t
</span><span class="hs-identifier hs-var">Proxy</span></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621679158874"><span class="hs-identifier hs-type">name</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Text -&gt; [Text] -&gt; [Text]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">Proxy fs -&gt; [Text]
forall fn (fs :: [ChoiceDef fn]).
HasAvroSchemaEnum fs =&gt;
Proxy fs -&gt; [Text]
</span><a href="Mu.Adapter.Avro.html#schemaE"><span class="hs-identifier hs-var">schemaE</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Proxy fs
forall k (t :: k). Proxy t
</span><span class="hs-identifier hs-var">Proxy</span></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621679158873"><span class="hs-identifier hs-type">fs</span></a></span><span class="hs-special">)</span></span></span><span>
</span><span id="line-236"></span><span>
</span><span id="line-237"></span><span class="hs-comment">-- FromAvro instances</span><span>
</span><span id="line-238"></span><span>
</span><span id="line-239"></span><span id="local-6989586621679158868"><span id="local-6989586621679158869"><span id="local-6989586621679158870"><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">KnownName</span></span><span> </span><span class="annot"><a href="#local-6989586621679158870"><span class="hs-identifier hs-type">name</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Mu.Adapter.Avro.html#FromAvroFields"><span class="hs-identifier hs-type">FromAvroFields</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679158869"><span class="hs-identifier hs-type">sch</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679158868"><span class="hs-identifier hs-type">args</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-240"></span><span>         </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">A.FromAvro</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Term</span></span><span> </span><span class="annot"><a href="#local-6989586621679158869"><span class="hs-identifier hs-type">sch</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><span class="hs-identifier hs-type">DRecord</span></span><span> </span><span class="annot"><a href="#local-6989586621679158870"><span class="hs-identifier hs-type">name</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679158868"><span class="hs-identifier hs-type">args</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-241"></span><span>  </span><span id="local-6989586621679158866"><span class="annot"><span class="annottext">fromAvro :: Value -&gt; Either [Char] (Term sch ('DRecord name args))
</span><a href="#local-6989586621679158866"><span class="hs-identifier hs-var hs-var hs-var hs-var">fromAvro</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">AVal.Record</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">RSch.Record</span></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">fields :: ReadSchema -&gt; [ReadField]
</span><span class="hs-identifier hs-var">RSch.fields</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621679158865"><span class="annot"><span class="annottext">[ReadField]
</span><a href="#local-6989586621679158865"><span class="hs-identifier hs-var">fs</span></a></span></span><span> </span><span class="hs-special">}</span><span> </span><span id="local-6989586621679158864"><span class="annot"><span class="annottext">fields :: Vector Value
</span><a href="#local-6989586621679158864"><span class="hs-identifier hs-var">fields</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-242"></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">NP (Field sch) args -&gt; Term sch ('DRecord name args)
forall typeName fieldName (sch :: Schema typeName fieldName)
       (args :: [FieldDef typeName fieldName]) (name :: typeName).
NP (Field sch) args -&gt; Term sch ('DRecord name args)
</span><span class="hs-identifier hs-var">TRecord</span></span><span> </span><span class="annot"><span class="annottext">(NP (Field sch) args -&gt; Term sch ('DRecord name args))
-&gt; Either [Char] (NP (Field sch) args)
-&gt; Either [Char] (Term sch ('DRecord name args))
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">HashMap Text Value -&gt; Either [Char] (NP (Field sch) args)
forall (sch :: Schema Symbol Symbol)
       (fs :: [FieldDef Symbol Symbol]).
FromAvroFields sch fs =&gt;
HashMap Text Value -&gt; Either [Char] (NP (Field sch) fs)
</span><a href="Mu.Adapter.Avro.html#fromAvroF"><span class="hs-identifier hs-var">fromAvroF</span></a></span><span> </span><span class="annot"><span class="annottext">HashMap Text Value
</span><a href="#local-6989586621679158861"><span class="hs-identifier hs-var">r</span></a></span><span>
</span><span id="line-243"></span><span>    </span><span class="hs-keyword">where</span><span>
</span><span id="line-244"></span><span>      </span><span id="local-6989586621679158861"><span class="annot"><span class="annottext">r :: HashMap Text Value
</span><a href="#local-6989586621679158861"><span class="hs-identifier hs-var hs-var">r</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[(Text, Value)] -&gt; HashMap Text Value
forall k v. (Eq k, Hashable k) =&gt; [(k, v)] -&gt; HashMap k v
</span><span class="hs-identifier hs-var">HM.fromList</span></span><span> </span><span class="annot"><span class="annottext">([(Text, Value)] -&gt; HashMap Text Value)
-&gt; [(Text, Value)] -&gt; HashMap Text Value
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[Text] -&gt; [Value] -&gt; [(Text, Value)]
forall a b. [a] -&gt; [b] -&gt; [(a, b)]
</span><span class="hs-identifier hs-var">zip</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(ReadField -&gt; Text) -&gt; [ReadField] -&gt; [Text]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">ReadField -&gt; Text
</span><span class="hs-identifier hs-var hs-var">RSch.fldName</span></span><span> </span><span class="annot"><span class="annottext">[ReadField]
</span><a href="#local-6989586621679158865"><span class="hs-identifier hs-var">fs</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Vector Value -&gt; [Value]
forall a. Vector a -&gt; [a]
</span><span class="hs-identifier hs-var">V.toList</span></span><span> </span><span class="annot"><span class="annottext">Vector Value
</span><a href="#local-6989586621679158864"><span class="hs-identifier hs-var">fields</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-245"></span><span>  </span><span class="annot"><span class="hs-identifier hs-var">fromAvro</span></span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; Either [Char] (Term sch ('DRecord name args))
forall a b. a -&gt; Either a b
</span><span class="hs-identifier hs-var">Left</span></span><span> </span><span class="annot"><span class="hs-string">&quot;expecting record&quot;</span></span></span></span></span><span>
</span><span id="line-246"></span><span id="local-6989586621679158857"><span id="local-6989586621679158858"><span id="local-6989586621679158859"><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">KnownName</span></span><span> </span><span class="annot"><a href="#local-6989586621679158859"><span class="hs-identifier hs-type">name</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Mu.Adapter.Avro.html#FromAvroEnum"><span class="hs-identifier hs-type">FromAvroEnum</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679158858"><span class="hs-identifier hs-type">choices</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-247"></span><span>          </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">A.FromAvro</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Term</span></span><span> </span><span class="annot"><a href="#local-6989586621679158857"><span class="hs-identifier hs-type">sch</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><span class="hs-identifier hs-type">DEnum</span></span><span> </span><span class="annot"><a href="#local-6989586621679158859"><span class="hs-identifier hs-type">name</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679158858"><span class="hs-identifier hs-type">choices</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-248"></span><span>  </span><span id="local-6989586621679158855"><span class="annot"><span class="annottext">fromAvro :: Value -&gt; Either [Char] (Term sch ('DEnum name choices))
</span><a href="#local-6989586621679158855"><span class="hs-identifier hs-var hs-var hs-var hs-var">fromAvro</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">AVal.Enum</span></span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span id="local-6989586621679158854"><span class="annot"><span class="annottext">v :: Text
</span><a href="#local-6989586621679158854"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">NS Proxy choices -&gt; Term sch ('DEnum name choices)
forall fieldName typeName (choices :: [ChoiceDef fieldName])
       (sch :: Schema typeName fieldName) (name :: typeName).
NS Proxy choices -&gt; Term sch ('DEnum name choices)
</span><span class="hs-identifier hs-var">TEnum</span></span><span> </span><span class="annot"><span class="annottext">(NS Proxy choices -&gt; Term sch ('DEnum name choices))
-&gt; Either [Char] (NS Proxy choices)
-&gt; Either [Char] (Term sch ('DEnum name choices))
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Either [Char] (NS Proxy choices)
forall fn (vs :: [ChoiceDef fn]).
FromAvroEnum vs =&gt;
Text -&gt; Either [Char] (NS Proxy vs)
</span><a href="Mu.Adapter.Avro.html#fromAvroEnum"><span class="hs-identifier hs-var">fromAvroEnum</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679158854"><span class="hs-identifier hs-var">v</span></a></span><span>
</span><span id="line-249"></span><span>  </span><span class="annot"><span class="hs-identifier hs-var">fromAvro</span></span><span> </span><span class="hs-identifier">_</span><span>                 </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; Either [Char] (Term sch ('DEnum name choices))
forall a b. a -&gt; Either a b
</span><span class="hs-identifier hs-var">Left</span></span><span> </span><span class="annot"><span class="hs-string">&quot;expecting enum&quot;</span></span></span></span></span><span>
</span><span id="line-250"></span><span id="local-6989586621679158850"><span id="local-6989586621679158851"><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">A.FromAvro</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">FieldValue</span></span><span> </span><span class="annot"><a href="#local-6989586621679158851"><span class="hs-identifier hs-type">sch</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679158850"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-251"></span><span>         </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">A.FromAvro</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Term</span></span><span> </span><span class="annot"><a href="#local-6989586621679158851"><span class="hs-identifier hs-type">sch</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><span class="hs-identifier hs-type">DSimple</span></span><span> </span><span class="annot"><a href="#local-6989586621679158850"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-252"></span><span>  </span><span id="local-6989586621679158848"><span class="annot"><span class="annottext">fromAvro :: Value -&gt; Either [Char] (Term sch ('DSimple t))
</span><a href="#local-6989586621679158848"><span class="hs-identifier hs-var hs-var hs-var hs-var">fromAvro</span></a></span></span><span> </span><span id="local-6989586621679158847"><span class="annot"><span class="annottext">v :: Value
</span><a href="#local-6989586621679158847"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FieldValue sch t -&gt; Term sch ('DSimple t)
forall typeName fieldName (sch :: Schema typeName fieldName)
       (t1 :: FieldType typeName).
FieldValue sch t1 -&gt; Term sch ('DSimple t1)
</span><span class="hs-identifier hs-var">TSimple</span></span><span> </span><span class="annot"><span class="annottext">(FieldValue sch t -&gt; Term sch ('DSimple t))
-&gt; Either [Char] (FieldValue sch t)
-&gt; Either [Char] (Term sch ('DSimple t))
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Value -&gt; Either [Char] (FieldValue sch t)
forall a. FromAvro a =&gt; Value -&gt; Either [Char] a
</span><span class="hs-identifier hs-var">AVal.fromAvro</span></span><span> </span><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621679158847"><span class="hs-identifier hs-var">v</span></a></span></span></span><span>
</span><span id="line-253"></span><span>
</span><span id="line-254"></span><span id="local-6989586621679158845"><span class="hs-keyword">instance</span><span> </span><span class="annot"><span class="hs-identifier hs-type">A.FromAvro</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">FieldValue</span></span><span> </span><span class="annot"><a href="#local-6989586621679158845"><span class="hs-identifier hs-type">sch</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><span class="hs-identifier hs-type">TNull</span></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-255"></span><span>  </span><span id="local-6989586621679158843"><span class="annot"><span class="annottext">fromAvro :: Value -&gt; Either [Char] (FieldValue sch 'TNull)
</span><a href="#local-6989586621679158843"><span class="hs-identifier hs-var hs-var hs-var hs-var">fromAvro</span></a></span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">AVal.Null</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FieldValue sch 'TNull -&gt; Either [Char] (FieldValue sch 'TNull)
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">FieldValue sch 'TNull
forall typeName fieldName (sch :: Schema typeName fieldName).
FieldValue sch 'TNull
</span><span class="hs-identifier hs-var">FNull</span></span><span>
</span><span id="line-256"></span><span>  </span><span class="annot"><span class="hs-identifier hs-var">fromAvro</span></span><span> </span><span class="hs-identifier">_</span><span>         </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; Either [Char] (FieldValue sch 'TNull)
forall a b. a -&gt; Either a b
</span><span class="hs-identifier hs-var">Left</span></span><span> </span><span class="annot"><span class="hs-string">&quot;expecting null&quot;</span></span></span><span>
</span><span id="line-257"></span><span id="local-6989586621679158840"><span id="local-6989586621679158841"><span class="hs-keyword">instance</span><span> </span><span class="annot"><span class="hs-identifier hs-type">A.FromAvro</span></span><span> </span><span class="annot"><a href="#local-6989586621679158841"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">A.FromAvro</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">FieldValue</span></span><span> </span><span class="annot"><a href="#local-6989586621679158840"><span class="hs-identifier hs-type">sch</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><span class="hs-identifier hs-type">TPrimitive</span></span><span> </span><span class="annot"><a href="#local-6989586621679158841"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-258"></span><span>  </span><span id="local-6989586621679158838"><span class="annot"><span class="annottext">fromAvro :: Value -&gt; Either [Char] (FieldValue sch ('TPrimitive t))
</span><a href="#local-6989586621679158838"><span class="hs-identifier hs-var hs-var hs-var hs-var">fromAvro</span></a></span></span><span> </span><span id="local-6989586621679158837"><span class="annot"><span class="annottext">v :: Value
</span><a href="#local-6989586621679158837"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">t -&gt; FieldValue sch ('TPrimitive t)
forall typeName fieldName t1 (sch :: Schema typeName fieldName).
t1 -&gt; FieldValue sch ('TPrimitive t1)
</span><span class="hs-identifier hs-var">FPrimitive</span></span><span> </span><span class="annot"><span class="annottext">(t -&gt; FieldValue sch ('TPrimitive t))
-&gt; Either [Char] t
-&gt; Either [Char] (FieldValue sch ('TPrimitive t))
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Value -&gt; Either [Char] t
forall a. FromAvro a =&gt; Value -&gt; Either [Char] a
</span><span class="hs-identifier hs-var">AVal.fromAvro</span></span><span> </span><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621679158837"><span class="hs-identifier hs-var">v</span></a></span></span></span><span>
</span><span id="line-259"></span><span id="local-6989586621679158834"><span id="local-6989586621679158835"><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-identifier hs-type">KnownName</span></span><span> </span><span class="annot"><a href="#local-6989586621679158835"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">A.FromAvro</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Term</span></span><span> </span><span class="annot"><a href="#local-6989586621679158834"><span class="hs-identifier hs-type">sch</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679158834"><span class="hs-identifier hs-type">sch</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">:/:</span></span><span> </span><span class="annot"><a href="#local-6989586621679158835"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-260"></span><span>         </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">A.FromAvro</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">FieldValue</span></span><span> </span><span class="annot"><a href="#local-6989586621679158834"><span class="hs-identifier hs-type">sch</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><span class="hs-identifier hs-type">TSchematic</span></span><span> </span><span class="annot"><a href="#local-6989586621679158835"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-261"></span><span>  </span><span id="local-6989586621679158832"><span class="annot"><span class="annottext">fromAvro :: Value -&gt; Either [Char] (FieldValue sch ('TSchematic t))
</span><a href="#local-6989586621679158832"><span class="hs-identifier hs-var hs-var hs-var hs-var">fromAvro</span></a></span></span><span> </span><span id="local-6989586621679158831"><span class="annot"><span class="annottext">v :: Value
</span><a href="#local-6989586621679158831"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Term sch (sch :/: t) -&gt; FieldValue sch ('TSchematic t)
forall typeName fieldName (sch :: Schema typeName fieldName)
       (t1 :: typeName).
Term sch (sch :/: t1) -&gt; FieldValue sch ('TSchematic t1)
</span><span class="hs-identifier hs-var">FSchematic</span></span><span> </span><span class="annot"><span class="annottext">(Term sch (sch :/: t) -&gt; FieldValue sch ('TSchematic t))
-&gt; Either [Char] (Term sch (sch :/: t))
-&gt; Either [Char] (FieldValue sch ('TSchematic t))
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Value -&gt; Either [Char] (Term sch (sch :/: t))
forall a. FromAvro a =&gt; Value -&gt; Either [Char] a
</span><span class="hs-identifier hs-var">AVal.fromAvro</span></span><span> </span><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621679158831"><span class="hs-identifier hs-var">v</span></a></span></span></span><span>
</span><span id="line-262"></span><span id="local-6989586621679158828"><span id="local-6989586621679158829"><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Mu.Adapter.Avro.html#FromAvroUnion"><span class="hs-identifier hs-type">FromAvroUnion</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679158829"><span class="hs-identifier hs-type">sch</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679158828"><span class="hs-identifier hs-type">choices</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-263"></span><span>         </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">A.FromAvro</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">FieldValue</span></span><span> </span><span class="annot"><a href="#local-6989586621679158829"><span class="hs-identifier hs-type">sch</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><span class="hs-identifier hs-type">TUnion</span></span><span> </span><span class="annot"><a href="#local-6989586621679158828"><span class="hs-identifier hs-type">choices</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-264"></span><span>  </span><span id="local-6989586621679158826"><span class="annot"><span class="annottext">fromAvro :: Value -&gt; Either [Char] (FieldValue sch ('TUnion choices))
</span><a href="#local-6989586621679158826"><span class="hs-identifier hs-var hs-var hs-var hs-var">fromAvro</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">AVal.Union</span></span><span> </span><span class="hs-identifier">_</span><span> </span><span id="local-6989586621679158825"><span class="annot"><span class="annottext">i :: Int
</span><a href="#local-6989586621679158825"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span id="local-6989586621679158824"><span class="annot"><span class="annottext">v :: Value
</span><a href="#local-6989586621679158824"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">NS (FieldValue sch) choices -&gt; FieldValue sch ('TUnion choices)
forall typeName fieldName (sch :: Schema typeName fieldName)
       (choices :: [FieldType typeName]).
NS (FieldValue sch) choices -&gt; FieldValue sch ('TUnion choices)
</span><span class="hs-identifier hs-var">FUnion</span></span><span> </span><span class="annot"><span class="annottext">(NS (FieldValue sch) choices -&gt; FieldValue sch ('TUnion choices))
-&gt; Either [Char] (NS (FieldValue sch) choices)
-&gt; Either [Char] (FieldValue sch ('TUnion choices))
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Value -&gt; Either [Char] (NS (FieldValue sch) choices)
forall typeName fieldName (sch :: Schema typeName fieldName)
       (choices :: [FieldType typeName]).
FromAvroUnion sch choices =&gt;
Int -&gt; Value -&gt; Either [Char] (NS (FieldValue sch) choices)
</span><a href="Mu.Adapter.Avro.html#fromAvroU"><span class="hs-identifier hs-var">fromAvroU</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679158825"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621679158824"><span class="hs-identifier hs-var">v</span></a></span><span>
</span><span id="line-265"></span><span>  </span><span class="annot"><span class="hs-identifier hs-var">fromAvro</span></span><span> </span><span class="hs-identifier">_</span><span>                  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; Either [Char] (FieldValue sch ('TUnion choices))
forall a b. a -&gt; Either a b
</span><span class="hs-identifier hs-var">Left</span></span><span> </span><span class="annot"><span class="hs-string">&quot;expecting union&quot;</span></span></span></span><span>
</span><span id="line-266"></span><span id="local-6989586621679158820"><span id="local-6989586621679158821"><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">A.FromAvro</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">FieldValue</span></span><span> </span><span class="annot"><a href="#local-6989586621679158821"><span class="hs-identifier hs-type">sch</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679158820"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-267"></span><span>         </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">A.FromAvro</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">FieldValue</span></span><span> </span><span class="annot"><a href="#local-6989586621679158821"><span class="hs-identifier hs-type">sch</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><span class="hs-identifier hs-type">TOption</span></span><span> </span><span class="annot"><a href="#local-6989586621679158820"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-268"></span><span>  </span><span id="local-6989586621679158818"><span class="annot"><span class="annottext">fromAvro :: Value -&gt; Either [Char] (FieldValue sch ('TOption t))
</span><a href="#local-6989586621679158818"><span class="hs-identifier hs-var hs-var hs-var hs-var">fromAvro</span></a></span></span><span> </span><span id="local-6989586621679158817"><span class="annot"><span class="annottext">v :: Value
</span><a href="#local-6989586621679158817"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe (FieldValue sch t) -&gt; FieldValue sch ('TOption t)
forall typeName fieldName (sch :: Schema typeName fieldName)
       (t1 :: FieldType typeName).
Maybe (FieldValue sch t1) -&gt; FieldValue sch ('TOption t1)
</span><span class="hs-identifier hs-var">FOption</span></span><span> </span><span class="annot"><span class="annottext">(Maybe (FieldValue sch t) -&gt; FieldValue sch ('TOption t))
-&gt; Either [Char] (Maybe (FieldValue sch t))
-&gt; Either [Char] (FieldValue sch ('TOption t))
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Value -&gt; Either [Char] (Maybe (FieldValue sch t))
forall a. FromAvro a =&gt; Value -&gt; Either [Char] a
</span><span class="hs-identifier hs-var">AVal.fromAvro</span></span><span> </span><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621679158817"><span class="hs-identifier hs-var">v</span></a></span></span></span><span>
</span><span id="line-269"></span><span id="local-6989586621679158814"><span id="local-6989586621679158815"><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">A.FromAvro</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">FieldValue</span></span><span> </span><span class="annot"><a href="#local-6989586621679158815"><span class="hs-identifier hs-type">sch</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679158814"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-270"></span><span>         </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">A.FromAvro</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">FieldValue</span></span><span> </span><span class="annot"><a href="#local-6989586621679158815"><span class="hs-identifier hs-type">sch</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><span class="hs-identifier hs-type">TList</span></span><span> </span><span class="annot"><a href="#local-6989586621679158814"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-271"></span><span>  </span><span id="local-6989586621679158812"><span class="annot"><span class="annottext">fromAvro :: Value -&gt; Either [Char] (FieldValue sch ('TList t))
</span><a href="#local-6989586621679158812"><span class="hs-identifier hs-var hs-var hs-var hs-var">fromAvro</span></a></span></span><span> </span><span id="local-6989586621679158811"><span class="annot"><span class="annottext">v :: Value
</span><a href="#local-6989586621679158811"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[FieldValue sch t] -&gt; FieldValue sch ('TList t)
forall typeName fieldName (sch :: Schema typeName fieldName)
       (t1 :: FieldType typeName).
[FieldValue sch t1] -&gt; FieldValue sch ('TList t1)
</span><span class="hs-identifier hs-var">FList</span></span><span> </span><span class="annot"><span class="annottext">([FieldValue sch t] -&gt; FieldValue sch ('TList t))
-&gt; Either [Char] [FieldValue sch t]
-&gt; Either [Char] (FieldValue sch ('TList t))
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Value -&gt; Either [Char] [FieldValue sch t]
forall a. FromAvro a =&gt; Value -&gt; Either [Char] a
</span><span class="hs-identifier hs-var">AVal.fromAvro</span></span><span> </span><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621679158811"><span class="hs-identifier hs-var">v</span></a></span></span></span><span>
</span><span id="line-272"></span><span class="hs-comment">-- These are the only two versions of Map supported by the library</span><span>
</span><span id="line-273"></span><span id="local-6989586621679158808"><span id="local-6989586621679158809"><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">A.FromAvro</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">FieldValue</span></span><span> </span><span class="annot"><a href="#local-6989586621679158809"><span class="hs-identifier hs-type">sch</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679158808"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-274"></span><span>         </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">A.FromAvro</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">FieldValue</span></span><span> </span><span class="annot"><a href="#local-6989586621679158809"><span class="hs-identifier hs-type">sch</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><span class="hs-identifier hs-type">TMap</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><span class="hs-identifier hs-type">TPrimitive</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">T.Text</span></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679158808"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-275"></span><span>  </span><span id="local-6989586621679158806"><span class="annot"><span class="annottext">fromAvro :: Value
-&gt; Either [Char] (FieldValue sch ('TMap ('TPrimitive Text) v))
</span><a href="#local-6989586621679158806"><span class="hs-identifier hs-var hs-var hs-var hs-var">fromAvro</span></a></span></span><span> </span><span id="local-6989586621679158805"><span class="annot"><span class="annottext">v :: Value
</span><a href="#local-6989586621679158805"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Map (FieldValue sch ('TPrimitive Text)) (FieldValue sch v)
-&gt; FieldValue sch ('TMap ('TPrimitive Text) v)
forall typeName fieldName (sch :: Schema typeName fieldName)
       (k :: FieldType typeName) (v :: FieldType typeName).
Ord (FieldValue sch k) =&gt;
Map (FieldValue sch k) (FieldValue sch v)
-&gt; FieldValue sch ('TMap k v)
</span><span class="hs-identifier hs-var">FMap</span></span><span> </span><span class="annot"><span class="annottext">(Map (FieldValue sch ('TPrimitive Text)) (FieldValue sch v)
 -&gt; FieldValue sch ('TMap ('TPrimitive Text) v))
-&gt; (Map Text (FieldValue sch v)
    -&gt; Map (FieldValue sch ('TPrimitive Text)) (FieldValue sch v))
-&gt; Map Text (FieldValue sch v)
-&gt; FieldValue sch ('TMap ('TPrimitive Text) v)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(Text -&gt; FieldValue sch ('TPrimitive Text))
-&gt; Map Text (FieldValue sch v)
-&gt; Map (FieldValue sch ('TPrimitive Text)) (FieldValue sch v)
forall k2 k1 a. Ord k2 =&gt; (k1 -&gt; k2) -&gt; Map k1 a -&gt; Map k2 a
</span><span class="hs-identifier hs-var">M.mapKeys</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; FieldValue sch ('TPrimitive Text)
forall typeName fieldName t1 (sch :: Schema typeName fieldName).
t1 -&gt; FieldValue sch ('TPrimitive t1)
</span><span class="hs-identifier hs-var">FPrimitive</span></span><span> </span><span class="annot"><span class="annottext">(Map Text (FieldValue sch v)
 -&gt; FieldValue sch ('TMap ('TPrimitive Text) v))
-&gt; Either [Char] (Map Text (FieldValue sch v))
-&gt; Either [Char] (FieldValue sch ('TMap ('TPrimitive Text) v))
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Value -&gt; Either [Char] (Map Text (FieldValue sch v))
forall a. FromAvro a =&gt; Value -&gt; Either [Char] a
</span><span class="hs-identifier hs-var">AVal.fromAvro</span></span><span> </span><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621679158805"><span class="hs-identifier hs-var">v</span></a></span></span></span><span>
</span><span id="line-276"></span><span id="local-6989586621679158801"><span id="local-6989586621679158802"><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">A.FromAvro</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">FieldValue</span></span><span> </span><span class="annot"><a href="#local-6989586621679158802"><span class="hs-identifier hs-type">sch</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679158801"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-277"></span><span>         </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">A.FromAvro</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">FieldValue</span></span><span> </span><span class="annot"><a href="#local-6989586621679158802"><span class="hs-identifier hs-type">sch</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><span class="hs-identifier hs-type">TMap</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><span class="hs-identifier hs-type">TPrimitive</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679158801"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-278"></span><span>  </span><span id="local-6989586621679158799"><span class="annot"><span class="annottext">fromAvro :: Value
-&gt; Either [Char] (FieldValue sch ('TMap ('TPrimitive [Char]) v))
</span><a href="#local-6989586621679158799"><span class="hs-identifier hs-var hs-var hs-var hs-var">fromAvro</span></a></span></span><span> </span><span id="local-6989586621679158798"><span class="annot"><span class="annottext">v :: Value
</span><a href="#local-6989586621679158798"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Map (FieldValue sch ('TPrimitive [Char])) (FieldValue sch v)
-&gt; FieldValue sch ('TMap ('TPrimitive [Char]) v)
forall typeName fieldName (sch :: Schema typeName fieldName)
       (k :: FieldType typeName) (v :: FieldType typeName).
Ord (FieldValue sch k) =&gt;
Map (FieldValue sch k) (FieldValue sch v)
-&gt; FieldValue sch ('TMap k v)
</span><span class="hs-identifier hs-var">FMap</span></span><span> </span><span class="annot"><span class="annottext">(Map (FieldValue sch ('TPrimitive [Char])) (FieldValue sch v)
 -&gt; FieldValue sch ('TMap ('TPrimitive [Char]) v))
-&gt; (Map Text (FieldValue sch v)
    -&gt; Map (FieldValue sch ('TPrimitive [Char])) (FieldValue sch v))
-&gt; Map Text (FieldValue sch v)
-&gt; FieldValue sch ('TMap ('TPrimitive [Char]) v)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(Text -&gt; FieldValue sch ('TPrimitive [Char]))
-&gt; Map Text (FieldValue sch v)
-&gt; Map (FieldValue sch ('TPrimitive [Char])) (FieldValue sch v)
forall k2 k1 a. Ord k2 =&gt; (k1 -&gt; k2) -&gt; Map k1 a -&gt; Map k2 a
</span><span class="hs-identifier hs-var">M.mapKeys</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Char] -&gt; FieldValue sch ('TPrimitive [Char])
forall typeName fieldName t1 (sch :: Schema typeName fieldName).
t1 -&gt; FieldValue sch ('TPrimitive t1)
</span><span class="hs-identifier hs-var">FPrimitive</span></span><span> </span><span class="annot"><span class="annottext">([Char] -&gt; FieldValue sch ('TPrimitive [Char]))
-&gt; (Text -&gt; [Char]) -&gt; Text -&gt; FieldValue sch ('TPrimitive [Char])
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; [Char]
</span><span class="hs-identifier hs-var">T.unpack</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Map Text (FieldValue sch v)
 -&gt; FieldValue sch ('TMap ('TPrimitive [Char]) v))
-&gt; Either [Char] (Map Text (FieldValue sch v))
-&gt; Either [Char] (FieldValue sch ('TMap ('TPrimitive [Char]) v))
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Value -&gt; Either [Char] (Map Text (FieldValue sch v))
forall a. FromAvro a =&gt; Value -&gt; Either [Char] a
</span><span class="hs-identifier hs-var">AVal.fromAvro</span></span><span> </span><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621679158798"><span class="hs-identifier hs-var">v</span></a></span></span></span><span>
</span><span id="line-279"></span><span>
</span><span id="line-280"></span><span class="hs-keyword">class</span><span> </span><span id="FromAvroEnum"><span class="annot"><a href="Mu.Adapter.Avro.html#FromAvroEnum"><span class="hs-identifier hs-var">FromAvroEnum</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679159360"><span class="annot"><a href="#local-6989586621679159360"><span class="hs-identifier hs-type">vs</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">ChoiceDef</span></span><span> </span><span id="local-6989586621679159361"><span class="annot"><a href="#local-6989586621679159361"><span class="hs-identifier hs-type hs-type">fn</span></a></span></span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-281"></span><span>  </span><span id="fromAvroEnum"><span class="annot"><a href="Mu.Adapter.Avro.html#fromAvroEnum"><span class="hs-identifier hs-type">fromAvroEnum</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">T.Text</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Either</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">NS</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Proxy</span></span><span> </span><span class="annot"><a href="#local-6989586621679159360"><span class="hs-identifier hs-type">vs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-282"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Mu.Adapter.Avro.html#FromAvroEnum"><span class="hs-identifier hs-type">FromAvroEnum</span></a></span><span> </span><span class="hs-special">'</span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-283"></span><span>  </span><span id="local-6989586621679158794"><span class="annot"><span class="annottext">fromAvroEnum :: Text -&gt; Either [Char] (NS Proxy '[])
</span><a href="#local-6989586621679158794"><span class="hs-identifier hs-var hs-var hs-var hs-var">fromAvroEnum</span></a></span></span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; Either [Char] (NS Proxy '[])
forall a b. a -&gt; Either a b
</span><span class="hs-identifier hs-var">Left</span></span><span> </span><span class="annot"><span class="hs-string">&quot;enum choice not found&quot;</span></span><span>
</span><span id="line-284"></span><span id="local-6989586621679158792"><span id="local-6989586621679158793"><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">KnownName</span></span><span> </span><span class="annot"><a href="#local-6989586621679158793"><span class="hs-identifier hs-type">name</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Mu.Adapter.Avro.html#FromAvroEnum"><span class="hs-identifier hs-type">FromAvroEnum</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679158792"><span class="hs-identifier hs-type">vs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-285"></span><span>         </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Mu.Adapter.Avro.html#FromAvroEnum"><span class="hs-identifier hs-type">FromAvroEnum</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><span class="hs-identifier hs-type">ChoiceDef</span></span><span> </span><span class="annot"><a href="#local-6989586621679158793"><span class="hs-identifier hs-type">name</span></a></span><span> </span><span class="hs-special">'</span><span class="hs-glyph">:</span><span> </span><span class="annot"><a href="#local-6989586621679158792"><span class="hs-identifier hs-type">vs</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-286"></span><span>  </span><span id="local-6989586621679158790"><span class="annot"><span class="annottext">fromAvroEnum :: Text -&gt; Either [Char] (NS Proxy ('ChoiceDef name : vs))
</span><a href="#local-6989586621679158790"><span class="hs-identifier hs-var hs-var hs-var hs-var">fromAvroEnum</span></a></span></span><span> </span><span id="local-6989586621679158789"><span class="annot"><span class="annottext">s :: Text
</span><a href="#local-6989586621679158789"><span class="hs-identifier hs-var">s</span></a></span></span><span>
</span><span id="line-287"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679158789"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679158788"><span class="hs-identifier hs-var">fieldName</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">NS Proxy ('ChoiceDef name : vs)
-&gt; Either [Char] (NS Proxy ('ChoiceDef name : vs))
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">(NS Proxy ('ChoiceDef name : vs)
 -&gt; Either [Char] (NS Proxy ('ChoiceDef name : vs)))
-&gt; NS Proxy ('ChoiceDef name : vs)
-&gt; Either [Char] (NS Proxy ('ChoiceDef name : vs))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Proxy ('ChoiceDef name) -&gt; NS Proxy ('ChoiceDef name : vs)
forall k (a :: k -&gt; *) (x :: k) (xs :: [k]). a x -&gt; NS a (x : xs)
</span><span class="hs-identifier hs-var">Z</span></span><span> </span><span class="annot"><span class="annottext">Proxy ('ChoiceDef name)
forall k (t :: k). Proxy t
</span><span class="hs-identifier hs-var">Proxy</span></span><span>
</span><span id="line-288"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">NS Proxy vs -&gt; NS Proxy ('ChoiceDef name : vs)
forall k (a :: k -&gt; *) (xs :: [k]) (x :: k).
NS a xs -&gt; NS a (x : xs)
</span><span class="hs-identifier hs-var">S</span></span><span> </span><span class="annot"><span class="annottext">(NS Proxy vs -&gt; NS Proxy ('ChoiceDef name : vs))
-&gt; Either [Char] (NS Proxy vs)
-&gt; Either [Char] (NS Proxy ('ChoiceDef name : vs))
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Either [Char] (NS Proxy vs)
forall fn (vs :: [ChoiceDef fn]).
FromAvroEnum vs =&gt;
Text -&gt; Either [Char] (NS Proxy vs)
</span><a href="Mu.Adapter.Avro.html#fromAvroEnum"><span class="hs-identifier hs-var">fromAvroEnum</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679158789"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-289"></span><span>    </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621679158788"><span class="annot"><span class="annottext">fieldName :: Text
</span><a href="#local-6989586621679158788"><span class="hs-identifier hs-var hs-var">fieldName</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Proxy name -&gt; Text
forall k (s :: k) (proxy :: k -&gt; *). KnownName s =&gt; proxy s -&gt; Text
</span><a href="Mu.Adapter.Avro.html#nameText"><span class="hs-identifier hs-var">nameText</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Proxy name
forall k (t :: k). Proxy t
</span><span class="hs-identifier hs-var">Proxy</span></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621679158793"><span class="hs-identifier hs-type">name</span></a></span><span class="hs-special">)</span></span></span><span>
</span><span id="line-290"></span><span>
</span><span id="line-291"></span><span class="hs-keyword">class</span><span> </span><span id="FromAvroUnion"><span class="annot"><a href="Mu.Adapter.Avro.html#FromAvroUnion"><span class="hs-identifier hs-var">FromAvroUnion</span></a></span></span><span> </span><span id="local-6989586621679159328"><span class="annot"><a href="#local-6989586621679159328"><span class="hs-identifier hs-type">sch</span></a></span></span><span> </span><span id="local-6989586621679159327"><span class="annot"><a href="#local-6989586621679159327"><span class="hs-identifier hs-type">choices</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-292"></span><span>  </span><span id="fromAvroU"><span class="annot"><a href="Mu.Adapter.Avro.html#fromAvroU"><span class="hs-identifier hs-type">fromAvroU</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">AVal.Value</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Either</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">NS</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">FieldValue</span></span><span> </span><span class="annot"><a href="#local-6989586621679159328"><span class="hs-identifier hs-type">sch</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679159327"><span class="hs-identifier hs-type">choices</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-293"></span><span id="local-6989586621679158785"><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Mu.Adapter.Avro.html#FromAvroUnion"><span class="hs-identifier hs-type">FromAvroUnion</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679158785"><span class="hs-identifier hs-type">sch</span></a></span><span> </span><span class="hs-special">'</span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-294"></span><span>  </span><span id="local-6989586621679158782"><span class="annot"><span class="annottext">fromAvroU :: Int -&gt; Value -&gt; Either [Char] (NS (FieldValue sch) '[])
</span><a href="#local-6989586621679158782"><span class="hs-identifier hs-var hs-var hs-var hs-var">fromAvroU</span></a></span></span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; Either [Char] (NS (FieldValue sch) '[])
forall a b. a -&gt; Either a b
</span><span class="hs-identifier hs-var">Left</span></span><span> </span><span class="annot"><span class="hs-string">&quot;union choice not found&quot;</span></span></span><span>
</span><span id="line-295"></span><span id="local-6989586621679158779"><span id="local-6989586621679158780"><span id="local-6989586621679158781"><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">A.FromAvro</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">FieldValue</span></span><span> </span><span class="annot"><a href="#local-6989586621679158781"><span class="hs-identifier hs-type">sch</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679158780"><span class="hs-identifier hs-type">u</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Mu.Adapter.Avro.html#FromAvroUnion"><span class="hs-identifier hs-type">FromAvroUnion</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679158781"><span class="hs-identifier hs-type">sch</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679158779"><span class="hs-identifier hs-type">us</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-296"></span><span>         </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Mu.Adapter.Avro.html#FromAvroUnion"><span class="hs-identifier hs-type">FromAvroUnion</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679158781"><span class="hs-identifier hs-type">sch</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679158780"><span class="hs-identifier hs-type">u</span></a></span><span> </span><span class="hs-special">'</span><span class="hs-glyph">:</span><span> </span><span class="annot"><a href="#local-6989586621679158779"><span class="hs-identifier hs-type">us</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-297"></span><span>  </span><span id="local-6989586621679158777"><span class="annot"><span class="annottext">fromAvroU :: Int -&gt; Value -&gt; Either [Char] (NS (FieldValue sch) (u : us))
</span><a href="#local-6989586621679158777"><span class="hs-identifier hs-var hs-var hs-var hs-var">fromAvroU</span></a></span></span><span> </span><span class="hs-number">0</span><span> </span><span id="local-6989586621679158776"><span class="annot"><span class="annottext">v :: Value
</span><a href="#local-6989586621679158776"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FieldValue sch u -&gt; NS (FieldValue sch) (u : us)
forall k (a :: k -&gt; *) (x :: k) (xs :: [k]). a x -&gt; NS a (x : xs)
</span><span class="hs-identifier hs-var">Z</span></span><span> </span><span class="annot"><span class="annottext">(FieldValue sch u -&gt; NS (FieldValue sch) (u : us))
-&gt; Either [Char] (FieldValue sch u)
-&gt; Either [Char] (NS (FieldValue sch) (u : us))
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Value -&gt; Either [Char] (FieldValue sch u)
forall a. FromAvro a =&gt; Value -&gt; Either [Char] a
</span><span class="hs-identifier hs-var">AVal.fromAvro</span></span><span> </span><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621679158776"><span class="hs-identifier hs-var">v</span></a></span><span>
</span><span id="line-298"></span><span>  </span><span class="annot"><a href="Mu.Adapter.Avro.html#fromAvroU"><span class="hs-identifier hs-var">fromAvroU</span></a></span><span> </span><span id="local-6989586621679158775"><span class="annot"><span class="annottext">n :: Int
</span><a href="#local-6989586621679158775"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621679158774"><span class="annot"><span class="annottext">v :: Value
</span><a href="#local-6989586621679158774"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">NS (FieldValue sch) us -&gt; NS (FieldValue sch) (u : us)
forall k (a :: k -&gt; *) (xs :: [k]) (x :: k).
NS a xs -&gt; NS a (x : xs)
</span><span class="hs-identifier hs-var">S</span></span><span> </span><span class="annot"><span class="annottext">(NS (FieldValue sch) us -&gt; NS (FieldValue sch) (u : us))
-&gt; Either [Char] (NS (FieldValue sch) us)
-&gt; Either [Char] (NS (FieldValue sch) (u : us))
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Value -&gt; Either [Char] (NS (FieldValue sch) us)
forall typeName fieldName (sch :: Schema typeName fieldName)
       (choices :: [FieldType typeName]).
FromAvroUnion sch choices =&gt;
Int -&gt; Value -&gt; Either [Char] (NS (FieldValue sch) choices)
</span><a href="Mu.Adapter.Avro.html#fromAvroU"><span class="hs-identifier hs-var">fromAvroU</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679158775"><span class="hs-identifier hs-var">n</span></a></span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span class="annot"><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621679158774"><span class="hs-identifier hs-var">v</span></a></span></span></span></span><span>
</span><span id="line-299"></span><span>
</span><span id="line-300"></span><span class="hs-keyword">class</span><span> </span><span id="FromAvroFields"><span class="annot"><a href="Mu.Adapter.Avro.html#FromAvroFields"><span class="hs-identifier hs-var">FromAvroFields</span></a></span></span><span> </span><span id="local-6989586621679159377"><span class="annot"><a href="#local-6989586621679159377"><span class="hs-identifier hs-type">sch</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679159376"><span class="annot"><a href="#local-6989586621679159376"><span class="hs-identifier hs-type">fs</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">FieldDef</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Symbol</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Symbol</span></span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-301"></span><span>  </span><span id="fromAvroF"><span class="annot"><a href="Mu.Adapter.Avro.html#fromAvroF"><span class="hs-identifier hs-type">fromAvroF</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">HM.HashMap</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">T.Text</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">AVal.Value</span></span><span>
</span><span id="line-302"></span><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Either</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">NP</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Field</span></span><span> </span><span class="annot"><a href="#local-6989586621679159377"><span class="hs-identifier hs-type">sch</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679159376"><span class="hs-identifier hs-type">fs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-303"></span><span id="local-6989586621679158773"><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Mu.Adapter.Avro.html#FromAvroFields"><span class="hs-identifier hs-type">FromAvroFields</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679158773"><span class="hs-identifier hs-type">sch</span></a></span><span> </span><span class="hs-special">'</span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-304"></span><span>  </span><span id="local-6989586621679158770"><span class="annot"><span class="annottext">fromAvroF :: HashMap Text Value -&gt; Either [Char] (NP (Field sch) '[])
</span><a href="#local-6989586621679158770"><span class="hs-identifier hs-var hs-var hs-var hs-var">fromAvroF</span></a></span></span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">NP (Field sch) '[] -&gt; Either [Char] (NP (Field sch) '[])
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">NP (Field sch) '[]
forall k (a :: k -&gt; *). NP a '[]
</span><span class="hs-identifier hs-var">Nil</span></span></span><span>
</span><span id="line-305"></span><span id="local-6989586621679158765"><span id="local-6989586621679158766"><span id="local-6989586621679158767"><span id="local-6989586621679158768"><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">KnownName</span></span><span> </span><span class="annot"><a href="#local-6989586621679158768"><span class="hs-identifier hs-type">name</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">A.FromAvro</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">FieldValue</span></span><span> </span><span class="annot"><a href="#local-6989586621679158767"><span class="hs-identifier hs-type">sch</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679158766"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Mu.Adapter.Avro.html#FromAvroFields"><span class="hs-identifier hs-type">FromAvroFields</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679158767"><span class="hs-identifier hs-type">sch</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679158765"><span class="hs-identifier hs-type">fs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-306"></span><span>         </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Mu.Adapter.Avro.html#FromAvroFields"><span class="hs-identifier hs-type">FromAvroFields</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679158767"><span class="hs-identifier hs-type">sch</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><span class="hs-identifier hs-type">FieldDef</span></span><span> </span><span class="annot"><a href="#local-6989586621679158768"><span class="hs-identifier hs-type">name</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679158766"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="hs-special">'</span><span class="hs-glyph">:</span><span> </span><span class="annot"><a href="#local-6989586621679158765"><span class="hs-identifier hs-type">fs</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-307"></span><span>  </span><span id="local-6989586621679158763"><span class="annot"><span class="annottext">fromAvroF :: HashMap Text Value
-&gt; Either [Char] (NP (Field sch) ('FieldDef name t : fs))
</span><a href="#local-6989586621679158763"><span class="hs-identifier hs-var hs-var hs-var hs-var">fromAvroF</span></a></span></span><span> </span><span id="local-6989586621679158762"><span class="annot"><span class="annottext">v :: HashMap Text Value
</span><a href="#local-6989586621679158762"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Text -&gt; HashMap Text Value -&gt; Maybe Value
forall k v. (Eq k, Hashable k) =&gt; k -&gt; HashMap k v -&gt; Maybe v
</span><span class="hs-identifier hs-var">HM.lookup</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679158760"><span class="hs-identifier hs-var">fieldName</span></a></span><span> </span><span class="annot"><span class="annottext">HashMap Text Value
</span><a href="#local-6989586621679158762"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-308"></span><span>                  </span><span class="annot"><span class="hs-identifier hs-type">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; Either [Char] (NP (Field sch) ('FieldDef name t : fs))
forall a b. a -&gt; Either a b
</span><span class="hs-identifier hs-var">Left</span></span><span> </span><span class="annot"><span class="hs-string">&quot;field not found&quot;</span></span><span>
</span><span id="line-309"></span><span>                  </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679158759"><span class="annot"><span class="annottext">f :: Value
</span><a href="#local-6989586621679158759"><span class="hs-identifier hs-var">f</span></a></span></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Field sch ('FieldDef name t)
-&gt; NP (Field sch) fs -&gt; NP (Field sch) ('FieldDef name t : fs)
forall k (a :: k -&gt; *) (x :: k) (xs :: [k]).
a x -&gt; NP a xs -&gt; NP a (x : xs)
</span><span class="hs-operator hs-var">(:*)</span></span><span> </span><span class="annot"><span class="annottext">(Field sch ('FieldDef name t)
 -&gt; NP (Field sch) fs -&gt; NP (Field sch) ('FieldDef name t : fs))
-&gt; Either [Char] (Field sch ('FieldDef name t))
-&gt; Either
     [Char]
     (NP (Field sch) fs -&gt; NP (Field sch) ('FieldDef name t : fs))
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FieldValue sch t -&gt; Field sch ('FieldDef name t)
forall typeName fieldName (sch :: Schema typeName fieldName)
       (t :: FieldType typeName) (name :: fieldName).
FieldValue sch t -&gt; Field sch ('FieldDef name t)
</span><span class="hs-identifier hs-var">Field</span></span><span> </span><span class="annot"><span class="annottext">(FieldValue sch t -&gt; Field sch ('FieldDef name t))
-&gt; Either [Char] (FieldValue sch t)
-&gt; Either [Char] (Field sch ('FieldDef name t))
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Value -&gt; Either [Char] (FieldValue sch t)
forall a. FromAvro a =&gt; Value -&gt; Either [Char] a
</span><span class="hs-identifier hs-var">AVal.fromAvro</span></span><span> </span><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621679158759"><span class="hs-identifier hs-var">f</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Either
  [Char]
  (NP (Field sch) fs -&gt; NP (Field sch) ('FieldDef name t : fs))
-&gt; Either [Char] (NP (Field sch) fs)
-&gt; Either [Char] (NP (Field sch) ('FieldDef name t : fs))
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">HashMap Text Value -&gt; Either [Char] (NP (Field sch) fs)
forall (sch :: Schema Symbol Symbol)
       (fs :: [FieldDef Symbol Symbol]).
FromAvroFields sch fs =&gt;
HashMap Text Value -&gt; Either [Char] (NP (Field sch) fs)
</span><a href="Mu.Adapter.Avro.html#fromAvroF"><span class="hs-identifier hs-var">fromAvroF</span></a></span><span> </span><span class="annot"><span class="annottext">HashMap Text Value
</span><a href="#local-6989586621679158762"><span class="hs-identifier hs-var">v</span></a></span><span>
</span><span id="line-310"></span><span>    </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621679158760"><span class="annot"><span class="annottext">fieldName :: Text
</span><a href="#local-6989586621679158760"><span class="hs-identifier hs-var hs-var">fieldName</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Proxy name -&gt; Text
forall k (s :: k) (proxy :: k -&gt; *). KnownName s =&gt; proxy s -&gt; Text
</span><a href="Mu.Adapter.Avro.html#nameText"><span class="hs-identifier hs-var">nameText</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Proxy name
forall k (t :: k). Proxy t
</span><span class="hs-identifier hs-var">Proxy</span></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621679158768"><span class="hs-identifier hs-type">name</span></a></span><span class="hs-special">)</span></span></span></span></span><span>
</span><span id="line-311"></span><span>
</span><span id="line-312"></span><span class="hs-comment">-- ToAvro instances</span><span>
</span><span id="line-313"></span><span>
</span><span id="line-314"></span><span id="local-6989586621679158754"><span id="local-6989586621679158755"><span id="local-6989586621679158756"><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">KnownName</span></span><span> </span><span class="annot"><a href="#local-6989586621679158756"><span class="hs-identifier hs-type">name</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Mu.Adapter.Avro.html#ToAvroFields"><span class="hs-identifier hs-type">ToAvroFields</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679158755"><span class="hs-identifier hs-type">sch</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679158754"><span class="hs-identifier hs-type">args</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Mu.Adapter.Avro.html#HasAvroSchemaFields"><span class="hs-identifier hs-type">HasAvroSchemaFields</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679158755"><span class="hs-identifier hs-type">sch</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679158754"><span class="hs-identifier hs-type">args</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-315"></span><span>         </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">A.ToAvro</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Term</span></span><span> </span><span class="annot"><a href="#local-6989586621679158755"><span class="hs-identifier hs-type">sch</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><span class="hs-identifier hs-type">DRecord</span></span><span> </span><span class="annot"><a href="#local-6989586621679158756"><span class="hs-identifier hs-type">name</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679158754"><span class="hs-identifier hs-type">args</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-316"></span><span>  </span><span id="local-6989586621679158752"><span class="annot"><span class="annottext">toAvro :: Schema -&gt; Term sch ('DRecord name args) -&gt; Builder
</span><a href="#local-6989586621679158752"><span class="hs-identifier hs-var hs-var hs-var hs-var">toAvro</span></a></span></span><span> </span><span id="local-6989586621679158751"><span class="annot"><span class="annottext">s :: Schema
</span><a href="#local-6989586621679158751"><span class="hs-identifier hs-var">s</span></a></span></span><span class="hs-glyph">@</span><span class="annot"><span class="hs-identifier hs-type">ASch.Record</span></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">TRecord</span></span><span> </span><span id="local-6989586621679158750"><span class="annot"><span class="annottext">fields :: NP (Field sch) args
</span><a href="#local-6989586621679158750"><span class="hs-identifier hs-var">fields</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-317"></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Schema -&gt; [(Text, Encoder)] -&gt; Builder
</span><span class="hs-identifier hs-var">A.record</span></span><span> </span><span class="annot"><span class="annottext">Schema
</span><a href="#local-6989586621679158751"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="annot"><span class="annottext">([(Text, Encoder)] -&gt; Builder) -&gt; [(Text, Encoder)] -&gt; Builder
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">NP (Field sch) args -&gt; [(Text, Encoder)]
forall (sch :: Schema Symbol Symbol)
       (fs :: [FieldDef Symbol Symbol]).
ToAvroFields sch fs =&gt;
NP (Field sch) fs -&gt; [(Text, Encoder)]
</span><a href="Mu.Adapter.Avro.html#toAvroF"><span class="hs-identifier hs-var">toAvroF</span></a></span><span> </span><span class="annot"><span class="annottext">NP (Field sch) args
</span><a href="#local-6989586621679158750"><span class="hs-identifier hs-var">fields</span></a></span><span>
</span><span id="line-318"></span><span>  </span><span class="hs-comment">-- if we don't have a record, fall back to the one from schema</span><span>
</span><span id="line-319"></span><span>  </span><span class="annot"><span class="hs-identifier hs-var">toAvro</span></span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">TRecord</span></span><span> </span><span id="local-6989586621679158747"><span class="annot"><span class="annottext">fields :: NP (Field sch) args
</span><a href="#local-6989586621679158747"><span class="hs-identifier hs-var">fields</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-320"></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Schema -&gt; [(Text, Encoder)] -&gt; Builder
</span><span class="hs-identifier hs-var">A.record</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Tagged (Term sch ('DRecord name args)) Schema -&gt; Schema
forall k (s :: k) b. Tagged s b -&gt; b
</span><span class="hs-identifier hs-var hs-var">unTagged</span></span><span> </span><span class="annot"><span class="annottext">(Tagged (Term sch ('DRecord name args)) Schema -&gt; Schema)
-&gt; Tagged (Term sch ('DRecord name args)) Schema -&gt; Schema
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[TypeName] -&gt; Tagged (Term sch ('DRecord name args)) Schema
forall k (x :: k).
HasAvroSchema' x =&gt;
[TypeName] -&gt; Tagged x Schema
</span><a href="Mu.Adapter.Avro.html#schema%27"><span class="hs-identifier hs-var">schema'</span></a></span><span> </span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Term</span></span><span> </span><span class="annot"><a href="#local-6989586621679158755"><span class="hs-identifier hs-type">sch</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><span class="hs-identifier hs-type">DRecord</span></span><span> </span><span class="annot"><a href="#local-6989586621679158756"><span class="hs-identifier hs-type">name</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679158754"><span class="hs-identifier hs-type">args</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">([(Text, Encoder)] -&gt; Builder) -&gt; [(Text, Encoder)] -&gt; Builder
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">NP (Field sch) args -&gt; [(Text, Encoder)]
forall (sch :: Schema Symbol Symbol)
       (fs :: [FieldDef Symbol Symbol]).
ToAvroFields sch fs =&gt;
NP (Field sch) fs -&gt; [(Text, Encoder)]
</span><a href="Mu.Adapter.Avro.html#toAvroF"><span class="hs-identifier hs-var">toAvroF</span></a></span><span> </span><span class="annot"><span class="annottext">NP (Field sch) args
</span><a href="#local-6989586621679158747"><span class="hs-identifier hs-var">fields</span></a></span></span></span></span><span>
</span><span id="line-321"></span><span id="local-6989586621679158744"><span id="local-6989586621679158745"><span id="local-6989586621679158746"><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">KnownName</span></span><span> </span><span class="annot"><a href="#local-6989586621679158746"><span class="hs-identifier hs-type">name</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Mu.Adapter.Avro.html#ToAvroEnum"><span class="hs-identifier hs-type">ToAvroEnum</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679158745"><span class="hs-identifier hs-type">choices</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Mu.Adapter.Avro.html#HasAvroSchemaEnum"><span class="hs-identifier hs-type">HasAvroSchemaEnum</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679158745"><span class="hs-identifier hs-type">choices</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-322"></span><span>          </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">A.ToAvro</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Term</span></span><span> </span><span class="annot"><a href="#local-6989586621679158744"><span class="hs-identifier hs-type">sch</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><span class="hs-identifier hs-type">DEnum</span></span><span> </span><span class="annot"><a href="#local-6989586621679158746"><span class="hs-identifier hs-type">name</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679158745"><span class="hs-identifier hs-type">choices</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-323"></span><span>  </span><span id="local-6989586621679158742"><span class="annot"><span class="annottext">toAvro :: Schema -&gt; Term sch ('DEnum name choices) -&gt; Builder
</span><a href="#local-6989586621679158742"><span class="hs-identifier hs-var hs-var hs-var hs-var">toAvro</span></a></span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">ASch.Enum</span></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">symbols :: Schema -&gt; Vector Text
</span><span class="hs-identifier hs-var">ASch.symbols</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621679158739"><span class="annot"><span class="annottext">Vector Text
</span><a href="#local-6989586621679158739"><span class="hs-identifier hs-var">ss</span></a></span></span><span> </span><span class="hs-special">}</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">TEnum</span></span><span> </span><span id="local-6989586621679158738"><span class="annot"><span class="annottext">n :: NS Proxy choices
</span><a href="#local-6989586621679158738"><span class="hs-identifier hs-var">n</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-324"></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Word8 -&gt; Builder
</span><span class="hs-identifier hs-var">word8</span></span><span> </span><span class="annot"><span class="annottext">(Word8 -&gt; Builder) -&gt; Word8 -&gt; Builder
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Word8
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">(Int -&gt; Word8) -&gt; Int -&gt; Word8
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Vector Text -&gt; NS Proxy choices -&gt; Int
forall k (choices :: [k]).
ToAvroEnum choices =&gt;
Vector Text -&gt; NS Proxy choices -&gt; Int
</span><a href="Mu.Adapter.Avro.html#toAvroE"><span class="hs-identifier hs-var">toAvroE</span></a></span><span> </span><span class="annot"><span class="annottext">Vector Text
</span><a href="#local-6989586621679158739"><span class="hs-identifier hs-var">ss</span></a></span><span> </span><span class="annot"><span class="annottext">NS Proxy choices
</span><a href="#local-6989586621679158738"><span class="hs-identifier hs-var">n</span></a></span><span>
</span><span id="line-325"></span><span>  </span><span class="hs-comment">-- otherwise fall back to the one from schema</span><span>
</span><span id="line-326"></span><span>  </span><span class="annot"><span class="hs-identifier hs-var">toAvro</span></span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">TEnum</span></span><span> </span><span id="local-6989586621679158736"><span class="annot"><span class="annottext">n :: NS Proxy choices
</span><a href="#local-6989586621679158736"><span class="hs-identifier hs-var">n</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-327"></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Word8 -&gt; Builder
</span><span class="hs-identifier hs-var">word8</span></span><span> </span><span class="annot"><span class="annottext">(Word8 -&gt; Builder) -&gt; Word8 -&gt; Builder
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Word8
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">(Int -&gt; Word8) -&gt; Int -&gt; Word8
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Vector Text -&gt; NS Proxy choices -&gt; Int
forall k (choices :: [k]).
ToAvroEnum choices =&gt;
Vector Text -&gt; NS Proxy choices -&gt; Int
</span><a href="Mu.Adapter.Avro.html#toAvroE"><span class="hs-identifier hs-var">toAvroE</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Text] -&gt; Vector Text
forall a. [a] -&gt; Vector a
</span><span class="hs-identifier hs-var">V.fromList</span></span><span> </span><span class="annot"><span class="annottext">([Text] -&gt; Vector Text) -&gt; [Text] -&gt; Vector Text
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Proxy choices -&gt; [Text]
forall fn (fs :: [ChoiceDef fn]).
HasAvroSchemaEnum fs =&gt;
Proxy fs -&gt; [Text]
</span><a href="Mu.Adapter.Avro.html#schemaE"><span class="hs-identifier hs-var">schemaE</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Proxy choices
forall k (t :: k). Proxy t
</span><span class="hs-identifier hs-var">Proxy</span></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621679158745"><span class="hs-identifier hs-type">choices</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">NS Proxy choices
</span><a href="#local-6989586621679158736"><span class="hs-identifier hs-var">n</span></a></span></span></span></span><span>
</span><span id="line-328"></span><span id="local-6989586621679158733"><span id="local-6989586621679158734"><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">A.ToAvro</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">FieldValue</span></span><span> </span><span class="annot"><a href="#local-6989586621679158734"><span class="hs-identifier hs-type">sch</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679158733"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-329"></span><span>         </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">A.ToAvro</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Term</span></span><span> </span><span class="annot"><a href="#local-6989586621679158734"><span class="hs-identifier hs-type">sch</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><span class="hs-identifier hs-type">DSimple</span></span><span> </span><span class="annot"><a href="#local-6989586621679158733"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-330"></span><span>  </span><span id="local-6989586621679158731"><span class="annot"><span class="annottext">toAvro :: Schema -&gt; Term sch ('DSimple t) -&gt; Builder
</span><a href="#local-6989586621679158731"><span class="hs-identifier hs-var hs-var hs-var hs-var">toAvro</span></a></span></span><span> </span><span id="local-6989586621679158730"><span class="annot"><span class="annottext">s :: Schema
</span><a href="#local-6989586621679158730"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">TSimple</span></span><span> </span><span id="local-6989586621679158729"><span class="annot"><span class="annottext">v :: FieldValue sch t1
</span><a href="#local-6989586621679158729"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Schema -&gt; FieldValue sch t1 -&gt; Builder
forall a. ToAvro a =&gt; Schema -&gt; a -&gt; Builder
</span><span class="hs-identifier hs-var">A.toAvro</span></span><span> </span><span class="annot"><span class="annottext">Schema
</span><a href="#local-6989586621679158730"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="annot"><span class="annottext">FieldValue sch t1
</span><a href="#local-6989586621679158729"><span class="hs-identifier hs-var">v</span></a></span></span></span><span>
</span><span id="line-331"></span><span>
</span><span id="line-332"></span><span id="local-6989586621679158728"><span class="hs-keyword">instance</span><span> </span><span class="annot"><span class="hs-identifier hs-type">A.ToAvro</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">FieldValue</span></span><span> </span><span class="annot"><a href="#local-6989586621679158728"><span class="hs-identifier hs-type">sch</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><span class="hs-identifier hs-type">TNull</span></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-333"></span><span>  </span><span id="local-6989586621679158726"><span class="annot"><span class="annottext">toAvro :: Schema -&gt; FieldValue sch 'TNull -&gt; Builder
</span><a href="#local-6989586621679158726"><span class="hs-identifier hs-var hs-var hs-var hs-var">toAvro</span></a></span></span><span> </span><span class="hs-identifier">_</span><span> </span><span class="annot"><span class="hs-identifier hs-type">FNull</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Builder
forall a. Monoid a =&gt; a
</span><span class="hs-identifier hs-var">mempty</span></span></span><span>
</span><span id="line-334"></span><span id="local-6989586621679158724"><span id="local-6989586621679158725"><span class="hs-keyword">instance</span><span> </span><span class="annot"><span class="hs-identifier hs-type">A.ToAvro</span></span><span> </span><span class="annot"><a href="#local-6989586621679158725"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">A.ToAvro</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">FieldValue</span></span><span> </span><span class="annot"><a href="#local-6989586621679158724"><span class="hs-identifier hs-type">sch</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><span class="hs-identifier hs-type">TPrimitive</span></span><span> </span><span class="annot"><a href="#local-6989586621679158725"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-335"></span><span>  </span><span id="local-6989586621679158722"><span class="annot"><span class="annottext">toAvro :: Schema -&gt; FieldValue sch ('TPrimitive t) -&gt; Builder
</span><a href="#local-6989586621679158722"><span class="hs-identifier hs-var hs-var hs-var hs-var">toAvro</span></a></span></span><span> </span><span id="local-6989586621679158721"><span class="annot"><span class="annottext">s :: Schema
</span><a href="#local-6989586621679158721"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">FPrimitive</span></span><span> </span><span id="local-6989586621679158720"><span class="annot"><span class="annottext">v :: t1
</span><a href="#local-6989586621679158720"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Schema -&gt; t1 -&gt; Builder
forall a. ToAvro a =&gt; Schema -&gt; a -&gt; Builder
</span><span class="hs-identifier hs-var">A.toAvro</span></span><span> </span><span class="annot"><span class="annottext">Schema
</span><a href="#local-6989586621679158721"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="annot"><span class="annottext">t1
</span><a href="#local-6989586621679158720"><span class="hs-identifier hs-var">v</span></a></span></span></span><span>
</span><span id="line-336"></span><span id="local-6989586621679158718"><span id="local-6989586621679158719"><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-identifier hs-type">KnownName</span></span><span> </span><span class="annot"><a href="#local-6989586621679158719"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">A.ToAvro</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Term</span></span><span> </span><span class="annot"><a href="#local-6989586621679158718"><span class="hs-identifier hs-type">sch</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679158718"><span class="hs-identifier hs-type">sch</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">:/:</span></span><span> </span><span class="annot"><a href="#local-6989586621679158719"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-337"></span><span>         </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">A.ToAvro</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">FieldValue</span></span><span> </span><span class="annot"><a href="#local-6989586621679158718"><span class="hs-identifier hs-type">sch</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><span class="hs-identifier hs-type">TSchematic</span></span><span> </span><span class="annot"><a href="#local-6989586621679158719"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-338"></span><span>  </span><span id="local-6989586621679158716"><span class="annot"><span class="annottext">toAvro :: Schema -&gt; FieldValue sch ('TSchematic t) -&gt; Builder
</span><a href="#local-6989586621679158716"><span class="hs-identifier hs-var hs-var hs-var hs-var">toAvro</span></a></span></span><span> </span><span id="local-6989586621679158715"><span class="annot"><span class="annottext">s :: Schema
</span><a href="#local-6989586621679158715"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">FSchematic</span></span><span> </span><span id="local-6989586621679158714"><span class="annot"><span class="annottext">v :: Term sch (sch :/: t1)
</span><a href="#local-6989586621679158714"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Schema -&gt; Term sch (sch :/: t) -&gt; Builder
forall a. ToAvro a =&gt; Schema -&gt; a -&gt; Builder
</span><span class="hs-identifier hs-var">A.toAvro</span></span><span> </span><span class="annot"><span class="annottext">Schema
</span><a href="#local-6989586621679158715"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="annot"><span class="annottext">Term sch (sch :/: t)
Term sch (sch :/: t1)
</span><a href="#local-6989586621679158714"><span class="hs-identifier hs-var">v</span></a></span></span></span><span>
</span><span id="line-339"></span><span id="local-6989586621679158712"><span id="local-6989586621679158713"><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Mu.Adapter.Avro.html#ToAvroUnion"><span class="hs-identifier hs-type">ToAvroUnion</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679158713"><span class="hs-identifier hs-type">sch</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679158712"><span class="hs-identifier hs-type">choices</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-340"></span><span>         </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">A.ToAvro</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">FieldValue</span></span><span> </span><span class="annot"><a href="#local-6989586621679158713"><span class="hs-identifier hs-type">sch</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><span class="hs-identifier hs-type">TUnion</span></span><span> </span><span class="annot"><a href="#local-6989586621679158712"><span class="hs-identifier hs-type">choices</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-341"></span><span>  </span><span id="local-6989586621679158710"><span class="annot"><span class="annottext">toAvro :: Schema -&gt; FieldValue sch ('TUnion choices) -&gt; Builder
</span><a href="#local-6989586621679158710"><span class="hs-identifier hs-var hs-var hs-var hs-var">toAvro</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">ASch.Union</span></span><span> </span><span id="local-6989586621679158709"><span class="annot"><span class="annottext">vs :: Vector Schema
</span><a href="#local-6989586621679158709"><span class="hs-identifier hs-var">vs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">FUnion</span></span><span> </span><span id="local-6989586621679158708"><span class="annot"><span class="annottext">v :: NS (FieldValue sch) choices
</span><a href="#local-6989586621679158708"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Vector Schema -&gt; Int -&gt; NS (FieldValue sch) choices -&gt; Builder
forall typeName fieldName (sch :: Schema typeName fieldName)
       (choices :: [FieldType typeName]).
ToAvroUnion sch choices =&gt;
Vector Schema -&gt; Int -&gt; NS (FieldValue sch) choices -&gt; Builder
</span><a href="Mu.Adapter.Avro.html#toAvroU"><span class="hs-identifier hs-var">toAvroU</span></a></span><span> </span><span class="annot"><span class="annottext">Vector Schema
</span><a href="#local-6989586621679158709"><span class="hs-identifier hs-var">vs</span></a></span><span> </span><span class="annot"><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">NS (FieldValue sch) choices
</span><a href="#local-6989586621679158708"><span class="hs-identifier hs-var">v</span></a></span><span>
</span><span id="line-342"></span><span>  </span><span class="annot"><span class="hs-identifier hs-var">toAvro</span></span><span> </span><span id="local-6989586621679158706"><span class="annot"><span class="annottext">s :: Schema
</span><a href="#local-6989586621679158706"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-identifier">_</span><span>                        </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; Builder
forall a. HasCallStack =&gt; [Char] -&gt; a
</span><span class="hs-identifier hs-var">error</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-string">&quot;this should never happen:\n&quot;</span></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; [Char] -&gt; [Char]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Schema -&gt; [Char]
forall a. Show a =&gt; a -&gt; [Char]
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Schema
</span><a href="#local-6989586621679158706"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">)</span></span></span><span>
</span><span id="line-343"></span><span id="local-6989586621679158704"><span id="local-6989586621679158705"><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">A.ToAvro</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">FieldValue</span></span><span> </span><span class="annot"><a href="#local-6989586621679158705"><span class="hs-identifier hs-type">sch</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679158704"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-344"></span><span>         </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">A.ToAvro</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">FieldValue</span></span><span> </span><span class="annot"><a href="#local-6989586621679158705"><span class="hs-identifier hs-type">sch</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><span class="hs-identifier hs-type">TOption</span></span><span> </span><span class="annot"><a href="#local-6989586621679158704"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-345"></span><span>  </span><span id="local-6989586621679158702"><span class="annot"><span class="annottext">toAvro :: Schema -&gt; FieldValue sch ('TOption t) -&gt; Builder
</span><a href="#local-6989586621679158702"><span class="hs-identifier hs-var hs-var hs-var hs-var">toAvro</span></a></span></span><span> </span><span id="local-6989586621679158701"><span class="annot"><span class="annottext">s :: Schema
</span><a href="#local-6989586621679158701"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">FOption</span></span><span> </span><span id="local-6989586621679158700"><span class="annot"><span class="annottext">v :: Maybe (FieldValue sch t1)
</span><a href="#local-6989586621679158700"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Schema -&gt; Maybe (FieldValue sch t1) -&gt; Builder
forall a. ToAvro a =&gt; Schema -&gt; a -&gt; Builder
</span><span class="hs-identifier hs-var">A.toAvro</span></span><span> </span><span class="annot"><span class="annottext">Schema
</span><a href="#local-6989586621679158701"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe (FieldValue sch t1)
</span><a href="#local-6989586621679158700"><span class="hs-identifier hs-var">v</span></a></span></span></span><span>
</span><span id="line-346"></span><span id="local-6989586621679158698"><span id="local-6989586621679158699"><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">A.ToAvro</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">FieldValue</span></span><span> </span><span class="annot"><a href="#local-6989586621679158699"><span class="hs-identifier hs-type">sch</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679158698"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-347"></span><span>         </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">A.ToAvro</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">FieldValue</span></span><span> </span><span class="annot"><a href="#local-6989586621679158699"><span class="hs-identifier hs-type">sch</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><span class="hs-identifier hs-type">TList</span></span><span> </span><span class="annot"><a href="#local-6989586621679158698"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-348"></span><span>  </span><span id="local-6989586621679158696"><span class="annot"><span class="annottext">toAvro :: Schema -&gt; FieldValue sch ('TList t) -&gt; Builder
</span><a href="#local-6989586621679158696"><span class="hs-identifier hs-var hs-var hs-var hs-var">toAvro</span></a></span></span><span> </span><span id="local-6989586621679158695"><span class="annot"><span class="annottext">s :: Schema
</span><a href="#local-6989586621679158695"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">FList</span></span><span> </span><span id="local-6989586621679158694"><span class="annot"><span class="annottext">v :: [FieldValue sch t1]
</span><a href="#local-6989586621679158694"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Schema -&gt; [FieldValue sch t1] -&gt; Builder
forall a. ToAvro a =&gt; Schema -&gt; a -&gt; Builder
</span><span class="hs-identifier hs-var">A.toAvro</span></span><span> </span><span class="annot"><span class="annottext">Schema
</span><a href="#local-6989586621679158695"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="annot"><span class="annottext">[FieldValue sch t1]
</span><a href="#local-6989586621679158694"><span class="hs-identifier hs-var">v</span></a></span></span></span><span>
</span><span id="line-349"></span><span class="hs-comment">-- These are the only two versions of Map supported by the library</span><span>
</span><span id="line-350"></span><span id="local-6989586621679158692"><span id="local-6989586621679158693"><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">A.ToAvro</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">FieldValue</span></span><span> </span><span class="annot"><a href="#local-6989586621679158693"><span class="hs-identifier hs-type">sch</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679158692"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-351"></span><span>         </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">A.ToAvro</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">FieldValue</span></span><span> </span><span class="annot"><a href="#local-6989586621679158693"><span class="hs-identifier hs-type">sch</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><span class="hs-identifier hs-type">TMap</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><span class="hs-identifier hs-type">TPrimitive</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">T.Text</span></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679158692"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-352"></span><span>  </span><span id="local-6989586621679158690"><span class="annot"><span class="annottext">toAvro :: Schema -&gt; FieldValue sch ('TMap ('TPrimitive Text) v) -&gt; Builder
</span><a href="#local-6989586621679158690"><span class="hs-identifier hs-var hs-var hs-var hs-var">toAvro</span></a></span></span><span> </span><span id="local-6989586621679158689"><span class="annot"><span class="annottext">s :: Schema
</span><a href="#local-6989586621679158689"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">FMap</span></span><span> </span><span id="local-6989586621679158688"><span class="annot"><span class="annottext">v :: Map (FieldValue sch k) (FieldValue sch v)
</span><a href="#local-6989586621679158688"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Schema -&gt; Map Text (FieldValue sch v) -&gt; Builder
forall a. ToAvro a =&gt; Schema -&gt; a -&gt; Builder
</span><span class="hs-identifier hs-var">A.toAvro</span></span><span> </span><span class="annot"><span class="annottext">Schema
</span><a href="#local-6989586621679158689"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="annot"><span class="annottext">(Map Text (FieldValue sch v) -&gt; Builder)
-&gt; Map Text (FieldValue sch v) -&gt; Builder
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(FieldValue sch k -&gt; Text)
-&gt; Map (FieldValue sch k) (FieldValue sch v)
-&gt; Map Text (FieldValue sch v)
forall k2 k1 a. Ord k2 =&gt; (k1 -&gt; k2) -&gt; Map k1 a -&gt; Map k2 a
</span><span class="hs-identifier hs-var">M.mapKeys</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">FPrimitive</span></span><span> </span><span id="local-6989586621679158687"><span class="annot"><span class="annottext">k :: t1
</span><a href="#local-6989586621679158687"><span class="hs-identifier hs-var">k</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">t1
Text
</span><a href="#local-6989586621679158687"><span class="hs-identifier hs-var">k</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Map (FieldValue sch k) (FieldValue sch v)
</span><a href="#local-6989586621679158688"><span class="hs-identifier hs-var">v</span></a></span></span></span><span>
</span><span id="line-353"></span><span id="local-6989586621679158685"><span id="local-6989586621679158686"><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">A.ToAvro</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">FieldValue</span></span><span> </span><span class="annot"><a href="#local-6989586621679158686"><span class="hs-identifier hs-type">sch</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679158685"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-354"></span><span>         </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">A.ToAvro</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">FieldValue</span></span><span> </span><span class="annot"><a href="#local-6989586621679158686"><span class="hs-identifier hs-type">sch</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><span class="hs-identifier hs-type">TMap</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><span class="hs-identifier hs-type">TPrimitive</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679158685"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-355"></span><span>  </span><span id="local-6989586621679158683"><span class="annot"><span class="annottext">toAvro :: Schema -&gt; FieldValue sch ('TMap ('TPrimitive [Char]) v) -&gt; Builder
</span><a href="#local-6989586621679158683"><span class="hs-identifier hs-var hs-var hs-var hs-var">toAvro</span></a></span></span><span> </span><span id="local-6989586621679158682"><span class="annot"><span class="annottext">s :: Schema
</span><a href="#local-6989586621679158682"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">FMap</span></span><span> </span><span id="local-6989586621679158681"><span class="annot"><span class="annottext">v :: Map (FieldValue sch k) (FieldValue sch v)
</span><a href="#local-6989586621679158681"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Schema -&gt; Map Text (FieldValue sch v) -&gt; Builder
forall a. ToAvro a =&gt; Schema -&gt; a -&gt; Builder
</span><span class="hs-identifier hs-var">A.toAvro</span></span><span> </span><span class="annot"><span class="annottext">Schema
</span><a href="#local-6989586621679158682"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="annot"><span class="annottext">(Map Text (FieldValue sch v) -&gt; Builder)
-&gt; Map Text (FieldValue sch v) -&gt; Builder
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(FieldValue sch k -&gt; Text)
-&gt; Map (FieldValue sch k) (FieldValue sch v)
-&gt; Map Text (FieldValue sch v)
forall k2 k1 a. Ord k2 =&gt; (k1 -&gt; k2) -&gt; Map k1 a -&gt; Map k2 a
</span><span class="hs-identifier hs-var">M.mapKeys</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">FPrimitive</span></span><span> </span><span id="local-6989586621679158680"><span class="annot"><span class="annottext">k :: t1
</span><a href="#local-6989586621679158680"><span class="hs-identifier hs-var">k</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; Text
</span><span class="hs-identifier hs-var">T.pack</span></span><span> </span><span class="annot"><span class="annottext">t1
[Char]
</span><a href="#local-6989586621679158680"><span class="hs-identifier hs-var">k</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Map (FieldValue sch k) (FieldValue sch v)
</span><a href="#local-6989586621679158681"><span class="hs-identifier hs-var">v</span></a></span></span></span><span>
</span><span id="line-356"></span><span>
</span><span id="line-357"></span><span class="hs-keyword">class</span><span> </span><span id="ToAvroEnum"><span class="annot"><a href="Mu.Adapter.Avro.html#ToAvroEnum"><span class="hs-identifier hs-var">ToAvroEnum</span></a></span></span><span> </span><span id="local-6989586621679159247"><span class="annot"><a href="#local-6989586621679159247"><span class="hs-identifier hs-type">choices</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-358"></span><span>  </span><span id="toAvroE"><span class="annot"><a href="Mu.Adapter.Avro.html#toAvroE"><span class="hs-identifier hs-type">toAvroE</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">V.Vector</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">T.Text</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">NS</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Proxy</span></span><span> </span><span class="annot"><a href="#local-6989586621679159247"><span class="hs-identifier hs-type">choices</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span>
</span><span id="line-359"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Mu.Adapter.Avro.html#ToAvroEnum"><span class="hs-identifier hs-type">ToAvroEnum</span></a></span><span> </span><span class="hs-special">'</span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-360"></span><span>  </span><span id="local-6989586621679158676"><span class="annot"><span class="annottext">toAvroE :: Vector Text -&gt; NS Proxy '[] -&gt; Int
</span><a href="#local-6989586621679158676"><span class="hs-identifier hs-var hs-var hs-var hs-var">toAvroE</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; Vector Text -&gt; NS Proxy '[] -&gt; Int
forall a. HasCallStack =&gt; [Char] -&gt; a
</span><span class="hs-identifier hs-var">error</span></span><span> </span><span class="annot"><span class="hs-string">&quot;ToAvro in an empty enum&quot;</span></span><span>
</span><span id="line-361"></span><span id="local-6989586621679158674"><span id="local-6989586621679158675"><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">KnownName</span></span><span> </span><span class="annot"><a href="#local-6989586621679158675"><span class="hs-identifier hs-type">u</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Mu.Adapter.Avro.html#ToAvroEnum"><span class="hs-identifier hs-type">ToAvroEnum</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679158674"><span class="hs-identifier hs-type">us</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-362"></span><span>         </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Mu.Adapter.Avro.html#ToAvroEnum"><span class="hs-identifier hs-type">ToAvroEnum</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><span class="hs-identifier hs-type">ChoiceDef</span></span><span> </span><span class="annot"><a href="#local-6989586621679158675"><span class="hs-identifier hs-type">u</span></a></span><span> </span><span class="hs-special">'</span><span class="hs-glyph">:</span><span> </span><span class="annot"><a href="#local-6989586621679158674"><span class="hs-identifier hs-type">us</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-363"></span><span>  </span><span id="local-6989586621679158672"><span class="annot"><span class="annottext">toAvroE :: Vector Text -&gt; NS Proxy ('ChoiceDef u : us) -&gt; Int
</span><a href="#local-6989586621679158672"><span class="hs-identifier hs-var hs-var hs-var hs-var">toAvroE</span></a></span></span><span> </span><span id="local-6989586621679158671"><span class="annot"><span class="annottext">s :: Vector Text
</span><a href="#local-6989586621679158671"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Z</span></span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe Int -&gt; Int
forall a. HasCallStack =&gt; Maybe a -&gt; a
</span><span class="hs-identifier hs-var">fromJust</span></span><span> </span><span class="annot"><span class="annottext">(Maybe Int -&gt; Int) -&gt; Maybe Int -&gt; Int
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Proxy u -&gt; Text
forall k (s :: k) (proxy :: k -&gt; *). KnownName s =&gt; proxy s -&gt; Text
</span><a href="Mu.Adapter.Avro.html#nameText"><span class="hs-identifier hs-var">nameText</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Proxy u
forall k (t :: k). Proxy t
</span><span class="hs-identifier hs-var">Proxy</span></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621679158675"><span class="hs-identifier hs-type">u</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Text -&gt; Vector Text -&gt; Maybe Int
forall a. Eq a =&gt; a -&gt; Vector a -&gt; Maybe Int
</span><span class="hs-operator hs-var">`V.elemIndex`</span></span><span> </span><span class="annot"><span class="annottext">Vector Text
</span><a href="#local-6989586621679158671"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-364"></span><span>  </span><span class="annot"><a href="Mu.Adapter.Avro.html#toAvroE"><span class="hs-identifier hs-var">toAvroE</span></a></span><span> </span><span id="local-6989586621679158669"><span class="annot"><span class="annottext">s :: Vector Text
</span><a href="#local-6989586621679158669"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">S</span></span><span> </span><span id="local-6989586621679158668"><span class="annot"><span class="annottext">v :: NS Proxy xs
</span><a href="#local-6989586621679158668"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Vector Text -&gt; NS Proxy xs -&gt; Int
forall k (choices :: [k]).
ToAvroEnum choices =&gt;
Vector Text -&gt; NS Proxy choices -&gt; Int
</span><a href="Mu.Adapter.Avro.html#toAvroE"><span class="hs-identifier hs-var">toAvroE</span></a></span><span> </span><span class="annot"><span class="annottext">Vector Text
</span><a href="#local-6989586621679158669"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="annot"><span class="annottext">NS Proxy xs
</span><a href="#local-6989586621679158668"><span class="hs-identifier hs-var">v</span></a></span></span></span><span>
</span><span id="line-365"></span><span>
</span><span id="line-366"></span><span class="hs-keyword">class</span><span> </span><span id="ToAvroUnion"><span class="annot"><a href="Mu.Adapter.Avro.html#ToAvroUnion"><span class="hs-identifier hs-var">ToAvroUnion</span></a></span></span><span> </span><span id="local-6989586621679159217"><span class="annot"><a href="#local-6989586621679159217"><span class="hs-identifier hs-type">sch</span></a></span></span><span> </span><span id="local-6989586621679159216"><span class="annot"><a href="#local-6989586621679159216"><span class="hs-identifier hs-type">choices</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-367"></span><span>  </span><span id="toAvroU"><span class="annot"><a href="Mu.Adapter.Avro.html#toAvroU"><span class="hs-identifier hs-type">toAvroU</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">V.Vector</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">ASch.Schema</span></span><span>
</span><span id="line-368"></span><span>          </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">NS</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">FieldValue</span></span><span> </span><span class="annot"><a href="#local-6989586621679159217"><span class="hs-identifier hs-type">sch</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679159216"><span class="hs-identifier hs-type">choices</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Builder</span></span><span>
</span><span id="line-369"></span><span id="local-6989586621679158667"><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Mu.Adapter.Avro.html#ToAvroUnion"><span class="hs-identifier hs-type">ToAvroUnion</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679158667"><span class="hs-identifier hs-type">sch</span></a></span><span> </span><span class="hs-special">'</span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-370"></span><span>  </span><span id="local-6989586621679158664"><span class="annot"><span class="annottext">toAvroU :: Vector Schema -&gt; Int -&gt; NS (FieldValue sch) '[] -&gt; Builder
</span><a href="#local-6989586621679158664"><span class="hs-identifier hs-var hs-var hs-var hs-var">toAvroU</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Char]
-&gt; Vector Schema -&gt; Int -&gt; NS (FieldValue sch) '[] -&gt; Builder
forall a. HasCallStack =&gt; [Char] -&gt; a
</span><span class="hs-identifier hs-var">error</span></span><span> </span><span class="annot"><span class="hs-string">&quot;this should never happen&quot;</span></span></span><span>
</span><span id="line-371"></span><span id="local-6989586621679158661"><span id="local-6989586621679158662"><span id="local-6989586621679158663"><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">A.ToAvro</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">FieldValue</span></span><span> </span><span class="annot"><a href="#local-6989586621679158663"><span class="hs-identifier hs-type">sch</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679158662"><span class="hs-identifier hs-type">u</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Mu.Adapter.Avro.html#ToAvroUnion"><span class="hs-identifier hs-type">ToAvroUnion</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679158663"><span class="hs-identifier hs-type">sch</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679158661"><span class="hs-identifier hs-type">us</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-372"></span><span>         </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Mu.Adapter.Avro.html#ToAvroUnion"><span class="hs-identifier hs-type">ToAvroUnion</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679158663"><span class="hs-identifier hs-type">sch</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679158662"><span class="hs-identifier hs-type">u</span></a></span><span> </span><span class="hs-special">'</span><span class="hs-glyph">:</span><span> </span><span class="annot"><a href="#local-6989586621679158661"><span class="hs-identifier hs-type">us</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-373"></span><span>  </span><span id="local-6989586621679158659"><span class="annot"><span class="annottext">toAvroU :: Vector Schema -&gt; Int -&gt; NS (FieldValue sch) (u : us) -&gt; Builder
</span><a href="#local-6989586621679158659"><span class="hs-identifier hs-var hs-var hs-var hs-var">toAvroU</span></a></span></span><span> </span><span id="local-6989586621679158658"><span class="annot"><span class="annottext">allSch :: Vector Schema
</span><a href="#local-6989586621679158658"><span class="hs-identifier hs-var">allSch</span></a></span></span><span> </span><span id="local-6989586621679158657"><span class="annot"><span class="annottext">n :: Int
</span><a href="#local-6989586621679158657"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Z</span></span><span> </span><span id="local-6989586621679158656"><span class="annot"><span class="annottext">v :: FieldValue sch x
</span><a href="#local-6989586621679158656"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-374"></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Vector Schema -&gt; FieldValue sch x -&gt; Builder
forall a. ToAvro a =&gt; Int -&gt; Vector Schema -&gt; a -&gt; Builder
</span><span class="hs-identifier hs-var">putIndexedValue</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679158657"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Vector Schema
</span><a href="#local-6989586621679158658"><span class="hs-identifier hs-var">allSch</span></a></span><span> </span><span class="annot"><span class="annottext">FieldValue sch x
</span><a href="#local-6989586621679158656"><span class="hs-identifier hs-var">v</span></a></span><span>
</span><span id="line-375"></span><span>  </span><span class="annot"><a href="Mu.Adapter.Avro.html#toAvroU"><span class="hs-identifier hs-var">toAvroU</span></a></span><span> </span><span id="local-6989586621679158655"><span class="annot"><span class="annottext">allSch :: Vector Schema
</span><a href="#local-6989586621679158655"><span class="hs-identifier hs-var">allSch</span></a></span></span><span> </span><span id="local-6989586621679158654"><span class="annot"><span class="annottext">n :: Int
</span><a href="#local-6989586621679158654"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">S</span></span><span> </span><span id="local-6989586621679158653"><span class="annot"><span class="annottext">v :: NS (FieldValue sch) xs
</span><a href="#local-6989586621679158653"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-376"></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Vector Schema -&gt; Int -&gt; NS (FieldValue sch) xs -&gt; Builder
forall typeName fieldName (sch :: Schema typeName fieldName)
       (choices :: [FieldType typeName]).
ToAvroUnion sch choices =&gt;
Vector Schema -&gt; Int -&gt; NS (FieldValue sch) choices -&gt; Builder
</span><a href="Mu.Adapter.Avro.html#toAvroU"><span class="hs-identifier hs-var">toAvroU</span></a></span><span> </span><span class="annot"><span class="annottext">Vector Schema
</span><a href="#local-6989586621679158655"><span class="hs-identifier hs-var">allSch</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679158654"><span class="hs-identifier hs-var">n</span></a></span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span class="annot"><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">NS (FieldValue sch) xs
</span><a href="#local-6989586621679158653"><span class="hs-identifier hs-var">v</span></a></span></span></span></span><span>
</span><span id="line-377"></span><span>
</span><span id="line-378"></span><span class="hs-keyword">class</span><span> </span><span id="ToAvroFields"><span class="annot"><a href="Mu.Adapter.Avro.html#ToAvroFields"><span class="hs-identifier hs-var">ToAvroFields</span></a></span></span><span> </span><span id="local-6989586621679159260"><span class="annot"><a href="#local-6989586621679159260"><span class="hs-identifier hs-type">sch</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679159259"><span class="annot"><a href="#local-6989586621679159259"><span class="hs-identifier hs-type">fs</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">FieldDef</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Symbol</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Symbol</span></span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-379"></span><span>  </span><span id="toAvroF"><span class="annot"><a href="Mu.Adapter.Avro.html#toAvroF"><span class="hs-identifier hs-type">toAvroF</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">NP</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Field</span></span><span> </span><span class="annot"><a href="#local-6989586621679159260"><span class="hs-identifier hs-type">sch</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679159259"><span class="hs-identifier hs-type">fs</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">T.Text</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">A.Encoder</span></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-380"></span><span id="local-6989586621679158651"><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Mu.Adapter.Avro.html#ToAvroFields"><span class="hs-identifier hs-type">ToAvroFields</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679158651"><span class="hs-identifier hs-type">sch</span></a></span><span> </span><span class="hs-special">'</span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-381"></span><span>  </span><span id="local-6989586621679158648"><span class="annot"><span class="annottext">toAvroF :: NP (Field sch) '[] -&gt; [(Text, Encoder)]
</span><a href="#local-6989586621679158648"><span class="hs-identifier hs-var hs-var hs-var hs-var">toAvroF</span></a></span></span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span></span><span>
</span><span id="line-382"></span><span id="local-6989586621679158644"><span id="local-6989586621679158645"><span id="local-6989586621679158646"><span id="local-6989586621679158647"><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">KnownName</span></span><span> </span><span class="annot"><a href="#local-6989586621679158647"><span class="hs-identifier hs-type">name</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">A.ToAvro</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">FieldValue</span></span><span> </span><span class="annot"><a href="#local-6989586621679158646"><span class="hs-identifier hs-type">sch</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679158645"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Mu.Adapter.Avro.html#ToAvroFields"><span class="hs-identifier hs-type">ToAvroFields</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679158646"><span class="hs-identifier hs-type">sch</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679158644"><span class="hs-identifier hs-type">fs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-383"></span><span>         </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Mu.Adapter.Avro.html#ToAvroFields"><span class="hs-identifier hs-type">ToAvroFields</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679158646"><span class="hs-identifier hs-type">sch</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><span class="hs-identifier hs-type">FieldDef</span></span><span> </span><span class="annot"><a href="#local-6989586621679158647"><span class="hs-identifier hs-type">name</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679158645"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="hs-special">'</span><span class="hs-glyph">:</span><span> </span><span class="annot"><a href="#local-6989586621679158644"><span class="hs-identifier hs-type">fs</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-384"></span><span>  </span><span id="local-6989586621679158642"><span class="annot"><span class="annottext">toAvroF :: NP (Field sch) ('FieldDef name t : fs) -&gt; [(Text, Encoder)]
</span><a href="#local-6989586621679158642"><span class="hs-identifier hs-var hs-var hs-var hs-var">toAvroF</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Field</span></span><span> </span><span id="local-6989586621679158641"><span class="annot"><span class="annottext">v :: FieldValue sch t
</span><a href="#local-6989586621679158641"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span class="annot"><span class="hs-operator hs-type">:*</span></span><span> </span><span id="local-6989586621679158640"><span class="annot"><span class="annottext">rest :: NP (Field sch) xs
</span><a href="#local-6989586621679158640"><span class="hs-identifier hs-var">rest</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679158639"><span class="hs-identifier hs-var">fieldName</span></a></span><span> </span><span class="annot"><span class="annottext">Text -&gt; FieldValue sch t -&gt; (Text, Encoder)
forall a. ToAvro a =&gt; Text -&gt; a -&gt; (Text, Encoder)
</span><span class="hs-operator hs-var">A..=</span></span><span> </span><span class="annot"><span class="annottext">FieldValue sch t
</span><a href="#local-6989586621679158641"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Text, Encoder) -&gt; [(Text, Encoder)] -&gt; [(Text, Encoder)]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">NP (Field sch) xs -&gt; [(Text, Encoder)]
forall (sch :: Schema Symbol Symbol)
       (fs :: [FieldDef Symbol Symbol]).
ToAvroFields sch fs =&gt;
NP (Field sch) fs -&gt; [(Text, Encoder)]
</span><a href="Mu.Adapter.Avro.html#toAvroF"><span class="hs-identifier hs-var">toAvroF</span></a></span><span> </span><span class="annot"><span class="annottext">NP (Field sch) xs
</span><a href="#local-6989586621679158640"><span class="hs-identifier hs-var">rest</span></a></span><span>
</span><span id="line-385"></span><span>    </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621679158639"><span class="annot"><span class="annottext">fieldName :: Text
</span><a href="#local-6989586621679158639"><span class="hs-identifier hs-var hs-var">fieldName</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Proxy name -&gt; Text
forall k (s :: k) (proxy :: k -&gt; *). KnownName s =&gt; proxy s -&gt; Text
</span><a href="Mu.Adapter.Avro.html#nameText"><span class="hs-identifier hs-var">nameText</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Proxy name
forall k (t :: k). Proxy t
</span><span class="hs-identifier hs-var">Proxy</span></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621679158647"><span class="hs-identifier hs-type">name</span></a></span><span class="hs-special">)</span></span></span></span></span><span>
</span><span id="line-386"></span><span>
</span><span id="line-387"></span><span class="hs-comment">-- Conversion of symbols to other things</span><span>
</span><span id="line-388"></span><span id="local-6989586621679159396"><span id="local-6989586621679159397"><span class="annot"><a href="Mu.Adapter.Avro.html#nameText"><span class="hs-identifier hs-type">nameText</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">KnownName</span></span><span> </span><span class="annot"><a href="#local-6989586621679159397"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679159396"><span class="hs-identifier hs-type">proxy</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679159397"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">T.Text</span></span></span></span><span>
</span><span id="line-389"></span><span id="nameText"><span class="annot"><span class="annottext">nameText :: proxy s -&gt; Text
</span><a href="Mu.Adapter.Avro.html#nameText"><span class="hs-identifier hs-var hs-var">nameText</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; Text
</span><span class="hs-identifier hs-var">T.pack</span></span><span> </span><span class="annot"><span class="annottext">([Char] -&gt; Text) -&gt; (proxy s -&gt; [Char]) -&gt; proxy s -&gt; Text
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">proxy s -&gt; [Char]
forall k (a :: k) (proxy :: k -&gt; *).
KnownName a =&gt;
proxy a -&gt; [Char]
</span><span class="hs-identifier hs-var">nameVal</span></span><span>
</span><span id="line-390"></span><span id="local-6989586621679159489"><span id="local-6989586621679159490"><span class="annot"><a href="Mu.Adapter.Avro.html#nameTypeName"><span class="hs-identifier hs-type">nameTypeName</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">KnownName</span></span><span> </span><span class="annot"><a href="#local-6989586621679159490"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679159489"><span class="hs-identifier hs-type">proxy</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679159490"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ASch.TypeName</span></span></span></span><span>
</span><span id="line-391"></span><span id="nameTypeName"><span class="annot"><span class="annottext">nameTypeName :: proxy s -&gt; TypeName
</span><a href="Mu.Adapter.Avro.html#nameTypeName"><span class="hs-identifier hs-var hs-var">nameTypeName</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Text -&gt; TypeName
</span><span class="hs-identifier hs-var">ASch.parseFullname</span></span><span> </span><span class="annot"><span class="annottext">(Text -&gt; TypeName) -&gt; (proxy s -&gt; Text) -&gt; proxy s -&gt; TypeName
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">proxy s -&gt; Text
forall k (s :: k) (proxy :: k -&gt; *). KnownName s =&gt; proxy s -&gt; Text
</span><a href="Mu.Adapter.Avro.html#nameText"><span class="hs-identifier hs-var">nameText</span></a></span><span>
</span><span id="line-392"></span></pre></body></html>