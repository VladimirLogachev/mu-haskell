<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# language DataKinds              #-}</span><span>
</span><a name="line-2"></a><span class="hs-pragma">{-# language FlexibleInstances      #-}</span><span>
</span><a name="line-3"></a><span class="hs-pragma">{-# language FunctionalDependencies #-}</span><span>
</span><a name="line-4"></a><span class="hs-pragma">{-# language GADTs                  #-}</span><span>
</span><a name="line-5"></a><span class="hs-pragma">{-# language KindSignatures         #-}</span><span>
</span><a name="line-6"></a><span class="hs-pragma">{-# language ScopedTypeVariables    #-}</span><span>
</span><a name="line-7"></a><span class="hs-pragma">{-# language TypeApplications       #-}</span><span>
</span><a name="line-8"></a><span class="hs-pragma">{-# language TypeOperators          #-}</span><span>
</span><a name="line-9"></a><span class="hs-pragma">{-# language UndecidableInstances   #-}</span><span>
</span><a name="line-10"></a><span class="hs-pragma">{-# OPTIONS_GHC -fno-warn-orphans #-}</span><span>
</span><a name="line-11"></a><span class="hs-comment">{-|
Description : Optics-based interface for @mu-schema@ terms

This module provides instances of 'LabelOptic' to be
used in conjunction with the @optics@ package.
In particular, there are two kind of optics to access
different parts of a 'Term':

* With @#field@ you obtain the lens (that is, a getter
  and a setter) for the corresponding field in a record.
* With @#choice@ you obtain the prism for the
  desired choice in an enumeration. You can use then
  'review' to construct a term with the value.

In addition, we provide a utility function 'record' to
build a record out of the inner values. We intend the
interface to be very simple, so this function is overloaded
to take tuples of different size, with as many components
as values in the schema type.
-}</span><span>
</span><a name="line-31"></a><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Mu.Schema.Optics</span><span> </span><span class="hs-special">(</span><span>
</span><a name="line-32"></a><span>  </span><span class="hs-comment">-- * Build a term</span><span>
</span><a name="line-33"></a><span>  </span><a href="Mu.Schema.Optics.html#record"><span class="hs-identifier hs-var">record</span></a><span>
</span><a name="line-34"></a><span>  </span><span class="hs-comment">-- * Re-exported for convenience.</span><span>
</span><a name="line-35"></a><span class="hs-special">,</span><span> </span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Optics.Core</span><span>
</span><a name="line-36"></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-37"></a><span>
</span><a name="line-38"></a><span class="hs-keyword">import</span><span>           </span><span class="hs-identifier">Data.Functor.Identity</span><span>
</span><a name="line-39"></a><span class="hs-keyword">import</span><span>           </span><span class="hs-identifier">Data.Kind</span><span>
</span><a name="line-40"></a><span class="hs-keyword">import</span><span>           </span><span class="hs-identifier">Data.Map</span><span>
</span><a name="line-41"></a><span class="hs-keyword">import</span><span>           </span><span class="hs-identifier">Data.Proxy</span><span>
</span><a name="line-42"></a><span class="hs-keyword">import</span><span>           </span><span class="hs-identifier">GHC.TypeLits</span><span>
</span><a name="line-43"></a><span class="hs-keyword">import</span><span>           </span><span class="hs-identifier">Optics.Core</span><span>
</span><a name="line-44"></a><span>
</span><a name="line-45"></a><span class="hs-keyword">import</span><span>           </span><span class="hs-identifier">Mu.Schema</span><span>
</span><a name="line-46"></a><span>
</span><a name="line-47"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-pragma">{-#&#160;OVERLAPS</span><span> </span><span class="hs-pragma">#-}</span><span>
</span><a name="line-48"></a><span>         </span><span class="hs-special">(</span><a href="Mu.Schema.Optics.html#FieldLabel"><span class="hs-identifier hs-type">FieldLabel</span></a><span> </span><span class="hs-identifier hs-type">Identity</span><span> </span><a href="#local-6989586621679042806"><span class="hs-identifier hs-type">sch</span></a><span> </span><a href="#local-6989586621679042807"><span class="hs-identifier hs-type">args</span></a><span> </span><a href="#local-6989586621679042808"><span class="hs-identifier hs-type">fieldName</span></a><span> </span><a href="#local-6989586621679042809"><span class="hs-identifier hs-type">r</span></a><span class="hs-special">)</span><span>
</span><a name="line-49"></a><span>         </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-identifier hs-type">LabelOptic</span><span> </span><a href="#local-6989586621679042808"><span class="hs-identifier hs-type">fieldName</span></a><span> </span><span class="hs-identifier hs-type">A_Lens</span><span>
</span><a name="line-50"></a><span>                       </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Term</span><span> </span><span class="hs-identifier hs-type">Identity</span><span> </span><a href="#local-6989586621679042806"><span class="hs-identifier hs-type">sch</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="hs-identifier hs-type">DRecord</span><span> </span><a href="#local-6989586621679042810"><span class="hs-identifier hs-type">name</span></a><span> </span><a href="#local-6989586621679042807"><span class="hs-identifier hs-type">args</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-51"></a><span>                       </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Term</span><span> </span><span class="hs-identifier hs-type">Identity</span><span> </span><a href="#local-6989586621679042806"><span class="hs-identifier hs-type">sch</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="hs-identifier hs-type">DRecord</span><span> </span><a href="#local-6989586621679042810"><span class="hs-identifier hs-type">name</span></a><span> </span><a href="#local-6989586621679042807"><span class="hs-identifier hs-type">args</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-52"></a><span>                       </span><a href="#local-6989586621679042809"><span class="hs-identifier hs-type">r</span></a><span> </span><a href="#local-6989586621679042809"><span class="hs-identifier hs-type">r</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-53"></a><span>  </span><a name="local-8214565720323797680"><span class="hs-identifier">labelOptic</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">lens</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span class="hs-identifier hs-var">TRecord</span><span> </span><a name="local-6989586621679042811"><a href="#local-6989586621679042811"><span class="hs-identifier">r</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">runIdentity</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="Mu.Schema.Optics.html#fieldLensGet"><span class="hs-identifier hs-var">fieldLensGet</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Proxy</span><span> </span><span class="hs-glyph">@</span><a href="#local-6989586621679042808"><span class="hs-identifier hs-type">fieldName</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679042811"><span class="hs-identifier hs-var">r</span></a><span class="hs-special">)</span><span>
</span><a name="line-54"></a><span>                    </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span class="hs-identifier hs-var">TRecord</span><span> </span><a name="local-6989586621679042812"><a href="#local-6989586621679042812"><span class="hs-identifier">r</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679042813"><a href="#local-6989586621679042813"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">TRecord</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="Mu.Schema.Optics.html#fieldLensSet"><span class="hs-identifier hs-var">fieldLensSet</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Proxy</span><span> </span><span class="hs-glyph">@</span><a href="#local-6989586621679042808"><span class="hs-identifier hs-type">fieldName</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679042812"><span class="hs-identifier hs-var">r</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Identity</span><span> </span><a href="#local-6989586621679042813"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-55"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-pragma">{-#&#160;OVERLAPPABLE</span><span> </span><span class="hs-pragma">#-}</span><span>
</span><a name="line-56"></a><span>         </span><span class="hs-special">(</span><a href="Mu.Schema.Optics.html#FieldLabel"><span class="hs-identifier hs-type">FieldLabel</span></a><span> </span><a href="#local-6989586621679042764"><span class="hs-identifier hs-type">w</span></a><span> </span><a href="#local-6989586621679042765"><span class="hs-identifier hs-type">sch</span></a><span> </span><a href="#local-6989586621679042766"><span class="hs-identifier hs-type">args</span></a><span> </span><a href="#local-6989586621679042767"><span class="hs-identifier hs-type">fieldName</span></a><span> </span><a href="#local-6989586621679042768"><span class="hs-identifier hs-type">r</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">t</span><span> </span><span class="hs-glyph">~</span><span> </span><a href="#local-6989586621679042764"><span class="hs-identifier hs-type">w</span></a><span> </span><a href="#local-6989586621679042768"><span class="hs-identifier hs-type">r</span></a><span class="hs-special">)</span><span>
</span><a name="line-57"></a><span>         </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-identifier hs-type">LabelOptic</span><span> </span><a href="#local-6989586621679042767"><span class="hs-identifier hs-type">fieldName</span></a><span> </span><span class="hs-identifier hs-type">A_Lens</span><span>
</span><a name="line-58"></a><span>                       </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Term</span><span> </span><a href="#local-6989586621679042764"><span class="hs-identifier hs-type">w</span></a><span> </span><a href="#local-6989586621679042765"><span class="hs-identifier hs-type">sch</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="hs-identifier hs-type">DRecord</span><span> </span><a href="#local-6989586621679042770"><span class="hs-identifier hs-type">name</span></a><span> </span><a href="#local-6989586621679042766"><span class="hs-identifier hs-type">args</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-59"></a><span>                       </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Term</span><span> </span><a href="#local-6989586621679042764"><span class="hs-identifier hs-type">w</span></a><span> </span><a href="#local-6989586621679042765"><span class="hs-identifier hs-type">sch</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="hs-identifier hs-type">DRecord</span><span> </span><a href="#local-6989586621679042770"><span class="hs-identifier hs-type">name</span></a><span> </span><a href="#local-6989586621679042766"><span class="hs-identifier hs-type">args</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-60"></a><span>                       </span><a href="#local-6989586621679042769"><span class="hs-identifier hs-type">t</span></a><span> </span><a href="#local-6989586621679042769"><span class="hs-identifier hs-type">t</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-61"></a><span>  </span><a name="local-8214565720323797680"><span class="hs-identifier">labelOptic</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">lens</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span class="hs-identifier hs-var">TRecord</span><span> </span><a name="local-6989586621679042803"><a href="#local-6989586621679042803"><span class="hs-identifier">r</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Mu.Schema.Optics.html#fieldLensGet"><span class="hs-identifier hs-var">fieldLensGet</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Proxy</span><span> </span><span class="hs-glyph">@</span><a href="#local-6989586621679042767"><span class="hs-identifier hs-type">fieldName</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679042803"><span class="hs-identifier hs-var">r</span></a><span class="hs-special">)</span><span>
</span><a name="line-62"></a><span>                    </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span class="hs-identifier hs-var">TRecord</span><span> </span><a name="local-6989586621679042804"><a href="#local-6989586621679042804"><span class="hs-identifier">r</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679042805"><a href="#local-6989586621679042805"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">TRecord</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="Mu.Schema.Optics.html#fieldLensSet"><span class="hs-identifier hs-var">fieldLensSet</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Proxy</span><span> </span><span class="hs-glyph">@</span><a href="#local-6989586621679042767"><span class="hs-identifier hs-type">fieldName</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679042804"><span class="hs-identifier hs-var">r</span></a><span> </span><a href="#local-6989586621679042805"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">)</span><span>
</span><a name="line-63"></a><span>
</span><a name="line-64"></a><span class="hs-identifier">record</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Mu.Schema.Optics.html#BuildRecord"><span class="hs-identifier hs-type">BuildRecord</span></a><span> </span><a href="#local-6989586621679042814"><span class="hs-identifier hs-type">w</span></a><span> </span><a href="#local-6989586621679042815"><span class="hs-identifier hs-type">sch</span></a><span> </span><a href="#local-6989586621679042816"><span class="hs-identifier hs-type">args</span></a><span> </span><a href="#local-6989586621679042817"><span class="hs-identifier hs-type">r</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="#local-6989586621679042817"><span class="hs-identifier hs-type">r</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Term</span><span> </span><a href="#local-6989586621679042814"><span class="hs-identifier hs-type">w</span></a><span> </span><a href="#local-6989586621679042815"><span class="hs-identifier hs-type">sch</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="hs-identifier hs-type">DRecord</span><span> </span><a href="#local-6989586621679042818"><span class="hs-identifier hs-type">name</span></a><span> </span><a href="#local-6989586621679042816"><span class="hs-identifier hs-type">args</span></a><span class="hs-special">)</span><span>
</span><a name="line-65"></a><a name="record"><a href="Mu.Schema.Optics.html#record"><span class="hs-identifier">record</span></a></a><span> </span><a name="local-6989586621679042819"><a href="#local-6989586621679042819"><span class="hs-identifier">values</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">TRecord</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="Mu.Schema.Optics.html#buildR"><span class="hs-identifier hs-var">buildR</span></a><span> </span><a href="#local-6989586621679042819"><span class="hs-identifier hs-var">values</span></a><span>
</span><a name="line-66"></a><span>
</span><a name="line-67"></a><span class="hs-keyword">class</span><span> </span><a name="BuildRecord"><a href="Mu.Schema.Optics.html#BuildRecord"><span class="hs-identifier">BuildRecord</span></a></a><span> </span><span class="hs-special">(</span><a name="local-6989586621679037652"><a href="#local-6989586621679037652"><span class="hs-identifier">w</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Type</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Type</span><span class="hs-special">)</span><span>
</span><a name="line-68"></a><span>                  </span><span class="hs-special">(</span><a name="local-6989586621679037653"><a href="#local-6989586621679037653"><span class="hs-identifier">sch</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Schema</span><span> </span><span class="hs-identifier hs-type">Symbol</span><span> </span><span class="hs-identifier hs-type">Symbol</span><span class="hs-special">)</span><span>
</span><a name="line-69"></a><span>                  </span><span class="hs-special">(</span><a name="local-6989586621679037654"><a href="#local-6989586621679037654"><span class="hs-identifier">args</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">FieldDef</span><span> </span><span class="hs-identifier hs-type">Symbol</span><span> </span><span class="hs-identifier hs-type">Symbol</span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><a name="line-70"></a><span>                  </span><span class="hs-special">(</span><a name="local-6989586621679037655"><a href="#local-6989586621679037655"><span class="hs-identifier">r</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Type</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">w</span><span> </span><span class="hs-identifier">sch</span><span> </span><span class="hs-identifier">args</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">r</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-71"></a><span>  </span><a name="buildR"><a href="Mu.Schema.Optics.html#buildR"><span class="hs-identifier">buildR</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><a href="#local-6989586621679037655"><span class="hs-identifier hs-type">r</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">NP</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Field</span><span> </span><a href="#local-6989586621679037652"><span class="hs-identifier hs-type">w</span></a><span> </span><a href="#local-6989586621679037653"><span class="hs-identifier hs-type">sch</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679037654"><span class="hs-identifier hs-type">args</span></a><span>
</span><a name="line-72"></a><span class="hs-keyword">instance</span><span> </span><a href="Mu.Schema.Optics.html#BuildRecord"><span class="hs-identifier hs-type">BuildRecord</span></a><span> </span><a href="#local-6989586621679042762"><span class="hs-identifier hs-type">w</span></a><span> </span><a href="#local-6989586621679042763"><span class="hs-identifier hs-type">sch</span></a><span> </span><span class="hs-special">'</span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-73"></a><span>  </span><a name="local-8214565720323811452"><a href="Mu.Schema.Optics.html#buildR"><span class="hs-identifier">buildR</span></a></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Nil</span><span>
</span><a name="line-74"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Functor</span><span> </span><a href="#local-6989586621679042756"><span class="hs-identifier hs-type">w</span></a><span class="hs-special">,</span><span> </span><a href="Mu.Schema.Optics.html#TypeLabel"><span class="hs-identifier hs-type">TypeLabel</span></a><span> </span><a href="#local-6989586621679042756"><span class="hs-identifier hs-type">w</span></a><span> </span><a href="#local-6989586621679042757"><span class="hs-identifier hs-type">sch</span></a><span> </span><a href="#local-6989586621679042758"><span class="hs-identifier hs-type">t1</span></a><span> </span><a href="#local-6989586621679042759"><span class="hs-identifier hs-type">r1</span></a><span class="hs-special">)</span><span>
</span><a name="line-75"></a><span>         </span><span class="hs-glyph">=&gt;</span><span> </span><a href="Mu.Schema.Optics.html#BuildRecord"><span class="hs-identifier hs-type">BuildRecord</span></a><span> </span><a href="#local-6989586621679042756"><span class="hs-identifier hs-type">w</span></a><span> </span><a href="#local-6989586621679042757"><span class="hs-identifier hs-type">sch</span></a><span> </span><span class="hs-special">'</span><span class="hs-special">[</span><span> </span><span class="hs-special">'</span><span class="hs-identifier hs-type">FieldDef</span><span> </span><a href="#local-6989586621679042760"><span class="hs-identifier hs-type">x1</span></a><span> </span><a href="#local-6989586621679042758"><span class="hs-identifier hs-type">t1</span></a><span> </span><span class="hs-special">]</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679042756"><span class="hs-identifier hs-type">w</span></a><span> </span><a href="#local-6989586621679042759"><span class="hs-identifier hs-type">r1</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-76"></a><span>  </span><a name="local-8214565720323811452"><a href="Mu.Schema.Optics.html#buildR"><span class="hs-identifier">buildR</span></a></a><span> </span><a name="local-6989586621679042761"><a href="#local-6989586621679042761"><span class="hs-identifier">v</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Field</span><span> </span><span class="hs-special">(</span><a href="Mu.Schema.Optics.html#typeLensSet"><span class="hs-identifier hs-var">typeLensSet</span></a><span> </span><span class="hs-operator hs-var">&lt;$&gt;</span><span> </span><a href="#local-6989586621679042761"><span class="hs-identifier hs-var">v</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">:*</span><span> </span><span class="hs-identifier hs-var">Nil</span><span>
</span><a name="line-77"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Functor</span><span> </span><a href="#local-6989586621679042746"><span class="hs-identifier hs-type">w</span></a><span class="hs-special">,</span><span> </span><a href="Mu.Schema.Optics.html#TypeLabel"><span class="hs-identifier hs-type">TypeLabel</span></a><span> </span><a href="#local-6989586621679042746"><span class="hs-identifier hs-type">w</span></a><span> </span><a href="#local-6989586621679042747"><span class="hs-identifier hs-type">sch</span></a><span> </span><a href="#local-6989586621679042748"><span class="hs-identifier hs-type">t1</span></a><span> </span><a href="#local-6989586621679042749"><span class="hs-identifier hs-type">r1</span></a><span class="hs-special">,</span><span> </span><a href="Mu.Schema.Optics.html#TypeLabel"><span class="hs-identifier hs-type">TypeLabel</span></a><span> </span><a href="#local-6989586621679042746"><span class="hs-identifier hs-type">w</span></a><span> </span><a href="#local-6989586621679042747"><span class="hs-identifier hs-type">sch</span></a><span> </span><a href="#local-6989586621679042750"><span class="hs-identifier hs-type">t2</span></a><span> </span><a href="#local-6989586621679042751"><span class="hs-identifier hs-type">r2</span></a><span class="hs-special">)</span><span>
</span><a name="line-78"></a><span>         </span><span class="hs-glyph">=&gt;</span><span> </span><a href="Mu.Schema.Optics.html#BuildRecord"><span class="hs-identifier hs-type">BuildRecord</span></a><span> </span><a href="#local-6989586621679042746"><span class="hs-identifier hs-type">w</span></a><span> </span><a href="#local-6989586621679042747"><span class="hs-identifier hs-type">sch</span></a><span> </span><span class="hs-special">'</span><span class="hs-special">[</span><span> </span><span class="hs-special">'</span><span class="hs-identifier hs-type">FieldDef</span><span> </span><a href="#local-6989586621679042752"><span class="hs-identifier hs-type">x1</span></a><span> </span><a href="#local-6989586621679042748"><span class="hs-identifier hs-type">t1</span></a><span class="hs-special">,</span><span> </span><span class="hs-special">'</span><span class="hs-identifier hs-type">FieldDef</span><span> </span><a href="#local-6989586621679042753"><span class="hs-identifier hs-type">x2</span></a><span> </span><a href="#local-6989586621679042750"><span class="hs-identifier hs-type">t2</span></a><span> </span><span class="hs-special">]</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679042746"><span class="hs-identifier hs-type">w</span></a><span> </span><a href="#local-6989586621679042749"><span class="hs-identifier hs-type">r1</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679042746"><span class="hs-identifier hs-type">w</span></a><span> </span><a href="#local-6989586621679042751"><span class="hs-identifier hs-type">r2</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-79"></a><span>  </span><a name="local-8214565720323811452"><a href="Mu.Schema.Optics.html#buildR"><span class="hs-identifier">buildR</span></a></a><span> </span><span class="hs-special">(</span><a name="local-6989586621679042754"><a href="#local-6989586621679042754"><span class="hs-identifier">v1</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679042755"><a href="#local-6989586621679042755"><span class="hs-identifier">v2</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Field</span><span> </span><span class="hs-special">(</span><a href="Mu.Schema.Optics.html#typeLensSet"><span class="hs-identifier hs-var">typeLensSet</span></a><span> </span><span class="hs-operator hs-var">&lt;$&gt;</span><span> </span><a href="#local-6989586621679042754"><span class="hs-identifier hs-var">v1</span></a><span class="hs-special">)</span><span>
</span><a name="line-80"></a><span>                  </span><span class="hs-operator hs-var">:*</span><span> </span><span class="hs-identifier hs-var">Field</span><span> </span><span class="hs-special">(</span><a href="Mu.Schema.Optics.html#typeLensSet"><span class="hs-identifier hs-var">typeLensSet</span></a><span> </span><span class="hs-operator hs-var">&lt;$&gt;</span><span> </span><a href="#local-6989586621679042755"><span class="hs-identifier hs-var">v2</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">:*</span><span> </span><span class="hs-identifier hs-var">Nil</span><span>
</span><a name="line-81"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Functor</span><span> </span><a href="#local-6989586621679042732"><span class="hs-identifier hs-type">w</span></a><span class="hs-special">,</span><span> </span><a href="Mu.Schema.Optics.html#TypeLabel"><span class="hs-identifier hs-type">TypeLabel</span></a><span> </span><a href="#local-6989586621679042732"><span class="hs-identifier hs-type">w</span></a><span> </span><a href="#local-6989586621679042733"><span class="hs-identifier hs-type">sch</span></a><span> </span><a href="#local-6989586621679042734"><span class="hs-identifier hs-type">t1</span></a><span> </span><a href="#local-6989586621679042735"><span class="hs-identifier hs-type">r1</span></a><span class="hs-special">,</span><span> </span><a href="Mu.Schema.Optics.html#TypeLabel"><span class="hs-identifier hs-type">TypeLabel</span></a><span> </span><a href="#local-6989586621679042732"><span class="hs-identifier hs-type">w</span></a><span> </span><a href="#local-6989586621679042733"><span class="hs-identifier hs-type">sch</span></a><span> </span><a href="#local-6989586621679042736"><span class="hs-identifier hs-type">t2</span></a><span> </span><a href="#local-6989586621679042737"><span class="hs-identifier hs-type">r2</span></a><span class="hs-special">,</span><span> </span><a href="Mu.Schema.Optics.html#TypeLabel"><span class="hs-identifier hs-type">TypeLabel</span></a><span> </span><a href="#local-6989586621679042732"><span class="hs-identifier hs-type">w</span></a><span> </span><a href="#local-6989586621679042733"><span class="hs-identifier hs-type">sch</span></a><span> </span><a href="#local-6989586621679042738"><span class="hs-identifier hs-type">t3</span></a><span> </span><a href="#local-6989586621679042739"><span class="hs-identifier hs-type">r3</span></a><span class="hs-special">)</span><span>
</span><a name="line-82"></a><span>         </span><span class="hs-glyph">=&gt;</span><span> </span><a href="Mu.Schema.Optics.html#BuildRecord"><span class="hs-identifier hs-type">BuildRecord</span></a><span> </span><a href="#local-6989586621679042732"><span class="hs-identifier hs-type">w</span></a><span> </span><a href="#local-6989586621679042733"><span class="hs-identifier hs-type">sch</span></a><span>
</span><a name="line-83"></a><span>                        </span><span class="hs-special">'</span><span class="hs-special">[</span><span> </span><span class="hs-special">'</span><span class="hs-identifier hs-type">FieldDef</span><span> </span><a href="#local-6989586621679042740"><span class="hs-identifier hs-type">x1</span></a><span> </span><a href="#local-6989586621679042734"><span class="hs-identifier hs-type">t1</span></a><span class="hs-special">,</span><span> </span><span class="hs-special">'</span><span class="hs-identifier hs-type">FieldDef</span><span> </span><a href="#local-6989586621679042741"><span class="hs-identifier hs-type">x2</span></a><span> </span><a href="#local-6989586621679042736"><span class="hs-identifier hs-type">t2</span></a><span class="hs-special">,</span><span> </span><span class="hs-special">'</span><span class="hs-identifier hs-type">FieldDef</span><span> </span><a href="#local-6989586621679042742"><span class="hs-identifier hs-type">x3</span></a><span> </span><a href="#local-6989586621679042738"><span class="hs-identifier hs-type">t3</span></a><span> </span><span class="hs-special">]</span><span>
</span><a name="line-84"></a><span>                        </span><span class="hs-special">(</span><a href="#local-6989586621679042732"><span class="hs-identifier hs-type">w</span></a><span> </span><a href="#local-6989586621679042735"><span class="hs-identifier hs-type">r1</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679042732"><span class="hs-identifier hs-type">w</span></a><span> </span><a href="#local-6989586621679042737"><span class="hs-identifier hs-type">r2</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679042732"><span class="hs-identifier hs-type">w</span></a><span> </span><a href="#local-6989586621679042739"><span class="hs-identifier hs-type">r3</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-85"></a><span>  </span><a name="local-8214565720323811452"><a href="Mu.Schema.Optics.html#buildR"><span class="hs-identifier">buildR</span></a></a><span> </span><span class="hs-special">(</span><a name="local-6989586621679042743"><a href="#local-6989586621679042743"><span class="hs-identifier">v1</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679042744"><a href="#local-6989586621679042744"><span class="hs-identifier">v2</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679042745"><a href="#local-6989586621679042745"><span class="hs-identifier">v3</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Field</span><span> </span><span class="hs-special">(</span><a href="Mu.Schema.Optics.html#typeLensSet"><span class="hs-identifier hs-var">typeLensSet</span></a><span> </span><span class="hs-operator hs-var">&lt;$&gt;</span><span> </span><a href="#local-6989586621679042743"><span class="hs-identifier hs-var">v1</span></a><span class="hs-special">)</span><span>
</span><a name="line-86"></a><span>                      </span><span class="hs-operator hs-var">:*</span><span> </span><span class="hs-identifier hs-var">Field</span><span> </span><span class="hs-special">(</span><a href="Mu.Schema.Optics.html#typeLensSet"><span class="hs-identifier hs-var">typeLensSet</span></a><span> </span><span class="hs-operator hs-var">&lt;$&gt;</span><span> </span><a href="#local-6989586621679042744"><span class="hs-identifier hs-var">v2</span></a><span class="hs-special">)</span><span>
</span><a name="line-87"></a><span>                      </span><span class="hs-operator hs-var">:*</span><span> </span><span class="hs-identifier hs-var">Field</span><span> </span><span class="hs-special">(</span><a href="Mu.Schema.Optics.html#typeLensSet"><span class="hs-identifier hs-var">typeLensSet</span></a><span> </span><span class="hs-operator hs-var">&lt;$&gt;</span><span> </span><a href="#local-6989586621679042745"><span class="hs-identifier hs-var">v3</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">:*</span><span> </span><span class="hs-identifier hs-var">Nil</span><span>
</span><a name="line-88"></a><span>
</span><a name="line-89"></a><span>
</span><a name="line-90"></a><span class="hs-keyword">class</span><span> </span><a name="FieldLabel"><a href="Mu.Schema.Optics.html#FieldLabel"><span class="hs-identifier">FieldLabel</span></a></a><span> </span><span class="hs-special">(</span><a name="local-6989586621679037647"><a href="#local-6989586621679037647"><span class="hs-identifier">w</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Type</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Type</span><span class="hs-special">)</span><span>
</span><a name="line-91"></a><span>                 </span><span class="hs-special">(</span><a name="local-6989586621679037648"><a href="#local-6989586621679037648"><span class="hs-identifier">sch</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Schema</span><span> </span><span class="hs-identifier hs-type">Symbol</span><span> </span><span class="hs-identifier hs-type">Symbol</span><span class="hs-special">)</span><span>
</span><a name="line-92"></a><span>                 </span><span class="hs-special">(</span><a name="local-6989586621679037649"><a href="#local-6989586621679037649"><span class="hs-identifier">args</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">FieldDef</span><span> </span><span class="hs-identifier hs-type">Symbol</span><span> </span><span class="hs-identifier hs-type">Symbol</span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><a name="line-93"></a><span>                 </span><span class="hs-special">(</span><a name="local-6989586621679037650"><a href="#local-6989586621679037650"><span class="hs-identifier">fieldName</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Symbol</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679037651"><a href="#local-6989586621679037651"><span class="hs-identifier">r</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Type</span><span class="hs-special">)</span><span>
</span><a name="line-94"></a><span>                 </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">w</span><span> </span><span class="hs-identifier">sch</span><span> </span><span class="hs-identifier">args</span><span> </span><span class="hs-identifier">fieldName</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">r</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-95"></a><span>  </span><a name="fieldLensGet"><a href="Mu.Schema.Optics.html#fieldLensGet"><span class="hs-identifier">fieldLensGet</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Proxy</span><span> </span><a href="#local-6989586621679037650"><span class="hs-identifier hs-type">fieldName</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">NP</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Field</span><span> </span><a href="#local-6989586621679037647"><span class="hs-identifier hs-type">w</span></a><span> </span><a href="#local-6989586621679037648"><span class="hs-identifier hs-type">sch</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679037649"><span class="hs-identifier hs-type">args</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679037647"><span class="hs-identifier hs-type">w</span></a><span> </span><a href="#local-6989586621679037651"><span class="hs-identifier hs-type">r</span></a><span>
</span><a name="line-96"></a><span>  </span><a name="fieldLensSet"><a href="Mu.Schema.Optics.html#fieldLensSet"><span class="hs-identifier">fieldLensSet</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Proxy</span><span> </span><a href="#local-6989586621679037650"><span class="hs-identifier hs-type">fieldName</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">NP</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Field</span><span> </span><a href="#local-6989586621679037647"><span class="hs-identifier hs-type">w</span></a><span> </span><a href="#local-6989586621679037648"><span class="hs-identifier hs-type">sch</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679037649"><span class="hs-identifier hs-type">args</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679037647"><span class="hs-identifier hs-type">w</span></a><span> </span><a href="#local-6989586621679037651"><span class="hs-identifier hs-type">r</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">NP</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Field</span><span> </span><a href="#local-6989586621679037647"><span class="hs-identifier hs-type">w</span></a><span> </span><a href="#local-6989586621679037648"><span class="hs-identifier hs-type">sch</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679037649"><span class="hs-identifier hs-type">args</span></a><span>
</span><a name="line-97"></a><span>
</span><a name="line-98"></a><span class="hs-comment">{- Removed due to FunDeps
instance TypeError ('Text &quot;cannot find field &quot; ':&lt;&gt;: 'ShowType f)
         =&gt; FieldLabel w sch '[] f t where
  fieldLensGet = error &quot;this should never be run&quot;
  fieldLensSet = error &quot;this should never be run&quot;
-}</span><span>
</span><a name="line-104"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-pragma">{-# OVERLAPS</span><span> </span><span class="hs-pragma">#-}</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Functor</span><span> </span><a href="#local-6989586621679042723"><span class="hs-identifier hs-type">w</span></a><span class="hs-special">,</span><span> </span><a href="Mu.Schema.Optics.html#TypeLabel"><span class="hs-identifier hs-type">TypeLabel</span></a><span> </span><a href="#local-6989586621679042723"><span class="hs-identifier hs-type">w</span></a><span> </span><a href="#local-6989586621679042724"><span class="hs-identifier hs-type">sch</span></a><span> </span><a href="#local-6989586621679042725"><span class="hs-identifier hs-type">t</span></a><span> </span><a href="#local-6989586621679042726"><span class="hs-identifier hs-type">r</span></a><span class="hs-special">)</span><span>
</span><a name="line-105"></a><span>         </span><span class="hs-glyph">=&gt;</span><span> </span><a href="Mu.Schema.Optics.html#FieldLabel"><span class="hs-identifier hs-type">FieldLabel</span></a><span> </span><a href="#local-6989586621679042723"><span class="hs-identifier hs-type">w</span></a><span> </span><a href="#local-6989586621679042724"><span class="hs-identifier hs-type">sch</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="hs-identifier hs-type">FieldDef</span><span> </span><a href="#local-6989586621679042727"><span class="hs-identifier hs-type">f</span></a><span> </span><a href="#local-6989586621679042725"><span class="hs-identifier hs-type">t</span></a><span> </span><span class="hs-special">'</span><span class="hs-glyph">:</span><span> </span><a href="#local-6989586621679042728"><span class="hs-identifier hs-type">rest</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679042727"><span class="hs-identifier hs-type">f</span></a><span> </span><a href="#local-6989586621679042726"><span class="hs-identifier hs-type">r</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-106"></a><span>  </span><a name="local-8214565720323811449"><a href="Mu.Schema.Optics.html#fieldLensGet"><span class="hs-identifier">fieldLensGet</span></a></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Field</span><span> </span><a name="local-6989586621679042729"><a href="#local-6989586621679042729"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-operator hs-var">:*</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Mu.Schema.Optics.html#typeLensGet"><span class="hs-identifier hs-var">typeLensGet</span></a><span> </span><span class="hs-operator hs-var">&lt;$&gt;</span><span> </span><a href="#local-6989586621679042729"><span class="hs-identifier hs-var">x</span></a><span>
</span><a name="line-107"></a><span>  </span><a name="local-8214565720323811450"><a href="Mu.Schema.Optics.html#fieldLensSet"><span class="hs-identifier">fieldLensSet</span></a></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">_</span><span> </span><span class="hs-operator hs-var">:*</span><span> </span><a name="local-6989586621679042730"><a href="#local-6989586621679042730"><span class="hs-identifier">r</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679042731"><a href="#local-6989586621679042731"><span class="hs-identifier">new</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Field</span><span> </span><span class="hs-special">(</span><a href="Mu.Schema.Optics.html#typeLensSet"><span class="hs-identifier hs-var">typeLensSet</span></a><span> </span><span class="hs-operator hs-var">&lt;$&gt;</span><span> </span><a href="#local-6989586621679042731"><span class="hs-identifier hs-var">new</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">:*</span><span> </span><a href="#local-6989586621679042730"><span class="hs-identifier hs-var">r</span></a><span>
</span><a name="line-108"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-pragma">{-#&#160;OVERLAPPABLE</span><span> </span><span class="hs-pragma">#-}</span><span> </span><a href="Mu.Schema.Optics.html#FieldLabel"><span class="hs-identifier hs-type">FieldLabel</span></a><span> </span><a href="#local-6989586621679042711"><span class="hs-identifier hs-type">w</span></a><span> </span><a href="#local-6989586621679042712"><span class="hs-identifier hs-type">sch</span></a><span> </span><a href="#local-6989586621679042713"><span class="hs-identifier hs-type">rest</span></a><span> </span><a href="#local-6989586621679042714"><span class="hs-identifier hs-type">g</span></a><span> </span><a href="#local-6989586621679042715"><span class="hs-identifier hs-type">t</span></a><span>
</span><a name="line-109"></a><span>         </span><span class="hs-glyph">=&gt;</span><span> </span><a href="Mu.Schema.Optics.html#FieldLabel"><span class="hs-identifier hs-type">FieldLabel</span></a><span> </span><a href="#local-6989586621679042711"><span class="hs-identifier hs-type">w</span></a><span> </span><a href="#local-6989586621679042712"><span class="hs-identifier hs-type">sch</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">f</span><span> </span><span class="hs-special">'</span><span class="hs-glyph">:</span><span> </span><a href="#local-6989586621679042713"><span class="hs-identifier hs-type">rest</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679042714"><span class="hs-identifier hs-type">g</span></a><span> </span><a href="#local-6989586621679042715"><span class="hs-identifier hs-type">t</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-110"></a><span>  </span><a name="local-8214565720323811449"><a href="Mu.Schema.Optics.html#fieldLensGet"><span class="hs-identifier">fieldLensGet</span></a></a><span> </span><a name="local-6989586621679042717"><a href="#local-6989586621679042717"><span class="hs-identifier">p</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">_</span><span> </span><span class="hs-operator hs-var">:*</span><span> </span><a name="local-6989586621679042718"><a href="#local-6989586621679042718"><span class="hs-identifier">r</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Mu.Schema.Optics.html#fieldLensGet"><span class="hs-identifier hs-var">fieldLensGet</span></a><span> </span><a href="#local-6989586621679042717"><span class="hs-identifier hs-var">p</span></a><span> </span><a href="#local-6989586621679042718"><span class="hs-identifier hs-var">r</span></a><span>
</span><a name="line-111"></a><span>  </span><a name="local-8214565720323811450"><a href="Mu.Schema.Optics.html#fieldLensSet"><span class="hs-identifier">fieldLensSet</span></a></a><span> </span><a name="local-6989586621679042719"><a href="#local-6989586621679042719"><span class="hs-identifier">p</span></a></a><span> </span><span class="hs-special">(</span><a name="local-6989586621679042720"><a href="#local-6989586621679042720"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-operator hs-var">:*</span><span> </span><a name="local-6989586621679042721"><a href="#local-6989586621679042721"><span class="hs-identifier">r</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679042722"><a href="#local-6989586621679042722"><span class="hs-identifier">new</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679042720"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-operator hs-var">:*</span><span> </span><a href="Mu.Schema.Optics.html#fieldLensSet"><span class="hs-identifier hs-var">fieldLensSet</span></a><span> </span><a href="#local-6989586621679042719"><span class="hs-identifier hs-var">p</span></a><span> </span><a href="#local-6989586621679042721"><span class="hs-identifier hs-var">r</span></a><span> </span><a href="#local-6989586621679042722"><span class="hs-identifier hs-var">new</span></a><span>
</span><a name="line-112"></a><span>
</span><a name="line-113"></a><span class="hs-keyword">class</span><span> </span><a name="TypeLabel"><a href="Mu.Schema.Optics.html#TypeLabel"><span class="hs-identifier">TypeLabel</span></a></a><span> </span><a name="local-6989586621679037150"><a href="#local-6989586621679037150"><span class="hs-identifier">w</span></a></a><span> </span><span class="hs-special">(</span><a name="local-6989586621679037151"><a href="#local-6989586621679037151"><span class="hs-identifier">sch</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Schema</span><span> </span><span class="hs-identifier hs-type">Symbol</span><span> </span><span class="hs-identifier hs-type">Symbol</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679037152"><a href="#local-6989586621679037152"><span class="hs-identifier">t</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">FieldType</span><span> </span><span class="hs-identifier hs-type">Symbol</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679037153"><a href="#local-6989586621679037153"><span class="hs-identifier">r</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Type</span><span class="hs-special">)</span><span>
</span><a name="line-114"></a><span>      </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">w</span><span> </span><span class="hs-identifier">sch</span><span> </span><span class="hs-identifier">t</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">r</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-115"></a><span>  </span><a name="typeLensGet"><a href="Mu.Schema.Optics.html#typeLensGet"><span class="hs-identifier">typeLensGet</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">FieldValue</span><span> </span><a href="#local-6989586621679037150"><span class="hs-identifier hs-type">w</span></a><span> </span><a href="#local-6989586621679037151"><span class="hs-identifier hs-type">sch</span></a><span> </span><a href="#local-6989586621679037152"><span class="hs-identifier hs-type">t</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679037153"><span class="hs-identifier hs-type">r</span></a><span>
</span><a name="line-116"></a><span>  </span><a name="typeLensSet"><a href="Mu.Schema.Optics.html#typeLensSet"><span class="hs-identifier">typeLensSet</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><a href="#local-6989586621679037153"><span class="hs-identifier hs-type">r</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">FieldValue</span><span> </span><a href="#local-6989586621679037150"><span class="hs-identifier hs-type">w</span></a><span> </span><a href="#local-6989586621679037151"><span class="hs-identifier hs-type">sch</span></a><span> </span><a href="#local-6989586621679037152"><span class="hs-identifier hs-type">t</span></a><span>
</span><a name="line-117"></a><span>
</span><a name="line-118"></a><span class="hs-keyword">instance</span><span> </span><a href="Mu.Schema.Optics.html#TypeLabel"><span class="hs-identifier hs-type">TypeLabel</span></a><span> </span><a href="#local-6989586621679042707"><span class="hs-identifier hs-type">w</span></a><span> </span><a href="#local-6989586621679042708"><span class="hs-identifier hs-type">sch</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="hs-identifier hs-type">TPrimitive</span><span> </span><a href="#local-6989586621679042709"><span class="hs-identifier hs-type">t</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679042709"><span class="hs-identifier hs-type">t</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-119"></a><span>  </span><a name="local-8214565720323811446"><a href="Mu.Schema.Optics.html#typeLensGet"><span class="hs-identifier">typeLensGet</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">FPrimitive</span><span> </span><a name="local-6989586621679042710"><a href="#local-6989586621679042710"><span class="hs-identifier">x</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679042710"><span class="hs-identifier hs-var">x</span></a><span>
</span><a name="line-120"></a><span>  </span><a name="local-8214565720323811447"><a href="Mu.Schema.Optics.html#typeLensSet"><span class="hs-identifier">typeLensSet</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">FPrimitive</span><span>
</span><a name="line-121"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">r</span><span> </span><span class="hs-glyph">~</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">sch</span><span> </span><span class="hs-operator hs-type">:/:</span><span> </span><a href="#local-6989586621679042704"><span class="hs-identifier hs-type">t</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="Mu.Schema.Optics.html#TypeLabel"><span class="hs-identifier hs-type">TypeLabel</span></a><span> </span><a href="#local-6989586621679042705"><span class="hs-identifier hs-type">w</span></a><span> </span><a href="#local-6989586621679042703"><span class="hs-identifier hs-type">sch</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="hs-identifier hs-type">TSchematic</span><span> </span><a href="#local-6989586621679042704"><span class="hs-identifier hs-type">t</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Term</span><span> </span><a href="#local-6989586621679042705"><span class="hs-identifier hs-type">w</span></a><span> </span><a href="#local-6989586621679042703"><span class="hs-identifier hs-type">sch</span></a><span> </span><a href="#local-6989586621679042702"><span class="hs-identifier hs-type">r</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-122"></a><span>  </span><a name="local-8214565720323811446"><a href="Mu.Schema.Optics.html#typeLensGet"><span class="hs-identifier">typeLensGet</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">FSchematic</span><span> </span><a name="local-6989586621679042706"><a href="#local-6989586621679042706"><span class="hs-identifier">x</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679042706"><span class="hs-identifier hs-var">x</span></a><span>
</span><a name="line-123"></a><span>  </span><a name="local-8214565720323811447"><a href="Mu.Schema.Optics.html#typeLensSet"><span class="hs-identifier">typeLensSet</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">FSchematic</span><span>
</span><a name="line-124"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><a href="Mu.Schema.Optics.html#TypeLabel"><span class="hs-identifier hs-type">TypeLabel</span></a><span> </span><a href="#local-6989586621679042695"><span class="hs-identifier hs-type">w</span></a><span> </span><a href="#local-6989586621679042696"><span class="hs-identifier hs-type">sch</span></a><span> </span><a href="#local-6989586621679042697"><span class="hs-identifier hs-type">o</span></a><span> </span><a href="#local-6989586621679042698"><span class="hs-identifier hs-type">r'</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">r</span><span> </span><span class="hs-glyph">~</span><span> </span><span class="hs-identifier hs-type">Maybe</span><span> </span><a href="#local-6989586621679042698"><span class="hs-identifier hs-type">r'</span></a><span class="hs-special">)</span><span>
</span><a name="line-125"></a><span>         </span><span class="hs-glyph">=&gt;</span><span> </span><a href="Mu.Schema.Optics.html#TypeLabel"><span class="hs-identifier hs-type">TypeLabel</span></a><span> </span><a href="#local-6989586621679042695"><span class="hs-identifier hs-type">w</span></a><span> </span><a href="#local-6989586621679042696"><span class="hs-identifier hs-type">sch</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="hs-identifier hs-type">TOption</span><span> </span><a href="#local-6989586621679042697"><span class="hs-identifier hs-type">o</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679042699"><span class="hs-identifier hs-type">r</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-126"></a><span>  </span><a name="local-8214565720323811446"><a href="Mu.Schema.Optics.html#typeLensGet"><span class="hs-identifier">typeLensGet</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">FOption</span><span> </span><a name="local-6989586621679042700"><a href="#local-6989586621679042700"><span class="hs-identifier">x</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Mu.Schema.Optics.html#typeLensGet"><span class="hs-identifier hs-var">typeLensGet</span></a><span> </span><span class="hs-operator hs-var">&lt;$&gt;</span><span> </span><a href="#local-6989586621679042700"><span class="hs-identifier hs-var">x</span></a><span>
</span><a name="line-127"></a><span>  </span><a name="local-8214565720323811447"><a href="Mu.Schema.Optics.html#typeLensSet"><span class="hs-identifier">typeLensSet</span></a></a><span> </span><a name="local-6989586621679042701"><a href="#local-6989586621679042701"><span class="hs-identifier">new</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">FOption</span><span> </span><span class="hs-special">(</span><a href="Mu.Schema.Optics.html#typeLensSet"><span class="hs-identifier hs-var">typeLensSet</span></a><span> </span><span class="hs-operator hs-var">&lt;$&gt;</span><span> </span><a href="#local-6989586621679042701"><span class="hs-identifier hs-var">new</span></a><span class="hs-special">)</span><span>
</span><a name="line-128"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><a href="Mu.Schema.Optics.html#TypeLabel"><span class="hs-identifier hs-type">TypeLabel</span></a><span> </span><a href="#local-6989586621679042688"><span class="hs-identifier hs-type">w</span></a><span> </span><a href="#local-6989586621679042689"><span class="hs-identifier hs-type">sch</span></a><span> </span><a href="#local-6989586621679042690"><span class="hs-identifier hs-type">o</span></a><span> </span><a href="#local-6989586621679042691"><span class="hs-identifier hs-type">r'</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">r</span><span> </span><span class="hs-glyph">~</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679042691"><span class="hs-identifier hs-type">r'</span></a><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><a name="line-129"></a><span>         </span><span class="hs-glyph">=&gt;</span><span> </span><a href="Mu.Schema.Optics.html#TypeLabel"><span class="hs-identifier hs-type">TypeLabel</span></a><span> </span><a href="#local-6989586621679042688"><span class="hs-identifier hs-type">w</span></a><span> </span><a href="#local-6989586621679042689"><span class="hs-identifier hs-type">sch</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="hs-identifier hs-type">TList</span><span> </span><a href="#local-6989586621679042690"><span class="hs-identifier hs-type">o</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679042692"><span class="hs-identifier hs-type">r</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-130"></a><span>  </span><a name="local-8214565720323811446"><a href="Mu.Schema.Optics.html#typeLensGet"><span class="hs-identifier">typeLensGet</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">FList</span><span> </span><a name="local-6989586621679042693"><a href="#local-6989586621679042693"><span class="hs-identifier">x</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Mu.Schema.Optics.html#typeLensGet"><span class="hs-identifier hs-var">typeLensGet</span></a><span> </span><span class="hs-operator hs-var">&lt;$&gt;</span><span> </span><a href="#local-6989586621679042693"><span class="hs-identifier hs-var">x</span></a><span>
</span><a name="line-131"></a><span>  </span><a name="local-8214565720323811447"><a href="Mu.Schema.Optics.html#typeLensSet"><span class="hs-identifier">typeLensSet</span></a></a><span> </span><a name="local-6989586621679042694"><a href="#local-6989586621679042694"><span class="hs-identifier">new</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">FList</span><span> </span><span class="hs-special">(</span><a href="Mu.Schema.Optics.html#typeLensSet"><span class="hs-identifier hs-var">typeLensSet</span></a><span> </span><span class="hs-operator hs-var">&lt;$&gt;</span><span> </span><a href="#local-6989586621679042694"><span class="hs-identifier hs-var">new</span></a><span class="hs-special">)</span><span>
</span><a name="line-132"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><span> </span><a href="Mu.Schema.Optics.html#TypeLabel"><span class="hs-identifier hs-type">TypeLabel</span></a><span> </span><a href="#local-6989586621679037974"><span class="hs-identifier hs-type">w</span></a><span> </span><a href="#local-6989586621679037975"><span class="hs-identifier hs-type">sch</span></a><span> </span><a href="#local-6989586621679037976"><span class="hs-identifier hs-type">k</span></a><span> </span><a href="#local-6989586621679037977"><span class="hs-identifier hs-type">k'</span></a><span class="hs-special">,</span><span> </span><a href="Mu.Schema.Optics.html#TypeLabel"><span class="hs-identifier hs-type">TypeLabel</span></a><span> </span><a href="#local-6989586621679037974"><span class="hs-identifier hs-type">w</span></a><span> </span><a href="#local-6989586621679037975"><span class="hs-identifier hs-type">sch</span></a><span> </span><a href="#local-6989586621679037978"><span class="hs-identifier hs-type">v</span></a><span> </span><a href="#local-6989586621679037979"><span class="hs-identifier hs-type">v'</span></a><span>
</span><a name="line-133"></a><span>         </span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">r</span><span> </span><span class="hs-glyph">~</span><span> </span><span class="hs-identifier hs-type">Map</span><span> </span><a href="#local-6989586621679037977"><span class="hs-identifier hs-type">k'</span></a><span> </span><a href="#local-6989586621679037979"><span class="hs-identifier hs-type">v'</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Ord</span><span> </span><a href="#local-6989586621679037977"><span class="hs-identifier hs-type">k'</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Ord</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">FieldValue</span><span> </span><a href="#local-6989586621679037974"><span class="hs-identifier hs-type">w</span></a><span> </span><a href="#local-6989586621679037975"><span class="hs-identifier hs-type">sch</span></a><span> </span><a href="#local-6989586621679037976"><span class="hs-identifier hs-type">k</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">)</span><span>
</span><a name="line-134"></a><span>         </span><span class="hs-glyph">=&gt;</span><span> </span><a href="Mu.Schema.Optics.html#TypeLabel"><span class="hs-identifier hs-type">TypeLabel</span></a><span> </span><a href="#local-6989586621679037974"><span class="hs-identifier hs-type">w</span></a><span> </span><a href="#local-6989586621679037975"><span class="hs-identifier hs-type">sch</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="hs-identifier hs-type">TMap</span><span> </span><a href="#local-6989586621679037976"><span class="hs-identifier hs-type">k</span></a><span> </span><a href="#local-6989586621679037978"><span class="hs-identifier hs-type">v</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679037980"><span class="hs-identifier hs-type">r</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-135"></a><span>  </span><a name="local-8214565720323811446"><a href="Mu.Schema.Optics.html#typeLensGet"><span class="hs-identifier">typeLensGet</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">FMap</span><span> </span><a name="local-6989586621679042672"><a href="#local-6989586621679042672"><span class="hs-identifier">x</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">mapKeys</span><span> </span><a href="Mu.Schema.Optics.html#typeLensGet"><span class="hs-identifier hs-var">typeLensGet</span></a><span> </span><span class="hs-special">(</span><a href="Mu.Schema.Optics.html#typeLensGet"><span class="hs-identifier hs-var">typeLensGet</span></a><span> </span><span class="hs-operator hs-var">&lt;$&gt;</span><span> </span><a href="#local-6989586621679042672"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">)</span><span>
</span><a name="line-136"></a><span>  </span><a name="local-8214565720323811447"><a href="Mu.Schema.Optics.html#typeLensSet"><span class="hs-identifier">typeLensSet</span></a></a><span> </span><a name="local-6989586621679042687"><a href="#local-6989586621679042687"><span class="hs-identifier">new</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">FMap</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">mapKeys</span><span> </span><a href="Mu.Schema.Optics.html#typeLensSet"><span class="hs-identifier hs-var">typeLensSet</span></a><span> </span><span class="hs-special">(</span><a href="Mu.Schema.Optics.html#typeLensSet"><span class="hs-identifier hs-var">typeLensSet</span></a><span> </span><span class="hs-operator hs-var">&lt;$&gt;</span><span> </span><a href="#local-6989586621679042687"><span class="hs-identifier hs-var">new</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-137"></a><span>
</span><a name="line-138"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><a href="Mu.Schema.Optics.html#EnumLabel"><span class="hs-identifier hs-type">EnumLabel</span></a><span> </span><a href="#local-6989586621679037679"><span class="hs-identifier hs-type">choices</span></a><span> </span><a href="#local-6989586621679037680"><span class="hs-identifier hs-type">choiceName</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">r</span><span> </span><span class="hs-glyph">~</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-139"></a><span>         </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-identifier hs-type">LabelOptic</span><span> </span><a href="#local-6989586621679037680"><span class="hs-identifier hs-type">choiceName</span></a><span> </span><span class="hs-identifier hs-type">A_Prism</span><span>
</span><a name="line-140"></a><span>                       </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Term</span><span> </span><a href="#local-6989586621679037682"><span class="hs-identifier hs-type">w</span></a><span> </span><a href="#local-6989586621679037683"><span class="hs-identifier hs-type">sch</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="hs-identifier hs-type">DEnum</span><span> </span><a href="#local-6989586621679037684"><span class="hs-identifier hs-type">name</span></a><span> </span><a href="#local-6989586621679037679"><span class="hs-identifier hs-type">choices</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-141"></a><span>                       </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Term</span><span> </span><a href="#local-6989586621679037682"><span class="hs-identifier hs-type">w</span></a><span> </span><a href="#local-6989586621679037683"><span class="hs-identifier hs-type">sch</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="hs-identifier hs-type">DEnum</span><span> </span><a href="#local-6989586621679037684"><span class="hs-identifier hs-type">name</span></a><span> </span><a href="#local-6989586621679037679"><span class="hs-identifier hs-type">choices</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-142"></a><span>                       </span><a href="#local-6989586621679037681"><span class="hs-identifier hs-type">r</span></a><span> </span><a href="#local-6989586621679037681"><span class="hs-identifier hs-type">r</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-143"></a><span>  </span><a name="local-8214565720323797680"><span class="hs-identifier">labelOptic</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">prism'</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">TEnum</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="Mu.Schema.Optics.html#enumPrismBuild"><span class="hs-identifier hs-var">enumPrismBuild</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Proxy</span><span> </span><span class="hs-glyph">@</span><a href="#local-6989586621679037680"><span class="hs-identifier hs-type">choiceName</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-144"></a><span>                     </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span class="hs-identifier hs-var">TEnum</span><span> </span><a name="local-6989586621679037973"><a href="#local-6989586621679037973"><span class="hs-identifier">r</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Mu.Schema.Optics.html#enumPrismMatch"><span class="hs-identifier hs-var">enumPrismMatch</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Proxy</span><span> </span><span class="hs-glyph">@</span><a href="#local-6989586621679037680"><span class="hs-identifier hs-type">choiceName</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679037973"><span class="hs-identifier hs-var">r</span></a><span class="hs-special">)</span><span>
</span><a name="line-145"></a><span>
</span><a name="line-146"></a><span class="hs-keyword">class</span><span> </span><a name="EnumLabel"><a href="Mu.Schema.Optics.html#EnumLabel"><span class="hs-identifier">EnumLabel</span></a></a><span> </span><span class="hs-special">(</span><a name="local-6989586621679037097"><a href="#local-6989586621679037097"><span class="hs-identifier">choices</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">ChoiceDef</span><span> </span><span class="hs-identifier hs-type">Symbol</span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><a name="line-147"></a><span>                </span><span class="hs-special">(</span><a name="local-6989586621679037098"><a href="#local-6989586621679037098"><span class="hs-identifier">choiceName</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Symbol</span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-148"></a><span>  </span><a name="enumPrismBuild"><a href="Mu.Schema.Optics.html#enumPrismBuild"><span class="hs-identifier">enumPrismBuild</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Proxy</span><span> </span><a href="#local-6989586621679037098"><span class="hs-identifier hs-type">choiceName</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">NS</span><span> </span><span class="hs-identifier hs-type">Proxy</span><span> </span><a href="#local-6989586621679037097"><span class="hs-identifier hs-type">choices</span></a><span>
</span><a name="line-149"></a><span>  </span><a name="enumPrismMatch"><a href="Mu.Schema.Optics.html#enumPrismMatch"><span class="hs-identifier">enumPrismMatch</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Proxy</span><span> </span><a href="#local-6989586621679037098"><span class="hs-identifier hs-type">choiceName</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">NS</span><span> </span><span class="hs-identifier hs-type">Proxy</span><span> </span><a href="#local-6989586621679037097"><span class="hs-identifier hs-type">choices</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Maybe</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-150"></a><span>
</span><a name="line-151"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier hs-type">TypeError</span><span> </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="hs-identifier hs-type">Text</span><span> </span><span class="hs-string">&quot;cannot find choice &quot;</span><span> </span><span class="hs-special">'</span><span class="hs-operator hs-type">:&lt;&gt;:</span><span> </span><span class="hs-special">'</span><span class="hs-identifier hs-type">ShowType</span><span> </span><a href="#local-6989586621679037664"><span class="hs-identifier hs-type">c</span></a><span class="hs-special">)</span><span>
</span><a name="line-152"></a><span>         </span><span class="hs-glyph">=&gt;</span><span> </span><a href="Mu.Schema.Optics.html#EnumLabel"><span class="hs-identifier hs-type">EnumLabel</span></a><span> </span><span class="hs-special">'</span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><a href="#local-6989586621679037664"><span class="hs-identifier hs-type">c</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-153"></a><span>  </span><a name="local-8214565720323811443"><a href="Mu.Schema.Optics.html#enumPrismBuild"><span class="hs-identifier">enumPrismBuild</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">error</span><span> </span><span class="hs-string">&quot;this should never be run&quot;</span><span>
</span><a name="line-154"></a><span>  </span><a name="local-8214565720323811444"><a href="Mu.Schema.Optics.html#enumPrismMatch"><span class="hs-identifier">enumPrismMatch</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">error</span><span> </span><span class="hs-string">&quot;this should never be run&quot;</span><span>
</span><a name="line-155"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-pragma">{-# OVERLAPS</span><span> </span><span class="hs-pragma">#-}</span><span> </span><a href="Mu.Schema.Optics.html#EnumLabel"><span class="hs-identifier hs-type">EnumLabel</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="hs-identifier hs-type">ChoiceDef</span><span> </span><a href="#local-6989586621679037662"><span class="hs-identifier hs-type">c</span></a><span> </span><span class="hs-special">'</span><span class="hs-glyph">:</span><span> </span><a href="#local-6989586621679037663"><span class="hs-identifier hs-type">rest</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679037662"><span class="hs-identifier hs-type">c</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-156"></a><span>  </span><a name="local-8214565720323811443"><a href="Mu.Schema.Optics.html#enumPrismBuild"><span class="hs-identifier">enumPrismBuild</span></a></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Z</span><span> </span><span class="hs-identifier hs-var">Proxy</span><span>
</span><a name="line-157"></a><span>  </span><a name="local-8214565720323811444"><a href="Mu.Schema.Optics.html#enumPrismMatch"><span class="hs-identifier">enumPrismMatch</span></a></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Z</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-158"></a><span>  </span><span class="hs-identifier">enumPrismMatch</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Nothing</span><span>
</span><a name="line-159"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-pragma">{-#&#160;OVERLAPPABLE</span><span> </span><span class="hs-pragma">#-}</span><span> </span><a href="Mu.Schema.Optics.html#EnumLabel"><span class="hs-identifier hs-type">EnumLabel</span></a><span> </span><a href="#local-6989586621679037656"><span class="hs-identifier hs-type">rest</span></a><span> </span><a href="#local-6989586621679037657"><span class="hs-identifier hs-type">c</span></a><span>
</span><a name="line-160"></a><span>         </span><span class="hs-glyph">=&gt;</span><span> </span><a href="Mu.Schema.Optics.html#EnumLabel"><span class="hs-identifier hs-type">EnumLabel</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">d</span><span> </span><span class="hs-special">'</span><span class="hs-glyph">:</span><span> </span><a href="#local-6989586621679037656"><span class="hs-identifier hs-type">rest</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679037657"><span class="hs-identifier hs-type">c</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-161"></a><span>  </span><a name="local-8214565720323811443"><a href="Mu.Schema.Optics.html#enumPrismBuild"><span class="hs-identifier">enumPrismBuild</span></a></a><span> </span><a name="local-6989586621679037659"><a href="#local-6989586621679037659"><span class="hs-identifier">p</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">S</span><span> </span><span class="hs-special">(</span><a href="Mu.Schema.Optics.html#enumPrismBuild"><span class="hs-identifier hs-var">enumPrismBuild</span></a><span> </span><a href="#local-6989586621679037659"><span class="hs-identifier hs-var">p</span></a><span class="hs-special">)</span><span>
</span><a name="line-162"></a><span>  </span><a name="local-8214565720323811444"><a href="Mu.Schema.Optics.html#enumPrismMatch"><span class="hs-identifier">enumPrismMatch</span></a></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Z</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Nothing</span><span>
</span><a name="line-163"></a><span>  </span><span class="hs-identifier">enumPrismMatch</span><span> </span><a name="local-6989586621679037660"><a href="#local-6989586621679037660"><span class="hs-identifier">p</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">S</span><span> </span><a name="local-6989586621679037661"><a href="#local-6989586621679037661"><span class="hs-identifier">x</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Mu.Schema.Optics.html#enumPrismMatch"><span class="hs-identifier hs-var">enumPrismMatch</span></a><span> </span><a href="#local-6989586621679037660"><span class="hs-identifier hs-var">p</span></a><span> </span><a href="#local-6989586621679037661"><span class="hs-identifier hs-var">x</span></a><span>
</span><a name="line-164"></a></pre></body></html>